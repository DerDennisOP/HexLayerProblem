// Generated by Futhark 0.23.1

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_num_threads(struct futhark_context_config *cfg, int n);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays


// Opaque values



// Entry points
int futhark_entry_main(struct futhark_context *ctx, bool *out0);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_multicore
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}


static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

static uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

static float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

static uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
#include <getopt.h>
#include <ctype.h>
#include <inttypes.h>
#include <unistd.h>
// Start of values.h.

//// Text I/O

typedef int (*writer)(FILE*, const void*);
typedef int (*bin_reader)(void*);
typedef int (*str_reader)(const char *, void*);

struct array_reader {
  char* elems;
  int64_t n_elems_space;
  int64_t elem_size;
  int64_t n_elems_used;
  int64_t *shape;
  str_reader elem_reader;
};

static void skipspaces(FILE *f) {
  int c;
  do {
    c = getc(f);
  } while (isspace(c));

  if (c != EOF) {
    ungetc(c, f);
  }
}

static int constituent(char c) {
  return isalnum(c) || c == '.' || c == '-' || c == '+' || c == '_';
}

// Produces an empty token only on EOF.
static void next_token(FILE *f, char *buf, int bufsize) {
 start:
  skipspaces(f);

  int i = 0;
  while (i < bufsize) {
    int c = getc(f);
    buf[i] = (char)c;

    if (c == EOF) {
      buf[i] = 0;
      return;
    } else if (c == '-' && i == 1 && buf[0] == '-') {
      // Line comment, so skip to end of line and start over.
      for (; c != '\n' && c != EOF; c = getc(f));
      goto start;
    } else if (!constituent((char)c)) {
      if (i == 0) {
        // We permit single-character tokens that are not
        // constituents; this lets things like ']' and ',' be
        // tokens.
        buf[i+1] = 0;
        return;
      } else {
        ungetc(c, f);
        buf[i] = 0;
        return;
      }
    }

    i++;
  }

  buf[bufsize-1] = 0;
}

static int next_token_is(FILE *f, char *buf, int bufsize, const char* expected) {
  next_token(f, buf, bufsize);
  return strcmp(buf, expected) == 0;
}

static void remove_underscores(char *buf) {
  char *w = buf;

  for (char *r = buf; *r; r++) {
    if (*r != '_') {
      *w++ = *r;
    }
  }

  *w++ = 0;
}

static int read_str_elem(char *buf, struct array_reader *reader) {
  int ret;
  if (reader->n_elems_used == reader->n_elems_space) {
    reader->n_elems_space *= 2;
    reader->elems = (char*) realloc(reader->elems,
                                    (size_t)(reader->n_elems_space * reader->elem_size));
  }

  ret = reader->elem_reader(buf, reader->elems + reader->n_elems_used * reader->elem_size);

  if (ret == 0) {
    reader->n_elems_used++;
  }

  return ret;
}

static int read_str_array_elems(FILE *f,
                                char *buf, int bufsize,
                                struct array_reader *reader, int64_t dims) {
  int ret;
  int first = 1;
  char *knows_dimsize = (char*) calloc((size_t)dims, sizeof(char));
  int cur_dim = (int)dims-1;
  int64_t *elems_read_in_dim = (int64_t*) calloc((size_t)dims, sizeof(int64_t));

  while (1) {
    next_token(f, buf, bufsize);

    if (strcmp(buf, "]") == 0) {
      if (knows_dimsize[cur_dim]) {
        if (reader->shape[cur_dim] != elems_read_in_dim[cur_dim]) {
          ret = 1;
          break;
        }
      } else {
        knows_dimsize[cur_dim] = 1;
        reader->shape[cur_dim] = elems_read_in_dim[cur_dim];
      }
      if (cur_dim == 0) {
        ret = 0;
        break;
      } else {
        cur_dim--;
        elems_read_in_dim[cur_dim]++;
      }
    } else if (strcmp(buf, ",") == 0) {
      next_token(f, buf, bufsize);
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        first = 1;
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else if (cur_dim == dims - 1) {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
      } else {
        ret = 1;
        break;
      }
    } else if (strlen(buf) == 0) {
      // EOF
      ret = 1;
      break;
    } else if (first) {
      if (strcmp(buf, "[") == 0) {
        if (cur_dim == dims - 1) {
          ret = 1;
          break;
        }
        cur_dim++;
        elems_read_in_dim[cur_dim] = 0;
      } else {
        ret = read_str_elem(buf, reader);
        if (ret != 0) {
          break;
        }
        elems_read_in_dim[cur_dim]++;
        first = 0;
      }
    } else {
      ret = 1;
      break;
    }
  }

  free(knows_dimsize);
  free(elems_read_in_dim);
  return ret;
}

static int read_str_empty_array(FILE *f, char *buf, int bufsize,
                                const char *type_name, int64_t *shape, int64_t dims) {
  if (strlen(buf) == 0) {
    // EOF
    return 1;
  }

  if (strcmp(buf, "empty") != 0) {
    return 1;
  }

  if (!next_token_is(f, buf, bufsize, "(")) {
    return 1;
  }

  for (int i = 0; i < dims; i++) {
    if (!next_token_is(f, buf, bufsize, "[")) {
      return 1;
    }

    next_token(f, buf, bufsize);

    if (sscanf(buf, "%"SCNu64, (uint64_t*)&shape[i]) != 1) {
      return 1;
    }

    if (!next_token_is(f, buf, bufsize, "]")) {
      return 1;
    }
  }

  if (!next_token_is(f, buf, bufsize, type_name)) {
    return 1;
  }


  if (!next_token_is(f, buf, bufsize, ")")) {
    return 1;
  }

  // Check whether the array really is empty.
  for (int i = 0; i < dims; i++) {
    if (shape[i] == 0) {
      return 0;
    }
  }

  // Not an empty array!
  return 1;
}

static int read_str_array(FILE *f,
                          int64_t elem_size, str_reader elem_reader,
                          const char *type_name,
                          void **data, int64_t *shape, int64_t dims) {
  int ret;
  struct array_reader reader;
  char buf[100];

  int dims_seen;
  for (dims_seen = 0; dims_seen < dims; dims_seen++) {
    if (!next_token_is(f, buf, sizeof(buf), "[")) {
      break;
    }
  }

  if (dims_seen == 0) {
    return read_str_empty_array(f, buf, sizeof(buf), type_name, shape, dims);
  }

  if (dims_seen != dims) {
    return 1;
  }

  reader.shape = shape;
  reader.n_elems_used = 0;
  reader.elem_size = elem_size;
  reader.n_elems_space = 16;
  reader.elems = (char*) realloc(*data, (size_t)(elem_size*reader.n_elems_space));
  reader.elem_reader = elem_reader;

  ret = read_str_array_elems(f, buf, sizeof(buf), &reader, dims);

  *data = reader.elems;

  return ret;
}

#define READ_STR(MACRO, PTR, SUFFIX)                                   \
  remove_underscores(buf);                                              \
  int j;                                                                \
  if (sscanf(buf, "%"MACRO"%n", (PTR*)dest, &j) == 1) {                 \
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, SUFFIX) == 0);     \
  } else {                                                              \
    return 1;                                                           \
  }

static int read_str_i8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNi8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(int8_t*)dest = (int8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "i8") == 0);
  } else {
    return 1;
  }
}

static int read_str_u8(char *buf, void* dest) {
  // Some platforms (WINDOWS) does not support scanf %hhd or its
  // cousin, %SCNu8.  Read into int first to avoid corrupting
  // memory.
  //
  // https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63417
  remove_underscores(buf);
  int j, x;
  if (sscanf(buf, "%i%n", &x, &j) == 1) {
    *(uint8_t*)dest = (uint8_t)x;
    return !(strcmp(buf+j, "") == 0 || strcmp(buf+j, "u8") == 0);
  } else {
    return 1;
  }
}

static int read_str_i16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "i16");
}

static int read_str_u16(char *buf, void* dest) {
  READ_STR(SCNi16, int16_t, "u16");
}

static int read_str_i32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "i32");
}

static int read_str_u32(char *buf, void* dest) {
  READ_STR(SCNi32, int32_t, "u32");
}

static int read_str_i64(char *buf, void* dest) {
  READ_STR(SCNi64, int64_t, "i64");
}

static int read_str_u64(char *buf, void* dest) {
  // FIXME: This is not correct, as SCNu64 only permits decimal
  // literals.  However, SCNi64 does not handle very large numbers
  // correctly (it's really for signed numbers, so that's fair).
  READ_STR(SCNu64, uint64_t, "u64");
}

static int read_str_f16(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f16.nan") == 0) {
    *(uint16_t*)dest = float2halfbits(NAN);
    return 0;
  } else if (strcmp(buf, "f16.inf") == 0) {
    *(uint16_t*)dest = float2halfbits(INFINITY);
    return 0;
  } else if (strcmp(buf, "-f16.inf") == 0) {
    *(uint16_t*)dest = float2halfbits(-INFINITY);
    return 0;
  } else {
    int j;
    float x;
    if (sscanf(buf, "%f%n", &x, &j) == 1) {
      if (strcmp(buf+j, "") == 0 || strcmp(buf+j, "f16") == 0) {
        *(uint16_t*)dest = float2halfbits(x);
        return 0;
      }
    }
    return 1;
  }
}

static int read_str_f32(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f32.nan") == 0) {
    *(float*)dest = (float)NAN;
    return 0;
  } else if (strcmp(buf, "f32.inf") == 0) {
    *(float*)dest = (float)INFINITY;
    return 0;
  } else if (strcmp(buf, "-f32.inf") == 0) {
    *(float*)dest = (float)-INFINITY;
    return 0;
  } else {
    READ_STR("f", float, "f32");
  }
}

static int read_str_f64(char *buf, void* dest) {
  remove_underscores(buf);
  if (strcmp(buf, "f64.nan") == 0) {
    *(double*)dest = (double)NAN;
    return 0;
  } else if (strcmp(buf, "f64.inf") == 0) {
    *(double*)dest = (double)INFINITY;
    return 0;
  } else if (strcmp(buf, "-f64.inf") == 0) {
    *(double*)dest = (double)-INFINITY;
    return 0;
  } else {
    READ_STR("lf", double, "f64");
  }
}

static int read_str_bool(char *buf, void* dest) {
  if (strcmp(buf, "true") == 0) {
    *(char*)dest = 1;
    return 0;
  } else if (strcmp(buf, "false") == 0) {
    *(char*)dest = 0;
    return 0;
  } else {
    return 1;
  }
}

static int write_str_i8(FILE *out, int8_t *src) {
  return fprintf(out, "%hhdi8", *src);
}

static int write_str_u8(FILE *out, uint8_t *src) {
  return fprintf(out, "%hhuu8", *src);
}

static int write_str_i16(FILE *out, int16_t *src) {
  return fprintf(out, "%hdi16", *src);
}

static int write_str_u16(FILE *out, uint16_t *src) {
  return fprintf(out, "%huu16", *src);
}

static int write_str_i32(FILE *out, int32_t *src) {
  return fprintf(out, "%di32", *src);
}

static int write_str_u32(FILE *out, uint32_t *src) {
  return fprintf(out, "%uu32", *src);
}

static int write_str_i64(FILE *out, int64_t *src) {
  return fprintf(out, "%"PRIi64"i64", *src);
}

static int write_str_u64(FILE *out, uint64_t *src) {
  return fprintf(out, "%"PRIu64"u64", *src);
}

static int write_str_f16(FILE *out, uint16_t *src) {
  float x = halfbits2float(*src);
  if (isnan(x)) {
    return fprintf(out, "f16.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f16.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f16.inf");
  } else {
    return fprintf(out, "%.6ff16", x);
  }
}

static int write_str_f32(FILE *out, float *src) {
  float x = *src;
  if (isnan(x)) {
    return fprintf(out, "f32.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f32.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f32.inf");
  } else {
    return fprintf(out, "%.6ff32", x);
  }
}

static int write_str_f64(FILE *out, double *src) {
  double x = *src;
  if (isnan(x)) {
    return fprintf(out, "f64.nan");
  } else if (isinf(x) && x >= 0) {
    return fprintf(out, "f64.inf");
  } else if (isinf(x)) {
    return fprintf(out, "-f64.inf");
  } else {
    return fprintf(out, "%.6ff64", *src);
  }
}

static int write_str_bool(FILE *out, void *src) {
  return fprintf(out, *(char*)src ? "true" : "false");
}

//// Binary I/O

#define BINARY_FORMAT_VERSION 2
#define IS_BIG_ENDIAN (!*(unsigned char *)&(uint16_t){1})

static void flip_bytes(size_t elem_size, unsigned char *elem) {
  for (size_t j=0; j<elem_size/2; j++) {
    unsigned char head = elem[j];
    size_t tail_index = elem_size-1-j;
    elem[j] = elem[tail_index];
    elem[tail_index] = head;
  }
}

// On Windows we need to explicitly set the file mode to not mangle
// newline characters.  On *nix there is no difference.
#ifdef _WIN32
#include <io.h>
#include <fcntl.h>
static void set_binary_mode(FILE *f) {
  setmode(fileno(f), O_BINARY);
}
#else
static void set_binary_mode(FILE *f) {
  (void)f;
}
#endif

static int read_byte(FILE *f, void* dest) {
  size_t num_elems_read = fread(dest, 1, 1, f);
  return num_elems_read == 1 ? 0 : 1;
}

//// Types

struct primtype_info_t {
  const char binname[4]; // Used for parsing binary data.
  const char* type_name; // Same name as in Futhark.
  const int64_t size; // in bytes
  const writer write_str; // Write in text format.
  const str_reader read_str; // Read in text format.
};

static const struct primtype_info_t i8_info =
  {.binname = "  i8", .type_name = "i8",   .size = 1,
   .write_str = (writer)write_str_i8, .read_str = (str_reader)read_str_i8};
static const struct primtype_info_t i16_info =
  {.binname = " i16", .type_name = "i16",  .size = 2,
   .write_str = (writer)write_str_i16, .read_str = (str_reader)read_str_i16};
static const struct primtype_info_t i32_info =
  {.binname = " i32", .type_name = "i32",  .size = 4,
   .write_str = (writer)write_str_i32, .read_str = (str_reader)read_str_i32};
static const struct primtype_info_t i64_info =
  {.binname = " i64", .type_name = "i64",  .size = 8,
   .write_str = (writer)write_str_i64, .read_str = (str_reader)read_str_i64};
static const struct primtype_info_t u8_info =
  {.binname = "  u8", .type_name = "u8",   .size = 1,
   .write_str = (writer)write_str_u8, .read_str = (str_reader)read_str_u8};
static const struct primtype_info_t u16_info =
  {.binname = " u16", .type_name = "u16",  .size = 2,
   .write_str = (writer)write_str_u16, .read_str = (str_reader)read_str_u16};
static const struct primtype_info_t u32_info =
  {.binname = " u32", .type_name = "u32",  .size = 4,
   .write_str = (writer)write_str_u32, .read_str = (str_reader)read_str_u32};
static const struct primtype_info_t u64_info =
  {.binname = " u64", .type_name = "u64",  .size = 8,
   .write_str = (writer)write_str_u64, .read_str = (str_reader)read_str_u64};
static const struct primtype_info_t f16_info =
  {.binname = " f16", .type_name = "f16",  .size = 2,
   .write_str = (writer)write_str_f16, .read_str = (str_reader)read_str_f16};
static const struct primtype_info_t f32_info =
  {.binname = " f32", .type_name = "f32",  .size = 4,
   .write_str = (writer)write_str_f32, .read_str = (str_reader)read_str_f32};
static const struct primtype_info_t f64_info =
  {.binname = " f64", .type_name = "f64",  .size = 8,
   .write_str = (writer)write_str_f64, .read_str = (str_reader)read_str_f64};
static const struct primtype_info_t bool_info =
  {.binname = "bool", .type_name = "bool", .size = 1,
   .write_str = (writer)write_str_bool, .read_str = (str_reader)read_str_bool};

static const struct primtype_info_t* primtypes[] = {
  &i8_info, &i16_info, &i32_info, &i64_info,
  &u8_info, &u16_info, &u32_info, &u64_info,
  &f16_info, &f32_info, &f64_info,
  &bool_info,
  NULL // NULL-terminated
};

// General value interface.  All endian business taken care of at
// lower layers.

static int read_is_binary(FILE *f) {
  skipspaces(f);
  int c = getc(f);
  if (c == 'b') {
    int8_t bin_version;
    int ret = read_byte(f, &bin_version);

    if (ret != 0) { futhark_panic(1, "binary-input: could not read version.\n"); }

    if (bin_version != BINARY_FORMAT_VERSION) {
      futhark_panic(1, "binary-input: File uses version %i, but I only understand version %i.\n",
            bin_version, BINARY_FORMAT_VERSION);
    }

    return 1;
  }
  ungetc(c, f);
  return 0;
}

static const struct primtype_info_t* read_bin_read_type_enum(FILE *f) {
  char read_binname[4];

  int num_matched = fscanf(f, "%4c", read_binname);
  if (num_matched != 1) { futhark_panic(1, "binary-input: Couldn't read element type.\n"); }

  const struct primtype_info_t **type = primtypes;

  for (; *type != NULL; type++) {
    // I compare the 4 characters manually instead of using strncmp because
    // this allows any value to be used, also NULL bytes
    if (memcmp(read_binname, (*type)->binname, 4) == 0) {
      return *type;
    }
  }
  futhark_panic(1, "binary-input: Did not recognize the type '%s'.\n", read_binname);
  return NULL;
}

static void read_bin_ensure_scalar(FILE *f, const struct primtype_info_t *expected_type) {
  int8_t bin_dims;
  int ret = read_byte(f, &bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != 0) {
    futhark_panic(1, "binary-input: Expected scalar (0 dimensions), but got array with %i dimensions.\n",
          bin_dims);
  }

  const struct primtype_info_t *bin_type = read_bin_read_type_enum(f);
  if (bin_type != expected_type) {
    futhark_panic(1, "binary-input: Expected scalar of type %s but got scalar of type %s.\n",
          expected_type->type_name,
          bin_type->type_name);
  }
}

//// High-level interface

static int read_bin_array(FILE *f,
                          const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  int ret;

  int8_t bin_dims;
  ret = read_byte(f, &bin_dims);
  if (ret != 0) { futhark_panic(1, "binary-input: Couldn't get dims.\n"); }

  if (bin_dims != dims) {
    futhark_panic(1, "binary-input: Expected %i dimensions, but got array with %i dimensions.\n",
          dims, bin_dims);
  }

  const struct primtype_info_t *bin_primtype = read_bin_read_type_enum(f);
  if (expected_type != bin_primtype) {
    futhark_panic(1, "binary-input: Expected %iD-array with element type '%s' but got %iD-array with element type '%s'.\n",
          dims, expected_type->type_name, dims, bin_primtype->type_name);
  }

  int64_t elem_count = 1;
  for (int i=0; i<dims; i++) {
    int64_t bin_shape;
    ret = (int)fread(&bin_shape, sizeof(bin_shape), 1, f);
    if (ret != 1) {
      futhark_panic(1, "binary-input: Couldn't read size for dimension %i of array.\n", i);
    }
    if (IS_BIG_ENDIAN) {
      flip_bytes(sizeof(bin_shape), (unsigned char*) &bin_shape);
    }
    elem_count *= bin_shape;
    shape[i] = bin_shape;
  }

  int64_t elem_size = expected_type->size;
  void* tmp = realloc(*data, (size_t)(elem_count * elem_size));
  if (tmp == NULL) {
    futhark_panic(1, "binary-input: Failed to allocate array of size %i.\n",
          elem_count * elem_size);
  }
  *data = tmp;

  int64_t num_elems_read = (int64_t)fread(*data, (size_t)elem_size, (size_t)elem_count, f);
  if (num_elems_read != elem_count) {
    futhark_panic(1, "binary-input: tried to read %i elements of an array, but only got %i elements.\n",
          elem_count, num_elems_read);
  }

  // If we're on big endian platform we must change all multibyte elements
  // from using little endian to big endian
  if (IS_BIG_ENDIAN && elem_size != 1) {
    flip_bytes((size_t)elem_size, (unsigned char*) *data);
  }

  return 0;
}

static int read_array(FILE *f, const struct primtype_info_t *expected_type, void **data, int64_t *shape, int64_t dims) {
  if (!read_is_binary(f)) {
    return read_str_array(f, expected_type->size, (str_reader)expected_type->read_str, expected_type->type_name, data, shape, dims);
  } else {
    return read_bin_array(f, expected_type, data, shape, dims);
  }
}

static int end_of_input(FILE *f) {
  skipspaces(f);
  char token[2];
  next_token(f, token, sizeof(token));
  if (strcmp(token, "") == 0) {
    return 0;
  } else {
    return 1;
  }
}

static int write_str_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  if (rank==0) {
    elem_type->write_str(out, (const void*)data);
  } else {
    int64_t len = (int64_t)shape[0];
    int64_t slice_size = 1;

    int64_t elem_size = elem_type->size;
    for (int8_t i = 1; i < rank; i++) {
      slice_size *= shape[i];
    }

    if (len*slice_size == 0) {
      fprintf(out, "empty(");
      for (int64_t i = 0; i < rank; i++) {
        fprintf(out, "[%"PRIi64"]", shape[i]);
      }
      fprintf(out, "%s", elem_type->type_name);
      fprintf(out, ")");
    } else if (rank==1) {
      fputc('[', out);
      for (int64_t i = 0; i < len; i++) {
        elem_type->write_str(out, (const void*) (data + i * elem_size));
        if (i != len-1) {
          fprintf(out, ", ");
        }
      }
      fputc(']', out);
    } else {
      fputc('[', out);
      for (int64_t i = 0; i < len; i++) {
        write_str_array(out, elem_type, data + i * slice_size * elem_size, shape+1, rank-1);
        if (i != len-1) {
          fprintf(out, ", ");
        }
      }
      fputc(']', out);
    }
  }
  return 0;
}

static int write_bin_array(FILE *out,
                           const struct primtype_info_t *elem_type,
                           const unsigned char *data,
                           const int64_t *shape,
                           int8_t rank) {
  int64_t num_elems = 1;
  for (int64_t i = 0; i < rank; i++) {
    num_elems *= shape[i];
  }

  fputc('b', out);
  fputc((char)BINARY_FORMAT_VERSION, out);
  fwrite(&rank, sizeof(int8_t), 1, out);
  fwrite(elem_type->binname, 4, 1, out);
  if (shape != NULL) {
    fwrite(shape, sizeof(int64_t), (size_t)rank, out);
  }

  if (IS_BIG_ENDIAN) {
    for (int64_t i = 0; i < num_elems; i++) {
      const unsigned char *elem = data+i*elem_type->size;
      for (int64_t j = 0; j < elem_type->size; j++) {
        fwrite(&elem[elem_type->size-j], 1, 1, out);
      }
    }
  } else {
    fwrite(data, (size_t)elem_type->size, (size_t)num_elems, out);
  }

  return 0;
}

static int write_array(FILE *out, int write_binary,
                       const struct primtype_info_t *elem_type,
                       const void *data,
                       const int64_t *shape,
                       const int8_t rank) {
  if (write_binary) {
    return write_bin_array(out, elem_type, data, shape, rank);
  } else {
    return write_str_array(out, elem_type, data, shape, rank);
  }
}

static int read_scalar(FILE *f,
                       const struct primtype_info_t *expected_type, void *dest) {
  if (!read_is_binary(f)) {
    char buf[100];
    next_token(f, buf, sizeof(buf));
    return expected_type->read_str(buf, dest);
  } else {
    read_bin_ensure_scalar(f, expected_type);
    size_t elem_size = (size_t)expected_type->size;
    size_t num_elems_read = fread(dest, elem_size, 1, f);
    if (IS_BIG_ENDIAN) {
      flip_bytes(elem_size, (unsigned char*) dest);
    }
    return num_elems_read == 1 ? 0 : 1;
  }
}

static int write_scalar(FILE *out, int write_binary, const struct primtype_info_t *type, void *src) {
  if (write_binary) {
    return write_bin_array(out, type, src, NULL, 0);
  } else {
    return type->write_str(out, src);
  }
}

// End of values.h.

static int binary_output = 0;
static int print_result = 1;
static int print_report = 0;
static FILE *runtime_file;
static int perform_warmup = 0;
static int num_runs = 1;
static const char *entry_point = "main";
// Start of tuning.h.

static char* load_tuning_file(const char *fname,
                              void *cfg,
                              int (*set_tuning_param)(void*, const char*, size_t)) {
  const int max_line_len = 1024;
  char* line = (char*) malloc(max_line_len);

  FILE *f = fopen(fname, "r");

  if (f == NULL) {
    snprintf(line, max_line_len, "Cannot open file: %s", strerror(errno));
    return line;
  }

  int lineno = 0;
  while (fgets(line, max_line_len, f) != NULL) {
    lineno++;
    char *eql = strstr(line, "=");
    if (eql) {
      *eql = 0;
      int value = atoi(eql+1);
      if (set_tuning_param(cfg, line, (size_t)value) != 0) {
        char* err = (char*) malloc(max_line_len + 50);
        snprintf(err, max_line_len + 50, "Unknown name '%s' on line %d.", line, lineno);
        free(line);
        return err;
      }
    } else {
      snprintf(line, max_line_len, "Invalid line %d (must be of form 'name=int').",
               lineno);
      return line;
    }
  }

  free(line);

  return NULL;
}

// End of tuning.h.

int parse_options(struct futhark_context_config *cfg, int argc, char *const argv[])
{
    int ch;
    static struct option long_options[] = {{"write-runtime-to", required_argument, NULL, 1}, {"runs", required_argument, NULL, 2}, {"debugging", no_argument, NULL, 3}, {"log", no_argument, NULL, 4}, {"entry-point", required_argument, NULL, 5}, {"binary-output", no_argument, NULL, 6}, {"no-print-result", no_argument, NULL, 7}, {"help", no_argument, NULL, 8}, {"print-params", no_argument, NULL, 9}, {"param", required_argument, NULL, 10}, {"tuning", required_argument, NULL, 11}, {"cache-file", required_argument, NULL, 12}, {"profile", no_argument, NULL, 13}, {"num-threads", required_argument, NULL, 14}, {0, 0, 0, 0}};
    static char *option_descriptions = "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -n/--no-print-result       Do not print the program result.\n  -h/--help                  Print help information and exit.\n  --print-params             Print all tuning parameters that can be set with --param or --tuning.\n  --param ASSIGNMENT         Set a tuning parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  --cache-file FILE          Store program cache here.\n  -P/--profile               Gather profiling information.\n  --num-threads INT          Set number of threads used for execution.\n";
    
    while ((ch = getopt_long(argc, argv, ":t:r:DLe:bnhP", long_options, NULL)) != -1) {
        if (ch == 1 || ch == 't') {
            runtime_file = fopen(optarg, "w");
            if (runtime_file == NULL)
                futhark_panic(1, "Cannot open %s: %s\n", optarg, strerror(errno));
        }
        if (ch == 2 || ch == 'r') {
            num_runs = atoi(optarg);
            perform_warmup = 1;
            if (num_runs <= 0)
                futhark_panic(1, "Need a positive number of runs, not %s\n", optarg);
        }
        if (ch == 3 || ch == 'D') {
            futhark_context_config_set_debugging(cfg, 1);
            print_report = 1;
        }
        if (ch == 4 || ch == 'L') {
            futhark_context_config_set_logging(cfg, 1);
            print_report = 1;
        }
        if (ch == 5 || ch == 'e') {
            if (entry_point != NULL)
                entry_point = optarg;
        }
        if (ch == 6 || ch == 'b')
            binary_output = 1;
        if (ch == 7 || ch == 'n')
            print_result = 0;
        if (ch == 8 || ch == 'h') {
            printf("Usage: %s [OPTION]...\nOptions:\n\n%s\nFor more information, consult the Futhark User's Guide or the man pages.\n", fut_progname, option_descriptions);
            exit(0);
        }
        if (ch == 9) {
            int n = futhark_get_tuning_param_count();
            
            for (int i = 0; i < n; i++)
                printf("%s (%s)\n", futhark_get_tuning_param_name(i), futhark_get_tuning_param_class(i));
            exit(0);
        }
        if (ch == 10) {
            char *name = optarg;
            char *equals = strstr(optarg, "=");
            char *value_str = equals != NULL ? equals + 1 : optarg;
            int value = atoi(value_str);
            
            if (equals != NULL) {
                *equals = 0;
                if (futhark_context_config_set_tuning_param(cfg, name, (size_t) value) != 0)
                    futhark_panic(1, "Unknown size: %s\n", name);
            } else
                futhark_panic(1, "Invalid argument for size option: %s\n", optarg);
        }
        if (ch == 11) {
            char *ret = load_tuning_file(optarg, cfg, (int (*)(void *, const char *, size_t)) futhark_context_config_set_tuning_param);
            
            if (ret != NULL)
                futhark_panic(1, "When loading tuning from '%s': %s\n", optarg, ret);
        }
        if (ch == 12)
            futhark_context_config_set_cache_file(cfg, optarg);
        if (ch == 13 || ch == 'P')
            futhark_context_config_set_profiling(cfg, 1);
        if (ch == 14)
            futhark_context_config_set_num_threads(cfg, atoi(optarg));
        if (ch == ':')
            futhark_panic(-1, "Missing argument for option %s\n", argv[optind - 1]);
        if (ch == '?') {
            fprintf(stderr, "Usage: %s [OPTIONS]...\nOptions:\n\n%s\n", fut_progname, "  -t/--write-runtime-to FILE Print the time taken to execute the program to the indicated file, an integral number of microseconds.\n  -r/--runs INT              Perform NUM runs of the program.\n  -D/--debugging             Perform possibly expensive internal correctness checks and verbose logging.\n  -L/--log                   Print various low-overhead logging information to stderr while running.\n  -e/--entry-point NAME      The entry point to run. Defaults to main.\n  -b/--binary-output         Print the program result in the binary output format.\n  -n/--no-print-result       Do not print the program result.\n  -h/--help                  Print help information and exit.\n  --print-params             Print all tuning parameters that can be set with --param or --tuning.\n  --param ASSIGNMENT         Set a tuning parameter to the given value.\n  --tuning FILE              Read size=value assignments from the given file.\n  --cache-file FILE          Store program cache here.\n  -P/--profile               Gather profiling information.\n  --num-threads INT          Set number of threads used for execution.\n");
            futhark_panic(1, "Unknown option: %s\n", argv[optind - 1]);
        }
    }
    return optind;
}
static int futrts_cli_entry_main(struct futhark_context *ctx)
{
    int64_t t_start, t_end;
    int time_runs = 0, profile_run = 0;
    int retval = 0;
    
    // We do not want to profile all the initialisation.
    futhark_context_pause_profiling(ctx);
    // Declare and read input.
    set_binary_mode(stdin);
    if (end_of_input(stdin) != 0)
        futhark_panic(1, "Expected EOF on stdin after reading input for \"%s\".\n", "main");
    
    bool result_0;
    
    if (perform_warmup) {
        int r;
        
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_0);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        ;
    }
    time_runs = 1;
    // Proper run.
    for (int run = 0; run < num_runs; run++) {
        // Only profile last run.
        profile_run = run == num_runs - 1;
        
        int r;
        
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        // Only profile last run.
        if (profile_run)
            futhark_context_unpause_profiling(ctx);
        t_start = get_wall_time();
        r = futhark_entry_main(ctx, &result_0);
        if (r != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        if (futhark_context_sync(ctx) != 0)
            futhark_panic(1, "%s", futhark_context_get_error(ctx));
        ;
        if (profile_run)
            futhark_context_pause_profiling(ctx);
        t_end = get_wall_time();
        
        long elapsed_usec = t_end - t_start;
        
        if (time_runs && runtime_file != NULL) {
            fprintf(runtime_file, "%lld\n", (long long) elapsed_usec);
            fflush(runtime_file);
        }
        if (run < num_runs - 1) {
            ;
        }
    }
    if (print_result) {
        // Print the final result.
        if (binary_output)
            set_binary_mode(stdout);
        write_scalar(stdout, binary_output, &bool_info, &result_0);
        printf("\n");
    }
    
  print_end:
    { }
    ;
    return retval;
}
typedef int entry_point_fun(struct futhark_context *);
struct entry_point_entry {
    const char *name;
    entry_point_fun *fun;
};
int main(int argc, char **argv)
{
    int retval = 0;
    
    fut_progname = argv[0];
    
    struct futhark_context_config *cfg = futhark_context_config_new();
    
    assert(cfg != NULL);
    
    int parsed_options = parse_options(cfg, argc, argv);
    
    argc -= parsed_options;
    argv += parsed_options;
    if (argc != 0)
        futhark_panic(1, "Excess non-option: %s\n", argv[0]);
    
    struct futhark_context *ctx = futhark_context_new(cfg);
    
    assert(ctx != NULL);
    
    char *error = futhark_context_get_error(ctx);
    
    if (error != NULL)
        futhark_panic(1, "%s", error);
    
    struct entry_point_entry entry_points[] = {{.name ="main", .fun =futrts_cli_entry_main}};
    
    if (entry_point != NULL) {
        int num_entry_points = sizeof(entry_points) / sizeof(entry_points[0]);
        entry_point_fun *entry_point_fun = NULL;
        
        for (int i = 0; i < num_entry_points; i++) {
            if (strcmp(entry_points[i].name, entry_point) == 0) {
                entry_point_fun = entry_points[i].fun;
                break;
            }
        }
        if (entry_point_fun == NULL) {
            fprintf(stderr, "No entry point '%s'.  Select another with --entry-point.  Options are:\n", entry_point);
            for (int i = 0; i < num_entry_points; i++)
                fprintf(stderr, "%s\n", entry_points[i].name);
            return 1;
        }
        if (isatty(fileno(stdin))) {
            fprintf(stderr, "Reading input from TTY.\n");
            fprintf(stderr, "Send EOF (CTRL-d) after typing all input values.\n");
        }
        retval = entry_point_fun(ctx);
        if (runtime_file != NULL)
            fclose(runtime_file);
        if (print_report) {
            char *report = futhark_context_report(ctx);
            
            fputs(report, stderr);
            free(report);
        }
    }
    futhark_context_free(ctx);
    futhark_context_config_free(cfg);
    return retval;
}

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

static inline uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

static inline uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

static inline uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

static inline uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

static inline uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

static inline uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

static inline uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

static inline uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

static inline uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

static inline uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

static inline uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

static inline uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

static inline uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

static inline uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return x / ys;
}

static inline uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return x / ys;
}

static inline uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return (x + y - 1) / ys;
}

static inline uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return (x + y - 1) / ys;
}

static inline uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return (x + y - 1) / ys;
}

static inline uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return (x + y - 1) / ys;
}

static inline uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  

  return x % ys;
}

static inline uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : (x + y - 1) / ys;
}

static inline uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

static inline int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

static inline int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

static inline int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

static inline int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

static inline int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

static inline int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

static inline int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

static inline int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

static inline int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

static inline int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

static inline int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

static inline int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

static inline int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

static inline int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

static inline int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

static inline int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x / ys;
}

static inline int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return x % ys;
}

static inline int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x / ys;
}

static inline int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

static inline int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  
  return y == 0 ? 0 : x % ys;
}

#else

static inline uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

static inline uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

static inline uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

static inline uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

static inline uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

static inline uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

static inline uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

static inline uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

static inline uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

static inline uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

static inline uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

static inline uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

static inline uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

static inline uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

static inline uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

static inline uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

static inline uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

static inline int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

static inline int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

static inline int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

static inline int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

static inline int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

static inline int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

static inline int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

static inline int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

static inline int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

static inline int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

static inline int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

static inline int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

static inline int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

static inline int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

static inline int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

static inline int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

static inline int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

static inline int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

static inline int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

static inline int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

static inline int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

static inline int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

static inline int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

static inline int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

static inline int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

static inline int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

static inline int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

static inline int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

static inline int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

static inline int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

static inline int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

static inline int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

static inline uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

static inline uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

static inline uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

static inline uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

static inline int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

static inline int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

static inline int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

static inline int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

static inline uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

static inline uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

static inline uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

static inline uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

static inline uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

static inline uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

static inline uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

static inline uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

static inline uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

static inline uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

static inline uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

static inline uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

static inline int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

static inline int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

static inline int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

static inline int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

static inline uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

static inline uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

static inline uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

static inline uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

static inline uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

static inline uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

static inline uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

static inline uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

static inline uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

static inline uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

static inline uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

static inline uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

static inline bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

static inline bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

static inline bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

static inline bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

static inline bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

static inline bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

static inline bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

static inline bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

static inline bool slt8(int8_t x, int8_t y) {
  return x < y;
}

static inline bool slt16(int16_t x, int16_t y) {
  return x < y;
}

static inline bool slt32(int32_t x, int32_t y) {
  return x < y;
}

static inline bool slt64(int64_t x, int64_t y) {
  return x < y;
}

static inline bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

static inline bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

static inline bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

static inline bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

static inline uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

static inline bool itob_i8_bool(int8_t x) {
  return x != 0;
}

static inline bool itob_i16_bool(int16_t x) {
  return x != 0;
}

static inline bool itob_i32_bool(int32_t x) {
  return x != 0;
}

static inline bool itob_i64_bool(int64_t x) {
  return x != 0;
}

static inline int8_t btoi_bool_i8(bool x) {
  return x;
}

static inline int16_t btoi_bool_i16(bool x) {
  return x;
}

static inline int32_t btoi_bool_i32(bool x) {
  return x;
}

static inline int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

static int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

static int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

static int32_t abs32(int32_t x) {
  return abs(x);
}

static int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

static int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

static int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

static int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

static int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

static int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

static int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

static int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

static int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

static int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

static int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

static int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
static uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
static uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
static uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
static uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
static uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
static uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
static uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
static uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
static  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
static uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
static uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
static uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
static  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
static uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
static uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
static uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
static uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
static uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
static uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
static uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
static  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
static int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
static int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
static int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
static uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
static uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
static uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
static uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
static int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
static int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
static int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
static int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
static  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
static uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
static uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
static uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
static  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
static uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
static uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
static uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

static  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
static uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
static uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
static uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
static  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
static uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
static uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
static uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

static int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

static int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

static int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

static int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

static int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

static int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

static int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

static int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

static int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

static int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

static int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

static int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

static int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

static int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

static int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

static int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

static int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

static int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

static int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

static int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

static int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

static int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

static int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

static int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

static int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

static int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

static int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

static int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

static int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

static int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

static inline float fdiv32(float x, float y) {
  return x / y;
}

static inline float fadd32(float x, float y) {
  return x + y;
}

static inline float fsub32(float x, float y) {
  return x - y;
}

static inline float fmul32(float x, float y) {
  return x * y;
}

static inline bool cmplt32(float x, float y) {
  return x < y;
}

static inline bool cmple32(float x, float y) {
  return x <= y;
}

static inline float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

static inline float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

static inline float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

static inline float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

static inline float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

static inline float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

static inline float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

static inline float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
static inline float fabs32(float x) {
  return fabs(x);
}

static inline float fmax32(float x, float y) {
  return fmax(x, y);
}

static inline float fmin32(float x, float y) {
  return fmin(x, y);
}

static inline float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

static inline float fabs32(float x) {
  return abs(x);
}

static inline float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

static inline float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

static inline float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

static inline float fabs32(float x) {
  return fabsf(x);
}

static inline float fmax32(float x, float y) {
  return fmaxf(x, y);
}

static inline float fmin32(float x, float y) {
  return fminf(x, y);
}

static inline float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

static inline bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

static inline bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

static inline bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

static inline bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

static inline int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

static inline int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

static inline int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

static inline int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

static inline uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

static inline uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

static inline uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

static inline uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

static inline bool ftob_f32_bool(float x) {
  return x != 0;
}

static inline float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
static inline float futrts_log32(float x) {
  return log(x);
}

static inline float futrts_log2_32(float x) {
  return log2(x);
}

static inline float futrts_log10_32(float x) {
  return log10(x);
}

static inline float futrts_log1p_32(float x) {
  return log1p(x);
}

static inline float futrts_sqrt32(float x) {
  return sqrt(x);
}

static inline float futrts_cbrt32(float x) {
  return cbrt(x);
}

static inline float futrts_exp32(float x) {
  return exp(x);
}

static inline float futrts_cos32(float x) {
  return cos(x);
}

static inline float futrts_sin32(float x) {
  return sin(x);
}

static inline float futrts_tan32(float x) {
  return tan(x);
}

static inline float futrts_acos32(float x) {
  return acos(x);
}

static inline float futrts_asin32(float x) {
  return asin(x);
}

static inline float futrts_atan32(float x) {
  return atan(x);
}

static inline float futrts_cosh32(float x) {
  return cosh(x);
}

static inline float futrts_sinh32(float x) {
  return sinh(x);
}

static inline float futrts_tanh32(float x) {
  return tanh(x);
}

static inline float futrts_acosh32(float x) {
  return acosh(x);
}

static inline float futrts_asinh32(float x) {
  return asinh(x);
}

static inline float futrts_atanh32(float x) {
  return atanh(x);
}

static inline float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

static inline float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

static inline float futrts_gamma32(float x) {
  return tgamma(x);
}

static inline float futrts_lgamma32(float x) {
  return lgamma(x);
}

static inline float futrts_erf32(float x) {
  return erf(x);
}

static inline float futrts_erfc32(float x) {
  return erfc(x);
}

static inline float fmod32(float x, float y) {
  return fmod(x, y);
}

static inline float futrts_round32(float x) {
  return rint(x);
}

static inline float futrts_floor32(float x) {
  return floor(x);
}

static inline float futrts_ceil32(float x) {
  return ceil(x);
}

static inline float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

static inline float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

static inline float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

static inline float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

static inline float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

static inline float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

static inline float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

static inline float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

static inline float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
static inline float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline float futrts_exp32(float x) {
  return exp(x);
}

static inline float futrts_cos32(float x) {
  return cos(x);
}

static inline float futrts_sin32(float x) {
  return sin(x);
}

static inline float futrts_tan32(float x) {
  return tan(x);
}

static inline float futrts_acos32(float x) {
  return acos(x);
}

static inline float futrts_asin32(float x) {
  return asin(x);
}

static inline float futrts_atan32(float x) {
  return atan(x);
}

static inline float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

static inline float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

static inline float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

static inline float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

static inline float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

static inline float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

static inline float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

static inline float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
static inline float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
static inline float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
static inline float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
static inline float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

static inline float futrts_round32(float x) {
  return round(x);
}

static inline float futrts_floor32(float x) {
  return floor(x);
}

static inline float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
static inline float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

static inline float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

static inline float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

static inline float futrts_log32(float x) {
  return logf(x);
}

static inline float futrts_log2_32(float x) {
  return log2f(x);
}

static inline float futrts_log10_32(float x) {
  return log10f(x);
}

static inline float futrts_log1p_32(float x) {
  return log1pf(x);
}

static inline float futrts_sqrt32(float x) {
  return sqrtf(x);
}

static inline float futrts_cbrt32(float x) {
  return cbrtf(x);
}

static inline float futrts_exp32(float x) {
  return expf(x);
}

static inline float futrts_cos32(float x) {
  return cosf(x);
}

static inline float futrts_sin32(float x) {
  return sinf(x);
}

static inline float futrts_tan32(float x) {
  return tanf(x);
}

static inline float futrts_acos32(float x) {
  return acosf(x);
}

static inline float futrts_asin32(float x) {
  return asinf(x);
}

static inline float futrts_atan32(float x) {
  return atanf(x);
}

static inline float futrts_cosh32(float x) {
  return coshf(x);
}

static inline float futrts_sinh32(float x) {
  return sinhf(x);
}

static inline float futrts_tanh32(float x) {
  return tanhf(x);
}

static inline float futrts_acosh32(float x) {
  return acoshf(x);
}

static inline float futrts_asinh32(float x) {
  return asinhf(x);
}

static inline float futrts_atanh32(float x) {
  return atanhf(x);
}

static inline float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

static inline float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

static inline float futrts_gamma32(float x) {
  return tgammaf(x);
}

static inline float futrts_lgamma32(float x) {
  return lgammaf(x);
}

static inline float futrts_erf32(float x) {
  return erff(x);
}

static inline float futrts_erfc32(float x) {
  return erfcf(x);
}

static inline float fmod32(float x, float y) {
  return fmodf(x, y);
}

static inline float futrts_round32(float x) {
  return rintf(x);
}

static inline float futrts_floor32(float x) {
  return floorf(x);
}

static inline float futrts_ceil32(float x) {
  return ceilf(x);
}

static inline float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

static inline float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

static inline float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

static inline float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
static inline int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

static inline float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
static inline int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

static inline float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

static inline float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

#if ISPC
static inline bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

static inline bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

static inline double fdiv64(double x, double y) {
  return x / y;
}

static inline double fadd64(double x, double y) {
  return x + y;
}

static inline double fsub64(double x, double y) {
  return x - y;
}

static inline double fmul64(double x, double y) {
  return x * y;
}

static inline bool cmplt64(double x, double y) {
  return x < y;
}

static inline bool cmple64(double x, double y) {
  return x <= y;
}

static inline double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

static inline double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

static inline double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

static inline double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

static inline double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

static inline double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

static inline double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

static inline double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

static inline double fabs64(double x) {
  return abs(x);
}

static inline double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

static inline double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

static inline double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

static inline double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

static inline double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

static inline double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

static inline double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

static inline double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
static inline double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_exp64(double x) {
  return exp(x);
}

static inline double futrts_cos64(double x) {
  return cos(x);
}

static inline double futrts_sin64(double x) {
  return sin(x);
}

static inline double futrts_tan64(double x) {
  return tan(x);
}

static inline double futrts_acos64(double x) {
  return acos(x);
}

static inline double futrts_asin64(double x) {
  return asin(x);
}

static inline double futrts_atan64(double x) {
  return atan(x);
}

static inline double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

static inline double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

static inline double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

static inline double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

static inline double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

static inline double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

static inline double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
static inline double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
static inline double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
static inline double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
static inline double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
static inline double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

static inline double futrts_round64(double x) {
  return round(x);
}

static inline double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
static inline float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_floor64(double x) {
  return floor(x);
}

static inline bool futrts_isnan64(double x) {
  return isnan(x);
}

static inline int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

static inline int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

static inline int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

static inline int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

static inline uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

static inline uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

static inline uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

static inline uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

static inline bool ftob_f64_bool(double x) {
  return x != 0.0;
}

static inline double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

static inline int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

static inline double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

static inline double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

static inline double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

static inline double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

static inline double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

static inline float fpconv_f32_f32(float x) {
  return (float) x;
}

static inline double fpconv_f32_f64(float x) {
  return (double) x;
}

static inline float fpconv_f64_f32(double x) {
  return (float) x;
}

static inline double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

static inline double fdiv64(double x, double y) {
  return x / y;
}

static inline double fadd64(double x, double y) {
  return x + y;
}

static inline double fsub64(double x, double y) {
  return x - y;
}

static inline double fmul64(double x, double y) {
  return x * y;
}

static inline bool cmplt64(double x, double y) {
  return x < y;
}

static inline bool cmple64(double x, double y) {
  return x <= y;
}

static inline double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

static inline double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

static inline double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

static inline double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

static inline double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

static inline double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

static inline double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

static inline double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

static inline double fabs64(double x) {
  return fabs(x);
}

static inline double fmax64(double x, double y) {
  return fmax(x, y);
}

static inline double fmin64(double x, double y) {
  return fmin(x, y);
}

static inline double fpow64(double x, double y) {
  return pow(x, y);
}

static inline double futrts_log64(double x) {
  return log(x);
}

static inline double futrts_log2_64(double x) {
  return log2(x);
}

static inline double futrts_log10_64(double x) {
  return log10(x);
}

static inline double futrts_log1p_64(double x) {
  return log1p(x);
}

static inline double futrts_sqrt64(double x) {
  return sqrt(x);
}

static inline double futrts_cbrt64(double x) {
  return cbrt(x);
}

static inline double futrts_exp64(double x) {
  return exp(x);
}

static inline double futrts_cos64(double x) {
  return cos(x);
}

static inline double futrts_sin64(double x) {
  return sin(x);
}

static inline double futrts_tan64(double x) {
  return tan(x);
}

static inline double futrts_acos64(double x) {
  return acos(x);
}

static inline double futrts_asin64(double x) {
  return asin(x);
}

static inline double futrts_atan64(double x) {
  return atan(x);
}

static inline double futrts_cosh64(double x) {
  return cosh(x);
}

static inline double futrts_sinh64(double x) {
  return sinh(x);
}

static inline double futrts_tanh64(double x) {
  return tanh(x);
}

static inline double futrts_acosh64(double x) {
  return acosh(x);
}

static inline double futrts_asinh64(double x) {
  return asinh(x);
}

static inline double futrts_atanh64(double x) {
  return atanh(x);
}

static inline double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

static inline double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

static inline double futrts_gamma64(double x) {
  return tgamma(x);
}

static inline double futrts_lgamma64(double x) {
  return lgamma(x);
}

static inline double futrts_erf64(double x) {
  return erf(x);
}

static inline double futrts_erfc64(double x) {
  return erfc(x);
}

static inline double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

static inline double futrts_round64(double x) {
  return rint(x);
}

static inline double futrts_ceil64(double x) {
  return ceil(x);
}

static inline float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

static inline double futrts_floor64(double x) {
  return floor(x);
}

static inline bool futrts_isnan64(double x) {
  return isnan(x);
}

static inline bool futrts_isinf64(double x) {
  return isinf(x);
}

static inline int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

static inline int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

static inline int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

static inline int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

static inline uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

static inline uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

static inline uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

static inline uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

static inline bool ftob_f64_bool(double x) {
  return x != 0;
}

static inline double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

static inline int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

static inline double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

static inline double fmod64(double x, double y) {
  return fmod(x, y);
}

static inline double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

static inline double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

static inline double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

static inline float fpconv_f32_f32(float x) {
  return (float) x;
}

static inline double fpconv_f32_f64(float x) {
  return (double) x;
}

static inline float fpconv_f64_f32(double x) {
  return (float) x;
}

static inline double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

static inline f16 fadd16(f16 x, f16 y) {
  return x + y;
}

static inline f16 fsub16(f16 x, f16 y) {
  return x - y;
}

static inline f16 fmul16(f16 x, f16 y) {
  return x * y;
}

static inline bool cmplt16(f16 x, f16 y) {
  return x < y;
}

static inline bool cmple16(f16 x, f16 y) {
  return x <= y;
}

static inline f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

static inline f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

static inline f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

static inline f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

static inline f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

static inline f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

static inline f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

static inline f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

static inline int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

static inline int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

static inline int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

static inline int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

static inline uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

static inline uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

static inline uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

static inline uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

static inline bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

static inline f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
static inline bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

static inline f16 fabs16(f16 x) {
  return fabs(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
static inline f16 fabs16(f16 x) {
  return abs(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}
#else // Assuming CUDA.

static inline f16 fabs16(f16 x) {
  return fabsf(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
static inline bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
static inline bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

static inline bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
static inline f16 futrts_log16(f16 x) {
  return log(x);
}

static inline f16 futrts_log2_16(f16 x) {
  return log2(x);
}

static inline f16 futrts_log10_16(f16 x) {
  return log10(x);
}

static inline f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

static inline f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

static inline f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

static inline f16 futrts_exp16(f16 x) {
  return exp(x);
}

static inline f16 futrts_cos16(f16 x) {
  return cos(x);
}

static inline f16 futrts_sin16(f16 x) {
  return sin(x);
}

static inline f16 futrts_tan16(f16 x) {
  return tan(x);
}

static inline f16 futrts_acos16(f16 x) {
  return acos(x);
}

static inline f16 futrts_asin16(f16 x) {
  return asin(x);
}

static inline f16 futrts_atan16(f16 x) {
  return atan(x);
}

static inline f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

static inline f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

static inline f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

static inline f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

static inline f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

static inline f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

static inline f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

static inline f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

static inline f16 futrts_erf16(f16 x) {
  return erf(x);
}

static inline f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

static inline f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

static inline f16 futrts_round16(f16 x) {
  return rint(x);
}

static inline f16 futrts_floor16(f16 x) {
  return floor(x);
}

static inline f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

static inline f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

static inline f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

static inline f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

static inline f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

static inline f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

static inline f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

static inline f16 futrts_exp16(f16 x) {
  return exp(x);
}

static inline f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

static inline f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

static inline f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

static inline f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

static inline f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

static inline f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

static inline f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

static inline f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

static inline f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

static inline f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

static inline f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

static inline f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
static inline f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
static inline f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

static inline f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

static inline f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

static inline f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

static inline f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

static inline f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

static inline f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

static inline f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

static inline f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

static inline f16 futrts_log16(f16 x) {
  return hlog(x);
}

static inline f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

static inline f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

static inline f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

static inline f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

static inline f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

static inline f16 futrts_exp16(f16 x) {
  return hexp(x);
}

static inline f16 futrts_cos16(f16 x) {
  return hcos(x);
}

static inline f16 futrts_sin16(f16 x) {
  return hsin(x);
}

static inline f16 futrts_tan16(f16 x) {
  return tanf(x);
}

static inline f16 futrts_acos16(f16 x) {
  return acosf(x);
}

static inline f16 futrts_asin16(f16 x) {
  return asinf(x);
}

static inline f16 futrts_atan16(f16 x) {
  return atanf(x);
}

static inline f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

static inline f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

static inline f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

static inline f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

static inline f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

static inline f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

static inline f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

static inline f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

static inline f16 futrts_erf16(f16 x) {
  return erff(x);
}

static inline f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

static inline f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

static inline f16 futrts_round16(f16 x) {
  return rintf(x);
}

static inline f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

static inline f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

static inline f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
static inline int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
static inline f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

static inline int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

static inline f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
static inline int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

static inline f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

static inline f16 fabs16(f16 x) {
  return fabs32(x);
}

static inline f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

static inline f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

static inline f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

static inline bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

static inline bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

static inline f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

static inline f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

static inline f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

static inline f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

static inline f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

static inline f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

static inline f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

static inline f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

static inline f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

static inline f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

static inline f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

static inline f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

static inline f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

static inline f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

static inline f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

static inline f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

static inline f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

static inline f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

static inline f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

static inline f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

static inline f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

static inline f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

static inline f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

static inline f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

static inline f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

static inline f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

static inline f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

static inline f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

static inline f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

static inline f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

static inline f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

static inline f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

static inline f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

static inline int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

static inline f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

static inline int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

static inline f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

static inline f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

static inline float fpconv_f16_f16(f16 x) {
  return x;
}

static inline float fpconv_f16_f32(f16 x) {
  return x;
}

static inline f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

static inline double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
static inline f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
static inline f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
    bool main_res_12953;
};
static bool static_array_realtype_42033[2] = {1, 0};
static int8_t static_array_realtype_42038[16] = {(int8_t) 0, (int8_t) 1, (int8_t) 2, (int8_t) 3, (int8_t) 4, (int8_t) 5, (int8_t) 6, (int8_t) 7, (int8_t) 8, (int8_t) 9, (int8_t) 10, (int8_t) 11, (int8_t) 12, (int8_t) 13, (int8_t) 14, (int8_t) 15};
static int8_t static_array_realtype_42043[16] = {(int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8, (int8_t) 0, (int8_t) 8};
static const int num_tuning_params = 0;
static const char *tuning_param_names[1];
static const char *tuning_param_vars[1];
static const char *tuning_param_classes[1];
static int64_t *tuning_param_defaults[1];
// start of scheduler.h

// First, the API that the generated code will access.  In principle,
// we could then compile the scheduler separately and link an object
// file with the generated code.  In practice, we will embed all of
// this in the generated code.

// Scheduler handle.
struct scheduler;

// Initialise a scheduler (and start worker threads).
static int scheduler_init(struct scheduler *scheduler,
                          int num_workers,
                          double kappa);

// Shut down a scheduler (and destroy worker threads).
static int scheduler_destroy(struct scheduler *scheduler);

// Figure out the smallest amount of work that amortises task
// creation.
static int determine_kappa(double *kappa);

// How a segop should be scheduled.
enum scheduling {
  DYNAMIC,
  STATIC
};

// How a given task should be executed.  Filled out by the scheduler
// and passed to the segop function
struct scheduler_info {
  int64_t iter_pr_subtask;
  int64_t remainder;
  int nsubtasks;
  enum scheduling sched;
  int wake_up_threads;

  int64_t *task_time;
  int64_t *task_iter;
};

// A segop function.  This is what you hand the scheduler for
// execution.
typedef int (*segop_fn)(void* args,
                        int64_t iterations,
                        int tid,
                        struct scheduler_info info);

// A task for the scheduler to execute.
struct scheduler_segop {
  void *args;
  segop_fn top_level_fn;
  segop_fn nested_fn;
  int64_t iterations;
  enum scheduling sched;

  // Pointers to timer and iter associated with the task
  int64_t *task_time;
  int64_t *task_iter;

  // For debugging
  const char* name;
};

static inline int scheduler_prepare_task(struct scheduler *scheduler,
                                         struct scheduler_segop *task);

typedef int (*parloop_fn)(void* args,
                          int64_t start,
                          int64_t end,
                          int subtask_id,
                          int tid);

// A parallel parloop task.
struct scheduler_parloop {
  void* args;
  parloop_fn fn;
  int64_t iterations;
  struct scheduler_info info;

  // For debugging
  const char* name;
};

static inline int scheduler_execute_task(struct scheduler *scheduler,
                                         struct scheduler_parloop *task);

// Then the API implementation.

#include <signal.h>

#if defined(_WIN32)
#include <windows.h>
#elif defined(__APPLE__)
#include <sys/sysctl.h>
// For getting cpu usage of threads
#include <mach/mach.h>
#include <sys/resource.h>
#elif defined(__linux__)
#include <sys/sysinfo.h>
#include <sys/resource.h>
#include <signal.h>
#elif defined(__EMSCRIPTEN__)
#include <emscripten/threading.h>
#include <sys/sysinfo.h>
#include <sys/resource.h>
#include <signal.h>
#endif

/* Multicore Utility functions */

/* A wrapper for getting rusage on Linux and MacOS */
/* TODO maybe figure out this for windows */
static inline int getrusage_thread(struct rusage *rusage)
{
  int err = -1;
#if  defined(__APPLE__)
    thread_basic_info_data_t info = { 0 };
    mach_msg_type_number_t info_count = THREAD_BASIC_INFO_COUNT;
    kern_return_t kern_err;

    kern_err = thread_info(mach_thread_self(),
                           THREAD_BASIC_INFO,
                           (thread_info_t)&info,
                           &info_count);
    if (kern_err == KERN_SUCCESS) {
        memset(rusage, 0, sizeof(struct rusage));
        rusage->ru_utime.tv_sec = info.user_time.seconds;
        rusage->ru_utime.tv_usec = info.user_time.microseconds;
        rusage->ru_stime.tv_sec = info.system_time.seconds;
        rusage->ru_stime.tv_usec = info.system_time.microseconds;
        err = 0;
    } else {
        errno = EINVAL;
    }
#elif defined(__linux__) || __EMSCRIPTEN__
    err = getrusage(RUSAGE_THREAD, rusage);
#endif
    return err;
}

/* returns the number of logical cores */
static int num_processors()
{
#if  defined(_WIN32)
/* https://docs.microsoft.com/en-us/windows/win32/api/sysinfoapi/ns-sysinfoapi-system_info */
    SYSTEM_INFO sysinfo;
    GetSystemInfo(&sysinfo);
    int ncores = sysinfo.dwNumberOfProcessors;
    fprintf(stderr, "Found %d cores on your Windows machine\n Is that correct?\n", ncores);
    return ncores;
#elif defined(__APPLE__)
    int ncores;
    size_t ncores_size = sizeof(ncores);
    CHECK_ERRNO(sysctlbyname("hw.logicalcpu", &ncores, &ncores_size, NULL, 0),
                "sysctlbyname (hw.logicalcpu)");
    return ncores;
#elif defined(__linux__)
  return get_nprocs();
#elif __EMSCRIPTEN__
  return emscripten_num_logical_cores();
#else
  fprintf(stderr, "operating system not recognised\n");
  return -1;
#endif
}

static unsigned int g_seed;

// Used to seed the generator.
static inline void fast_srand(unsigned int seed) {
    g_seed = seed;
}

// Compute a pseudorandom integer.
// Output value in range [0, 32767]
static inline unsigned int fast_rand(void) {
    g_seed = (214013*g_seed+2531011);
    return (g_seed>>16)&0x7FFF;
}

struct subtask_queue {
  int capacity;             // Size of the buffer.
  int first;                // Index of the start of the ring buffer.
  int num_used;             // Number of used elements in the buffer.
  struct subtask **buffer;

  pthread_mutex_t mutex;    // Mutex used for synchronisation.
  pthread_cond_t cond;      // Condition variable used for synchronisation.
  int dead;

#if defined(MCPROFILE)
  /* Profiling fields */
  uint64_t time_enqueue;
  uint64_t time_dequeue;
  uint64_t n_dequeues;
  uint64_t n_enqueues;
#endif
};

/* A subtask that can be executed by a worker */
struct subtask {
  /* The parloop function */
  parloop_fn fn;
  /* Execution parameters */
  void* args;
  int64_t start, end;
  int id;

  /* Dynamic scheduling parameters */
  int chunkable;
  int64_t chunk_size;

  /* Shared variables across subtasks */
  volatile int *counter; // Counter for ongoing subtasks
  // Shared task timers and iterators
  int64_t *task_time;
  int64_t *task_iter;

  /* For debugging */
  const char *name;
};


struct worker {
  pthread_t thread;
  struct scheduler *scheduler;  /* Reference to the scheduler struct the worker belongs to*/
  struct subtask_queue q;
  int dead;
  int tid;                      /* Just a thread id */

  /* "thread local" time fields used for online algorithm */
  uint64_t timer;
  uint64_t total;
  int nested; /* How nested the current computation is */

  // Profiling fields
  int output_usage;            /* Whether to dump thread usage */
  uint64_t time_spent_working; /* Time spent in parloop functions */
};

static inline void output_worker_usage(struct worker *worker)
{
  struct rusage usage;
  CHECK_ERRNO(getrusage_thread(&usage), "getrusage_thread");
  struct timeval user_cpu_time = usage.ru_utime;
  struct timeval sys_cpu_time = usage.ru_stime;
  fprintf(stderr, "tid: %2d - work time %10llu us - user time: %10llu us - sys: %10llu us\n",
          worker->tid,
          (long long unsigned)worker->time_spent_working / 1000,
          (long long unsigned)(user_cpu_time.tv_sec * 1000000 + user_cpu_time.tv_usec),
          (long long unsigned)(sys_cpu_time.tv_sec * 1000000 + sys_cpu_time.tv_usec));
}

/* Doubles the size of the queue */
static inline int subtask_queue_grow_queue(struct subtask_queue *subtask_queue) {

  int new_capacity = 2 * subtask_queue->capacity;
#ifdef MCDEBUG
  fprintf(stderr, "Growing queue to %d\n", subtask_queue->capacity * 2);
#endif

  struct subtask **new_buffer = calloc(new_capacity, sizeof(struct subtask*));
  for (int i = 0; i < subtask_queue->num_used; i++) {
    new_buffer[i] = subtask_queue->buffer[(subtask_queue->first + i) % subtask_queue->capacity];
  }

  free(subtask_queue->buffer);
  subtask_queue->buffer = new_buffer;
  subtask_queue->capacity = new_capacity;
  subtask_queue->first = 0;

  return 0;
}

// Initialise a job queue with the given capacity.  The queue starts out
// empty.  Returns non-zero on error.
static inline int subtask_queue_init(struct subtask_queue *subtask_queue, int capacity)
{
  assert(subtask_queue != NULL);
  memset(subtask_queue, 0, sizeof(struct subtask_queue));

  subtask_queue->capacity = capacity;
  subtask_queue->buffer = calloc(capacity, sizeof(struct subtask*));
  if (subtask_queue->buffer == NULL) {
    return -1;
  }

  CHECK_ERRNO(pthread_mutex_init(&subtask_queue->mutex, NULL), "pthread_mutex_init");
  CHECK_ERRNO(pthread_cond_init(&subtask_queue->cond, NULL), "pthread_cond_init");

  return 0;
}

// Destroy the job queue.  Blocks until the queue is empty before it
// is destroyed.
static inline int subtask_queue_destroy(struct subtask_queue *subtask_queue)
{
  assert(subtask_queue != NULL);

  CHECK_ERR(pthread_mutex_lock(&subtask_queue->mutex), "pthread_mutex_lock");

  while (subtask_queue->num_used != 0) {
    CHECK_ERR(pthread_cond_wait(&subtask_queue->cond, &subtask_queue->mutex), "pthread_cond_wait");
  }

  // Queue is now empty.  Let's kill it!
  subtask_queue->dead = 1;
  free(subtask_queue->buffer);
  CHECK_ERR(pthread_cond_broadcast(&subtask_queue->cond), "pthread_cond_broadcast");
  CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");

  return 0;
}

static inline void dump_queue(struct worker *worker)
{
  struct subtask_queue *subtask_queue = &worker->q;
  CHECK_ERR(pthread_mutex_lock(&subtask_queue->mutex), "pthread_mutex_lock");
  for (int i = 0; i < subtask_queue->num_used; i++) {
    struct subtask * subtask = subtask_queue->buffer[(subtask_queue->first + i) % subtask_queue->capacity];
    printf("queue tid %d with %d task %s\n", worker->tid, i, subtask->name);
  }
  CHECK_ERR(pthread_cond_broadcast(&subtask_queue->cond), "pthread_cond_broadcast");
  CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");
}

// Push an element onto the end of the job queue.  Blocks if the
// subtask_queue is full (its size is equal to its capacity).  Returns
// non-zero on error.  It is an error to push a job onto a queue that
// has been destroyed.
static inline int subtask_queue_enqueue(struct worker *worker, struct subtask *subtask )
{
  assert(worker != NULL);
  struct subtask_queue *subtask_queue = &worker->q;

#ifdef MCPROFILE
  uint64_t start = get_wall_time();
#endif

  CHECK_ERR(pthread_mutex_lock(&subtask_queue->mutex), "pthread_mutex_lock");
  // Wait until there is room in the subtask_queue.
  while (subtask_queue->num_used == subtask_queue->capacity && !subtask_queue->dead) {
    if (subtask_queue->num_used == subtask_queue->capacity) {
      CHECK_ERR(subtask_queue_grow_queue(subtask_queue), "subtask_queue_grow_queue");
      continue;
    }
    CHECK_ERR(pthread_cond_wait(&subtask_queue->cond, &subtask_queue->mutex), "pthread_cond_wait");
  }

  if (subtask_queue->dead) {
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");
    return -1;
  }

  // If we made it past the loop, there is room in the subtask_queue.
  subtask_queue->buffer[(subtask_queue->first + subtask_queue->num_used) % subtask_queue->capacity] = subtask;
  subtask_queue->num_used++;

#ifdef MCPROFILE
  uint64_t end = get_wall_time();
  subtask_queue->time_enqueue += (end - start);
  subtask_queue->n_enqueues++;
#endif
  // Broadcast a reader (if any) that there is now an element.
  CHECK_ERR(pthread_cond_broadcast(&subtask_queue->cond), "pthread_cond_broadcast");
  CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");

  return 0;
}


/* Like subtask_queue_dequeue, but with two differences:
   1) the subtask is stolen from the __front__ of the queue
   2) returns immediately if there is no subtasks queued,
      as we dont' want to block on another workers queue and
*/
static inline int subtask_queue_steal(struct worker *worker,
                                      struct subtask **subtask)
{
  struct subtask_queue *subtask_queue = &worker->q;
  assert(subtask_queue != NULL);

#ifdef MCPROFILE
  uint64_t start = get_wall_time();
#endif
  CHECK_ERR(pthread_mutex_lock(&subtask_queue->mutex), "pthread_mutex_lock");

  if (subtask_queue->num_used == 0) {
    CHECK_ERR(pthread_cond_broadcast(&subtask_queue->cond), "pthread_cond_broadcast");
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");
    return 1;
  }

  if (subtask_queue->dead) {
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");
    return -1;
  }

  // Tasks gets stolen from the "front"
  struct subtask *cur_back = subtask_queue->buffer[subtask_queue->first];
  struct subtask *new_subtask = NULL;
  int remaining_iter = cur_back->end - cur_back->start;
  // If subtask is chunkable, we steal half of the iterations
  if (cur_back->chunkable && remaining_iter > 1) {
      int64_t half = remaining_iter / 2;
      new_subtask = malloc(sizeof(struct subtask));
      *new_subtask = *cur_back;
      new_subtask->start = cur_back->end - half;
      cur_back->end = new_subtask->start;
      __atomic_fetch_add(cur_back->counter, 1, __ATOMIC_RELAXED);
  } else {
    new_subtask = cur_back;
    subtask_queue->num_used--;
    subtask_queue->first = (subtask_queue->first + 1) % subtask_queue->capacity;
  }
  *subtask = new_subtask;

  if (*subtask == NULL) {
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthred_mutex_unlock");
    return 1;
  }

#ifdef MCPROFILE
  uint64_t end = get_wall_time();
  subtask_queue->time_dequeue += (end - start);
  subtask_queue->n_dequeues++;
#endif

  // Broadcast a writer (if any) that there is now room for more.
  CHECK_ERR(pthread_cond_broadcast(&subtask_queue->cond), "pthread_cond_broadcast");
  CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");

  return 0;
}


// Pop an element from the back of the job queue.
// Optional argument can be provided to block or not
static inline int subtask_queue_dequeue(struct worker *worker,
                                        struct subtask **subtask, int blocking)
{
  assert(worker != NULL);
  struct subtask_queue *subtask_queue = &worker->q;

#ifdef MCPROFILE
  uint64_t start = get_wall_time();
#endif

  CHECK_ERR(pthread_mutex_lock(&subtask_queue->mutex), "pthread_mutex_lock");
  if (subtask_queue->num_used == 0 && !blocking) {
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");
    return 1;
  }
  // Try to steal some work while the subtask_queue is empty
  while (subtask_queue->num_used == 0 && !subtask_queue->dead) {
    pthread_cond_wait(&subtask_queue->cond, &subtask_queue->mutex);
  }

  if (subtask_queue->dead) {
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");
    return -1;
  }

  // dequeue pops from the back
  *subtask = subtask_queue->buffer[(subtask_queue->first + subtask_queue->num_used - 1) % subtask_queue->capacity];
  subtask_queue->num_used--;

  if (*subtask == NULL) {
    assert(!"got NULL ptr");
    CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthred_mutex_unlock");
    return -1;
  }

#ifdef MCPROFILE
  uint64_t end = get_wall_time();
  subtask_queue->time_dequeue += (end - start);
  subtask_queue->n_dequeues++;
#endif

  // Broadcast a writer (if any) that there is now room for more.
  CHECK_ERR(pthread_cond_broadcast(&subtask_queue->cond), "pthread_cond_broadcast");
  CHECK_ERR(pthread_mutex_unlock(&subtask_queue->mutex), "pthread_mutex_unlock");

  return 0;
}

static inline int subtask_queue_is_empty(struct subtask_queue *subtask_queue)
{
  return subtask_queue->num_used == 0;
}

/* Scheduler definitions */

struct scheduler {
  struct worker *workers;
  int num_threads;
  int minimum_chunk_size;


  // If there is work to steal => active_work > 0
  volatile int active_work;

  // Only one error can be returned at the time now.  Maybe we can
  // provide a stack like structure for pushing errors onto if we wish
  // to backpropagte multiple errors
  volatile int error;

  // kappa time unit in nanoseconds
  double kappa;
};


// Thread local variable worker struct
// Note that, accesses to tls variables are expensive
// Minimize direct references to this variable
__thread struct worker* worker_local = NULL;

static int64_t total_now(int64_t total, int64_t time) {
  return total + (get_wall_time_ns() - time);
}

static int random_other_worker(struct scheduler *scheduler, int my_id) {
  int my_num_workers = scheduler->num_threads;
  assert(my_num_workers != 1);
  int i = fast_rand() % (my_num_workers - 1);
  if (i >= my_id) {
    i++;
  }
#ifdef MCDEBUG
  assert(i >= 0);
  assert(i < my_num_workers);
  assert(i != my_id);
#endif

  return i;
}

static inline int64_t compute_chunk_size(int64_t minimum_chunk_size, double kappa, struct subtask* subtask)
{
  double C = (double)*subtask->task_time / (double)*subtask->task_iter;
  if (C == 0.0F) C += DBL_EPSILON;
  return smax64((int64_t)(kappa / C), minimum_chunk_size);
}

/* Takes a chunk from subtask and enqueues the remaining iterations onto the worker's queue */
/* A no-op if the subtask is not chunkable */
static inline struct subtask* chunk_subtask(struct worker* worker, struct subtask *subtask)
{
  if (subtask->chunkable) {
    // Do we have information from previous runs avaliable
    if (*subtask->task_iter > 0) {
      subtask->chunk_size = compute_chunk_size(worker->scheduler->minimum_chunk_size,
                                               worker->scheduler->kappa,
                                               subtask);
      assert(subtask->chunk_size > 0);
    }
    int64_t remaining_iter = subtask->end - subtask->start;
    assert(remaining_iter > 0);
    if (remaining_iter > subtask->chunk_size) {
      struct subtask *new_subtask = malloc(sizeof(struct subtask));
      *new_subtask = *subtask;
      // increment the subtask join counter to account for new subtask
      __atomic_fetch_add(subtask->counter, 1, __ATOMIC_RELAXED);
      // Update range parameters
      subtask->end = subtask->start + subtask->chunk_size;
      new_subtask->start = subtask->end;
      subtask_queue_enqueue(worker, new_subtask);
    }
  }
  return subtask;
}

static inline int run_subtask(struct worker* worker, struct subtask* subtask)
{
  assert(subtask != NULL);
  assert(worker != NULL);

  subtask = chunk_subtask(worker, subtask);
  worker->total = 0;
  worker->timer = get_wall_time_ns();
#if defined(MCPROFILE)
  int64_t start = worker->timer;
#endif
  worker->nested++;
  int err = subtask->fn(subtask->args, subtask->start, subtask->end,
                        subtask->id,
                        worker->tid);
  worker->nested--;
  // Some error occured during some other subtask
  // so we just clean-up and return
  if (worker->scheduler->error != 0) {
    // Even a failed task counts as finished.
    __atomic_fetch_sub(subtask->counter, 1, __ATOMIC_RELAXED);
    free(subtask);
    return 0;
  }
  if (err != 0) {
    __atomic_store_n(&worker->scheduler->error, err, __ATOMIC_RELAXED);
  }
  // Total sequential time spent
  int64_t time_elapsed = total_now(worker->total, worker->timer);
#if defined(MCPROFILE)
  worker->time_spent_working += get_wall_time_ns() - start;
#endif
  int64_t iter = subtask->end - subtask->start;
  // report measurements
  // These updates should really be done using a single atomic CAS operation
  __atomic_fetch_add(subtask->task_time, time_elapsed, __ATOMIC_RELAXED);
  __atomic_fetch_add(subtask->task_iter, iter, __ATOMIC_RELAXED);
  // We need a fence here, since if the counter is decremented before either
  // of the two above are updated bad things can happen, e.g. if they are stack-allocated
  __atomic_thread_fence(__ATOMIC_SEQ_CST);
  __atomic_fetch_sub(subtask->counter, 1, __ATOMIC_RELAXED);
  free(subtask);
  return 0;
}


static inline int is_small(struct scheduler_segop *task, struct scheduler *scheduler, int *nsubtasks)
{
  int64_t time = *task->task_time;
  int64_t iter = *task->task_iter;

  if (task->sched == DYNAMIC || iter == 0) {
    *nsubtasks = scheduler->num_threads;
    return 0;
  }

  // Estimate the constant C
  double C = (double)time / (double)iter;
  double cur_task_iter = (double) task->iterations;

  // Returns true if the task is small i.e.
  // if the number of iterations times C is smaller
  // than the overhead of subtask creation
  if (C == 0.0F || C * cur_task_iter < scheduler->kappa) {
    *nsubtasks = 1;
    return 1;
  }

  // Else compute how many subtasks this tasks should create
  int64_t min_iter_pr_subtask = smax64(scheduler->kappa / C, 1);
  *nsubtasks = smin64(smax64(task->iterations / min_iter_pr_subtask, 1), scheduler->num_threads);

  return 0;
}

// TODO make this prettier
static inline struct subtask* create_subtask(parloop_fn fn,
                                             void* args,
                                             const char* name,
                                             volatile int* counter,
                                             int64_t *timer,
                                             int64_t *iter,
                                             int64_t start, int64_t end,
                                             int chunkable,
                                             int64_t chunk_size,
                                             int id)
{
  struct subtask* subtask = malloc(sizeof(struct subtask));
  if (subtask == NULL) {
    assert(!"malloc failed in create_subtask");
    return NULL;
  }
  subtask->fn         = fn;
  subtask->args       = args;

  subtask->counter    = counter;
  subtask->task_time  = timer;
  subtask->task_iter  = iter;

  subtask->start      = start;
  subtask->end        = end;
  subtask->id         = id;
  subtask->chunkable  = chunkable;
  subtask->chunk_size = chunk_size;

  subtask->name       = name;
  return subtask;
}

static int dummy_counter = 0;
static int64_t dummy_timer = 0;
static int64_t dummy_iter = 0;

static int dummy_fn(void *args, int64_t start, int64_t end, int subtask_id, int tid) {
  (void)args;
  (void)start;
  (void)end;
  (void)subtask_id;
  (void)tid;
  return 0;
}

// Wake up threads, who are blocking by pushing a dummy task
// onto their queue
static inline void wake_up_threads(struct scheduler *scheduler, int start_tid, int end_tid) {

#if defined(MCDEBUG)
  assert(start_tid >= 1);
  assert(end_tid <= scheduler->num_threads);
#endif
  for (int i = start_tid; i < end_tid; i++) {
    struct subtask *subtask = create_subtask(dummy_fn, NULL, "dummy_fn",
                                            &dummy_counter,
                                            &dummy_timer, &dummy_iter,
                                            0, 0,
                                            0, 0,
                                            0);
    CHECK_ERR(subtask_queue_enqueue(&scheduler->workers[i], subtask), "subtask_queue_enqueue");
  }
}

static inline int is_finished(struct worker *worker) {
  return worker->dead && subtask_queue_is_empty(&worker->q);
}

// Try to steal from a random queue
static inline int steal_from_random_worker(struct worker* worker)
{
  int my_id = worker->tid;
  struct scheduler* scheduler = worker->scheduler;
  int k = random_other_worker(scheduler, my_id);
  struct worker *worker_k = &scheduler->workers[k];
  struct subtask* subtask =  NULL;
  int retval = subtask_queue_steal(worker_k, &subtask);
  if (retval == 0) {
    subtask_queue_enqueue(worker, subtask);
    return 1;
  }
  return 0;
}


static inline void *scheduler_worker(void* args)
{
  struct worker *worker = (struct worker*) args;
  struct scheduler *scheduler = worker->scheduler;
  worker_local = worker;
  struct subtask *subtask = NULL;

  while(!is_finished(worker)) {
    if (!subtask_queue_is_empty(&worker->q)) {
      int retval = subtask_queue_dequeue(worker, &subtask, 0);
      if (retval == 0) {
        assert(subtask != NULL);
        CHECK_ERR(run_subtask(worker, subtask), "run_subtask");
      } // else someone stole our work

    } else if (scheduler->active_work) { /* steal */
      while (!is_finished(worker) && scheduler->active_work) {
        if (steal_from_random_worker(worker)) {
          break;
        }
      }
    } else { /* go back to sleep and wait for work */
      int retval = subtask_queue_dequeue(worker, &subtask, 1);
      if (retval == 0) {
        assert(subtask != NULL);
        CHECK_ERR(run_subtask(worker, subtask), "run_subtask");
      }
    }
  }

  assert(subtask_queue_is_empty(&worker->q));
#if defined(MCPROFILE)
  if (worker->output_usage)
    output_worker_usage(worker);
#endif
  return NULL;
}


static inline int scheduler_execute_parloop(struct scheduler *scheduler,
                                            struct scheduler_parloop *task,
                                            int64_t *timer)
{

  struct worker *worker = worker_local;

  struct scheduler_info info = task->info;
  int64_t iter_pr_subtask = info.iter_pr_subtask;
  int64_t remainder = info.remainder;
  int nsubtasks = info.nsubtasks;
  volatile int join_counter = nsubtasks;

  // Shared timer used to sum up all
  // sequential work from each subtask
  int64_t task_timer = 0;
  int64_t task_iter = 0;

  enum scheduling sched = info.sched;
  /* If each subtasks should be processed in chunks */
  int chunkable = sched == STATIC ? 0 : 1;
  int64_t chunk_size = scheduler->minimum_chunk_size; // The initial chunk size when no info is avaliable


  if (info.wake_up_threads || sched == DYNAMIC)
    __atomic_add_fetch(&scheduler->active_work, nsubtasks, __ATOMIC_RELAXED);

  int64_t start = 0;
  int64_t end = iter_pr_subtask + (int64_t)(remainder != 0);
  for (int subtask_id = 0; subtask_id < nsubtasks; subtask_id++) {
    struct subtask *subtask = create_subtask(task->fn, task->args, task->name,
                                              &join_counter,
                                              &task_timer, &task_iter,
                                              start, end,
                                              chunkable, chunk_size,
                                              subtask_id);
    assert(subtask != NULL);
    // In most cases we will never have more subtasks than workers,
    // but there can be exceptions (e.g. the kappa tuning function).
    struct worker *subtask_worker =
      worker->nested
      ? &scheduler->workers[worker->tid]
      : &scheduler->workers[subtask_id % scheduler->num_threads];
    CHECK_ERR(subtask_queue_enqueue(subtask_worker, subtask),
              "subtask_queue_enqueue");
    // Update range params
    start = end;
    end += iter_pr_subtask + ((subtask_id + 1) < remainder);
  }

  if (info.wake_up_threads) {
    wake_up_threads(scheduler, nsubtasks, scheduler->num_threads);
  }

  // Join (wait for subtasks to finish)
  while(join_counter != 0) {
    if (!subtask_queue_is_empty(&worker->q)) {
      struct subtask *subtask = NULL;
      int err = subtask_queue_dequeue(worker, &subtask, 0);
      if (err == 0 ) {
        CHECK_ERR(run_subtask(worker, subtask), "run_subtask");
      }
    } else {
      if (steal_from_random_worker(worker)) {
        struct subtask *subtask = NULL;
        int err = subtask_queue_dequeue(worker, &subtask, 0);
        if (err == 0) {
          CHECK_ERR(run_subtask(worker, subtask), "run_subtask");
        }
      }
    }
  }


  if (info.wake_up_threads || sched == DYNAMIC) {
    __atomic_sub_fetch(&scheduler->active_work, nsubtasks, __ATOMIC_RELAXED);
  }

  // Write back timing results of all sequential work
  (*timer) += task_timer;
  return scheduler->error;
}


static inline int scheduler_execute_task(struct scheduler *scheduler,
                                         struct scheduler_parloop *task)
{

  struct worker *worker = worker_local;

  int err = 0;

  // How much sequential work was performed by the task
  int64_t task_timer = 0;

  /* Execute task sequential or parallel based on decision made earlier */
  if (task->info.nsubtasks == 1) {
    int64_t start = get_wall_time_ns();
    err = task->fn(task->args, 0, task->iterations, 0, worker->tid);
    int64_t end = get_wall_time_ns();
    task_timer = end - start;
    worker->time_spent_working += task_timer;
    // Report time measurements
    // TODO the update of both of these should really be a single atomic!!
    __atomic_fetch_add(task->info.task_time, task_timer, __ATOMIC_RELAXED);
    __atomic_fetch_add(task->info.task_iter, task->iterations, __ATOMIC_RELAXED);
  } else {
    // Add "before" time if we already are inside a task
    int64_t time_before = 0;
    if (worker->nested > 0) {
      time_before = total_now(worker->total, worker->timer);
    }

    err = scheduler_execute_parloop(scheduler, task, &task_timer);

    // Report time measurements
    // TODO the update of both of these should really be a single atomic!!
    __atomic_fetch_add(task->info.task_time, task_timer, __ATOMIC_RELAXED);
    __atomic_fetch_add(task->info.task_iter, task->iterations, __ATOMIC_RELAXED);

    // Update timers to account for new timings
    worker->total = time_before + task_timer;
    worker->timer = get_wall_time_ns();
  }


  return err;
}

/* Decide on how schedule the incoming task i.e. how many subtasks and
   to run sequential or (potentially nested) parallel code body */
static inline int scheduler_prepare_task(struct scheduler* scheduler,
                                         struct scheduler_segop *task)
{
  assert(task != NULL);

  struct worker *worker = worker_local;
  struct scheduler_info info;
  info.task_time = task->task_time;
  info.task_iter = task->task_iter;

  int nsubtasks;
  // Decide if task should be scheduled sequentially
  if (is_small(task, scheduler, &nsubtasks)) {
    info.iter_pr_subtask = task->iterations;
    info.remainder = 0;
    info.nsubtasks = nsubtasks;
    return task->top_level_fn(task->args, task->iterations, worker->tid, info);
  } else {
    info.iter_pr_subtask = task->iterations / nsubtasks;
    info.remainder = task->iterations % nsubtasks;
    info.sched = task->sched;
    switch (task->sched) {
    case STATIC:
      info.nsubtasks = info.iter_pr_subtask == 0 ? info.remainder : ((task->iterations - info.remainder) / info.iter_pr_subtask);
      break;
    case DYNAMIC:
      // As any thread can take any subtasks, we are being safe with using
      // an upper bound on the number of tasks such that the task allocate enough memory
      info.nsubtasks = info.iter_pr_subtask == 0 ? info.remainder : nsubtasks;
      break;
    default:
      assert(!"Got unknown scheduling");
    }
  }

  info.wake_up_threads = 0;
  // We only use the nested parallel segop function if we can't exchaust all cores
  // using the outer most level
  if (task->nested_fn != NULL && info.nsubtasks < scheduler->num_threads && info.nsubtasks == task->iterations) {
    if (worker->nested == 0)
      info.wake_up_threads = 1;
    return task->nested_fn(task->args, task->iterations, worker->tid, info);
  }

  return task->top_level_fn(task->args, task->iterations, worker->tid, info);
}

// Now some code for finding the proper value of kappa on a given
// machine (the smallest amount of work that amortises the cost of
// task creation).

struct tuning_struct {
  int32_t *free_tuning_res;
  int32_t *array;
};

// Reduction function over an integer array
static int tuning_loop(void *args, int64_t start, int64_t end,
                                     int flat_tid, int tid) {
  (void)flat_tid;
  (void)tid;

  int err = 0;
  struct tuning_struct *tuning_struct = (struct tuning_struct *) args;
  int32_t *array = tuning_struct->array;
  int32_t *tuning_res = tuning_struct->free_tuning_res;

  int32_t sum = 0;
  for (int i = start; i < end; i++) {
    int32_t y = array[i];
    sum = add32(sum, y);
  }
  *tuning_res = sum;
  return err;
}

// The main entry point for the tuning process.  Sets the provided
// variable ``kappa``.
static int determine_kappa(double *kappa) {
  int err = 0;

  int64_t iterations = 100000000;
  int64_t tuning_time = 0;
  int64_t tuning_iter = 0;

  int32_t *array = malloc(sizeof(int32_t) * iterations);
  for (int64_t i = 0; i < iterations; i++) {
    array[i] = fast_rand();
  }

  int64_t start_tuning = get_wall_time_ns();
  /* **************************** */
  /* Run sequential reduce first' */
  /* **************************** */
  int64_t tuning_sequentiual_start = get_wall_time_ns();
  struct tuning_struct tuning_struct;
  int32_t tuning_res;
  tuning_struct.free_tuning_res = &tuning_res;
  tuning_struct.array = array;

  err = tuning_loop(&tuning_struct, 0, iterations, 0, 0);
  int64_t tuning_sequentiual_end = get_wall_time_ns();
  int64_t sequential_elapsed = tuning_sequentiual_end - tuning_sequentiual_start;

  double C = (double)sequential_elapsed / (double)iterations;
  fprintf(stderr, " Time for sequential run is %lld - Found C %f\n", (long long)sequential_elapsed, C);

  /* ********************** */
  /* Now run tuning process */
  /* ********************** */
  // Setup a scheduler with a single worker
  struct scheduler scheduler;
  scheduler.num_threads = 1;
  scheduler.workers = malloc(sizeof(struct worker));
  worker_local = &scheduler.workers[0];
  worker_local->tid = 0;
  CHECK_ERR(subtask_queue_init(&scheduler.workers[0].q, 1024),
            "failed to init queue for worker %d\n", 0);

  // Start tuning for kappa
  double kappa_tune = 1000; // Initial kappa is 1 us
  double ratio;
  int64_t time_elapsed;
  while(1) {
    int64_t min_iter_pr_subtask = (int64_t) (kappa_tune / C) == 0 ? 1 : (kappa_tune / C);
    int nsubtasks = iterations / min_iter_pr_subtask;
    struct scheduler_info info;
    info.iter_pr_subtask = min_iter_pr_subtask;

    info.nsubtasks = iterations / min_iter_pr_subtask;
    info.remainder = iterations % min_iter_pr_subtask;
    info.task_time = &tuning_time;
    info.task_iter = &tuning_iter;
    info.sched = STATIC;

    struct scheduler_parloop parloop;
    parloop.name = "tuning_loop";
    parloop.fn = tuning_loop;
    parloop.args = &tuning_struct;
    parloop.iterations = iterations;
    parloop.info = info;

    int64_t tuning_chunked_start = get_wall_time_ns();
    int determine_kappa_err =
      scheduler_execute_task(&scheduler,
                             &parloop);
    assert(determine_kappa_err == 0);
    int64_t tuning_chunked_end = get_wall_time_ns();
    time_elapsed =  tuning_chunked_end - tuning_chunked_start;

    ratio = (double)time_elapsed / (double)sequential_elapsed;
    if (ratio < 1.055) {
      break;
    }
    kappa_tune += 100; // Increase by 100 ns at the time
    fprintf(stderr, "nsubtask %d - kappa %f - ratio %f\n", nsubtasks, kappa_tune, ratio);
  }

  int64_t end_tuning = get_wall_time_ns();
  fprintf(stderr, "tuning took %lld ns and found kappa %f - time %lld - ratio %f\n",
          (long long)end_tuning - start_tuning,
          kappa_tune,
          (long long)time_elapsed,
          ratio);
  *kappa = kappa_tune;

  // Clean-up
  CHECK_ERR(subtask_queue_destroy(&scheduler.workers[0].q), "failed to destroy queue");
  free(array);
  free(scheduler.workers);
  return err;
}

static int scheduler_init(struct scheduler *scheduler,
                          int num_workers,
                          double kappa) {
#ifdef FUTHARK_BACKEND_ispc
  int64_t get_gang_size();
  scheduler->minimum_chunk_size = get_gang_size();
#else
  scheduler->minimum_chunk_size = 1;
#endif

  assert(num_workers > 0);

  scheduler->kappa = kappa;
  scheduler->num_threads = num_workers;
  scheduler->active_work = 0;
  scheduler->error = 0;

  scheduler->workers = calloc(num_workers, sizeof(struct worker));

  const int queue_capacity = 1024;

  worker_local = &scheduler->workers[0];
  worker_local->tid = 0;
  worker_local->scheduler = scheduler;
  CHECK_ERR(subtask_queue_init(&worker_local->q, queue_capacity),
            "failed to init queue for worker %d\n", 0);

  for (int i = 1; i < num_workers; i++) {
    struct worker *cur_worker = &scheduler->workers[i];
    memset(cur_worker, 0, sizeof(struct worker));
    cur_worker->tid = i;
    cur_worker->output_usage = 0;
    cur_worker->scheduler = scheduler;
    CHECK_ERR(subtask_queue_init(&cur_worker->q, queue_capacity),
              "failed to init queue for worker %d\n", i);

    CHECK_ERR(pthread_create(&cur_worker->thread,
                             NULL,
                             &scheduler_worker,
                             cur_worker),
              "Failed to create worker %d\n", i);
  }

  return 0;
}

static int scheduler_destroy(struct scheduler *scheduler) {
  // We assume that this function is called by the thread controlling
  // the first worker, which is why we treat scheduler->workers[0]
  // specially here.

  // First mark them all as dead.
  for (int i = 1; i < scheduler->num_threads; i++) {
    struct worker *cur_worker = &scheduler->workers[i];
    cur_worker->dead = 1;
  }

  // Then destroy their task queues (this will wake up the threads and
  // make them do their shutdown).
  for (int i = 1; i < scheduler->num_threads; i++) {
    struct worker *cur_worker = &scheduler->workers[i];
    subtask_queue_destroy(&cur_worker->q);
  }

  // Then actually wait for them to stop.
  for (int i = 1; i < scheduler->num_threads; i++) {
    struct worker *cur_worker = &scheduler->workers[i];
    CHECK_ERR(pthread_join(scheduler->workers[i].thread, NULL), "pthread_join");
  }

  // And then destroy our own queue.
  subtask_queue_destroy(&scheduler->workers[0].q);

  free(scheduler->workers);

  return 0;
}

// End of scheduler.h

// Start of backends/multicore.h

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  const char *cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
  // Uniform fields above.

  int num_threads;
};

static void backend_context_config_setup(struct futhark_context_config* cfg) {
  cfg->num_threads = 0;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  (void)cfg;
}

void futhark_context_config_set_num_threads(struct futhark_context_config *cfg, int n) {
  cfg->num_threads = n;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config* cfg, const char *param_name, size_t param_value) {
  (void)cfg; (void)param_name; (void)param_value;
  return 1;
}

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  // Uniform fields above.

  struct scheduler scheduler;
  int total_runs;
  long int total_runtime;
  int64_t tuning_timing;
  int64_t tuning_iter;
};

int backend_context_setup(struct futhark_context* ctx) {
  // Initialize rand()
  fast_srand(time(0));

  int tune_kappa = 0;
  double kappa = 5.1f * 1000;

  if (tune_kappa) {
    if (determine_kappa(&kappa) != 0) {
      ctx->error = strdup("Failed to determine kappa.");
      return 1;
    }
  }

  if (scheduler_init(&ctx->scheduler,
                     ctx->cfg->num_threads > 0 ?
                     ctx->cfg->num_threads : num_processors(),
                     kappa) != 0) {
    ctx->error = strdup("Failed to initialise scheduler.");
    return 1;
  }

  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  (void)scheduler_destroy(&ctx->scheduler);
}

int futhark_context_sync(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

// End of backends/multicore.h

struct program {
    int64_t *futhark_mc_copy_parloop_42037_total_runtime;
    int *futhark_mc_copy_parloop_42037_runs;
    int64_t *futhark_mc_copy_parloop_42037_iter;
    int64_t futhark_mc_copy_parloop_42037_total_total_runtime;
    int futhark_mc_copy_parloop_42037_total_runs;
    int64_t futhark_mc_copy_parloop_42037_total_iter;
    int64_t *futhark_mc_copy_34864_task_42035_total_runtime;
    int *futhark_mc_copy_34864_task_42035_runs;
    int64_t *futhark_mc_copy_34864_task_42035_iter;
    int64_t futhark_mc_copy_34864_task_42035_total_time;
    int64_t futhark_mc_copy_34864_task_42035_total_iter;
    int64_t *futhark_mc_copy_parloop_42042_total_runtime;
    int *futhark_mc_copy_parloop_42042_runs;
    int64_t *futhark_mc_copy_parloop_42042_iter;
    int64_t futhark_mc_copy_parloop_42042_total_total_runtime;
    int futhark_mc_copy_parloop_42042_total_runs;
    int64_t futhark_mc_copy_parloop_42042_total_iter;
    int64_t *futhark_mc_copy_34875_task_42040_total_runtime;
    int *futhark_mc_copy_34875_task_42040_runs;
    int64_t *futhark_mc_copy_34875_task_42040_iter;
    int64_t futhark_mc_copy_34875_task_42040_total_time;
    int64_t futhark_mc_copy_34875_task_42040_total_iter;
    int64_t *futhark_mc_copy_parloop_42047_total_runtime;
    int *futhark_mc_copy_parloop_42047_runs;
    int64_t *futhark_mc_copy_parloop_42047_iter;
    int64_t futhark_mc_copy_parloop_42047_total_total_runtime;
    int futhark_mc_copy_parloop_42047_total_runs;
    int64_t futhark_mc_copy_parloop_42047_total_iter;
    int64_t *futhark_mc_copy_34886_task_42045_total_runtime;
    int *futhark_mc_copy_34886_task_42045_runs;
    int64_t *futhark_mc_copy_34886_task_42045_iter;
    int64_t futhark_mc_copy_34886_task_42045_total_time;
    int64_t futhark_mc_copy_34886_task_42045_total_iter;
    int64_t *futhark_mc_segmap_parloop_42051_total_runtime;
    int *futhark_mc_segmap_parloop_42051_runs;
    int64_t *futhark_mc_segmap_parloop_42051_iter;
    int64_t futhark_mc_segmap_parloop_42051_total_total_runtime;
    int futhark_mc_segmap_parloop_42051_total_runs;
    int64_t futhark_mc_segmap_parloop_42051_total_iter;
    int64_t *futhark_mc_segmap_task_42049_total_runtime;
    int *futhark_mc_segmap_task_42049_runs;
    int64_t *futhark_mc_segmap_task_42049_iter;
    int64_t futhark_mc_segmap_task_42049_total_time;
    int64_t futhark_mc_segmap_task_42049_total_iter;
    int64_t *futhark_mc_segmap_parloop_42060_total_runtime;
    int *futhark_mc_segmap_parloop_42060_runs;
    int64_t *futhark_mc_segmap_parloop_42060_iter;
    int64_t futhark_mc_segmap_parloop_42060_total_total_runtime;
    int futhark_mc_segmap_parloop_42060_total_runs;
    int64_t futhark_mc_segmap_parloop_42060_total_iter;
    int64_t *futhark_mc_segmap_task_42058_total_runtime;
    int *futhark_mc_segmap_task_42058_runs;
    int64_t *futhark_mc_segmap_task_42058_iter;
    int64_t futhark_mc_segmap_task_42058_total_time;
    int64_t futhark_mc_segmap_task_42058_total_iter;
    int64_t *futhark_mc_segmap_parloop_42069_total_runtime;
    int *futhark_mc_segmap_parloop_42069_runs;
    int64_t *futhark_mc_segmap_parloop_42069_iter;
    int64_t futhark_mc_segmap_parloop_42069_total_total_runtime;
    int futhark_mc_segmap_parloop_42069_total_runs;
    int64_t futhark_mc_segmap_parloop_42069_total_iter;
    int64_t *futhark_mc_segmap_task_42067_total_runtime;
    int *futhark_mc_segmap_task_42067_runs;
    int64_t *futhark_mc_segmap_task_42067_iter;
    int64_t futhark_mc_segmap_task_42067_total_time;
    int64_t futhark_mc_segmap_task_42067_total_iter;
    int64_t *futhark_mc_segmap_parloop_42078_total_runtime;
    int *futhark_mc_segmap_parloop_42078_runs;
    int64_t *futhark_mc_segmap_parloop_42078_iter;
    int64_t futhark_mc_segmap_parloop_42078_total_total_runtime;
    int futhark_mc_segmap_parloop_42078_total_runs;
    int64_t futhark_mc_segmap_parloop_42078_total_iter;
    int64_t *futhark_mc_segmap_task_42076_total_runtime;
    int *futhark_mc_segmap_task_42076_runs;
    int64_t *futhark_mc_segmap_task_42076_iter;
    int64_t futhark_mc_segmap_task_42076_total_time;
    int64_t futhark_mc_segmap_task_42076_total_iter;
    int64_t *futhark_mc_segmap_parloop_42087_total_runtime;
    int *futhark_mc_segmap_parloop_42087_runs;
    int64_t *futhark_mc_segmap_parloop_42087_iter;
    int64_t futhark_mc_segmap_parloop_42087_total_total_runtime;
    int futhark_mc_segmap_parloop_42087_total_runs;
    int64_t futhark_mc_segmap_parloop_42087_total_iter;
    int64_t *futhark_mc_segmap_task_42085_total_runtime;
    int *futhark_mc_segmap_task_42085_runs;
    int64_t *futhark_mc_segmap_task_42085_iter;
    int64_t futhark_mc_segmap_task_42085_total_time;
    int64_t futhark_mc_segmap_task_42085_total_iter;
    int64_t *futhark_mc_segmap_parloop_42096_total_runtime;
    int *futhark_mc_segmap_parloop_42096_runs;
    int64_t *futhark_mc_segmap_parloop_42096_iter;
    int64_t futhark_mc_segmap_parloop_42096_total_total_runtime;
    int futhark_mc_segmap_parloop_42096_total_runs;
    int64_t futhark_mc_segmap_parloop_42096_total_iter;
    int64_t *futhark_mc_segmap_task_42094_total_runtime;
    int *futhark_mc_segmap_task_42094_runs;
    int64_t *futhark_mc_segmap_task_42094_iter;
    int64_t futhark_mc_segmap_task_42094_total_time;
    int64_t futhark_mc_segmap_task_42094_total_iter;
    int64_t *futhark_mc_segmap_parloop_42105_total_runtime;
    int *futhark_mc_segmap_parloop_42105_runs;
    int64_t *futhark_mc_segmap_parloop_42105_iter;
    int64_t futhark_mc_segmap_parloop_42105_total_total_runtime;
    int futhark_mc_segmap_parloop_42105_total_runs;
    int64_t futhark_mc_segmap_parloop_42105_total_iter;
    int64_t *futhark_mc_segmap_task_42103_total_runtime;
    int *futhark_mc_segmap_task_42103_runs;
    int64_t *futhark_mc_segmap_task_42103_iter;
    int64_t futhark_mc_segmap_task_42103_total_time;
    int64_t futhark_mc_segmap_task_42103_total_iter;
    int64_t *futhark_mc_segmap_parloop_42114_total_runtime;
    int *futhark_mc_segmap_parloop_42114_runs;
    int64_t *futhark_mc_segmap_parloop_42114_iter;
    int64_t futhark_mc_segmap_parloop_42114_total_total_runtime;
    int futhark_mc_segmap_parloop_42114_total_runs;
    int64_t futhark_mc_segmap_parloop_42114_total_iter;
    int64_t *futhark_mc_segmap_task_42112_total_runtime;
    int *futhark_mc_segmap_task_42112_runs;
    int64_t *futhark_mc_segmap_task_42112_iter;
    int64_t futhark_mc_segmap_task_42112_total_time;
    int64_t futhark_mc_segmap_task_42112_total_iter;
    int64_t *futhark_mc_segmap_parloop_42123_total_runtime;
    int *futhark_mc_segmap_parloop_42123_runs;
    int64_t *futhark_mc_segmap_parloop_42123_iter;
    int64_t futhark_mc_segmap_parloop_42123_total_total_runtime;
    int futhark_mc_segmap_parloop_42123_total_runs;
    int64_t futhark_mc_segmap_parloop_42123_total_iter;
    int64_t *futhark_mc_segmap_task_42121_total_runtime;
    int *futhark_mc_segmap_task_42121_runs;
    int64_t *futhark_mc_segmap_task_42121_iter;
    int64_t futhark_mc_segmap_task_42121_total_time;
    int64_t futhark_mc_segmap_task_42121_total_iter;
    int64_t *futhark_mc_segmap_parloop_42132_total_runtime;
    int *futhark_mc_segmap_parloop_42132_runs;
    int64_t *futhark_mc_segmap_parloop_42132_iter;
    int64_t futhark_mc_segmap_parloop_42132_total_total_runtime;
    int futhark_mc_segmap_parloop_42132_total_runs;
    int64_t futhark_mc_segmap_parloop_42132_total_iter;
    int64_t *futhark_mc_segmap_task_42130_total_runtime;
    int *futhark_mc_segmap_task_42130_runs;
    int64_t *futhark_mc_segmap_task_42130_iter;
    int64_t futhark_mc_segmap_task_42130_total_time;
    int64_t futhark_mc_segmap_task_42130_total_iter;
    int64_t *futhark_mc_segmap_parloop_42141_total_runtime;
    int *futhark_mc_segmap_parloop_42141_runs;
    int64_t *futhark_mc_segmap_parloop_42141_iter;
    int64_t futhark_mc_segmap_parloop_42141_total_total_runtime;
    int futhark_mc_segmap_parloop_42141_total_runs;
    int64_t futhark_mc_segmap_parloop_42141_total_iter;
    int64_t *futhark_mc_segmap_task_42139_total_runtime;
    int *futhark_mc_segmap_task_42139_runs;
    int64_t *futhark_mc_segmap_task_42139_iter;
    int64_t futhark_mc_segmap_task_42139_total_time;
    int64_t futhark_mc_segmap_task_42139_total_iter;
    int64_t *futhark_mc_segmap_parloop_42150_total_runtime;
    int *futhark_mc_segmap_parloop_42150_runs;
    int64_t *futhark_mc_segmap_parloop_42150_iter;
    int64_t futhark_mc_segmap_parloop_42150_total_total_runtime;
    int futhark_mc_segmap_parloop_42150_total_runs;
    int64_t futhark_mc_segmap_parloop_42150_total_iter;
    int64_t *futhark_mc_segmap_task_42148_total_runtime;
    int *futhark_mc_segmap_task_42148_runs;
    int64_t *futhark_mc_segmap_task_42148_iter;
    int64_t futhark_mc_segmap_task_42148_total_time;
    int64_t futhark_mc_segmap_task_42148_total_iter;
    int64_t *futhark_mc_segred_stage_1_parloop_42158_total_runtime;
    int *futhark_mc_segred_stage_1_parloop_42158_runs;
    int64_t *futhark_mc_segred_stage_1_parloop_42158_iter;
    int64_t futhark_mc_segred_stage_1_parloop_42158_total_total_runtime;
    int futhark_mc_segred_stage_1_parloop_42158_total_runs;
    int64_t futhark_mc_segred_stage_1_parloop_42158_total_iter;
    int64_t *futhark_mc_segred_task_42155_total_runtime;
    int *futhark_mc_segred_task_42155_runs;
    int64_t *futhark_mc_segred_task_42155_iter;
    int64_t futhark_mc_segred_task_42155_total_time;
    int64_t futhark_mc_segred_task_42155_total_iter;
    int64_t *futhark_mc_segmap_parloop_42153_total_runtime;
    int *futhark_mc_segmap_parloop_42153_runs;
    int64_t *futhark_mc_segmap_parloop_42153_iter;
    int64_t futhark_mc_segmap_parloop_42153_total_total_runtime;
    int futhark_mc_segmap_parloop_42153_total_runs;
    int64_t futhark_mc_segmap_parloop_42153_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42151_total_runtime;
    int *futhark_mc_segmap_nested_task_42151_runs;
    int64_t *futhark_mc_segmap_nested_task_42151_iter;
    int64_t *futhark_mc_copy_parloop_42162_total_runtime;
    int *futhark_mc_copy_parloop_42162_runs;
    int64_t *futhark_mc_copy_parloop_42162_iter;
    int64_t futhark_mc_copy_parloop_42162_total_total_runtime;
    int futhark_mc_copy_parloop_42162_total_runs;
    int64_t futhark_mc_copy_parloop_42162_total_iter;
    int64_t *futhark_mc_copy_41766_task_42160_total_runtime;
    int *futhark_mc_copy_41766_task_42160_runs;
    int64_t *futhark_mc_copy_41766_task_42160_iter;
    int64_t futhark_mc_copy_41766_task_42160_total_time;
    int64_t futhark_mc_copy_41766_task_42160_total_iter;
    int64_t *futhark_mc_segmap_parloop_42145_total_runtime;
    int *futhark_mc_segmap_parloop_42145_runs;
    int64_t *futhark_mc_segmap_parloop_42145_iter;
    int64_t futhark_mc_segmap_parloop_42145_total_total_runtime;
    int futhark_mc_segmap_parloop_42145_total_runs;
    int64_t futhark_mc_segmap_parloop_42145_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42143_total_runtime;
    int *futhark_mc_segmap_nested_task_42143_runs;
    int64_t *futhark_mc_segmap_nested_task_42143_iter;
    int64_t *futhark_mc_copy_parloop_42166_total_runtime;
    int *futhark_mc_copy_parloop_42166_runs;
    int64_t *futhark_mc_copy_parloop_42166_iter;
    int64_t futhark_mc_copy_parloop_42166_total_total_runtime;
    int futhark_mc_copy_parloop_42166_total_runs;
    int64_t futhark_mc_copy_parloop_42166_total_iter;
    int64_t *futhark_mc_copy_41779_task_42164_total_runtime;
    int *futhark_mc_copy_41779_task_42164_runs;
    int64_t *futhark_mc_copy_41779_task_42164_iter;
    int64_t futhark_mc_copy_41779_task_42164_total_time;
    int64_t futhark_mc_copy_41779_task_42164_total_iter;
    int64_t *futhark_mc_segmap_parloop_42136_total_runtime;
    int *futhark_mc_segmap_parloop_42136_runs;
    int64_t *futhark_mc_segmap_parloop_42136_iter;
    int64_t futhark_mc_segmap_parloop_42136_total_total_runtime;
    int futhark_mc_segmap_parloop_42136_total_runs;
    int64_t futhark_mc_segmap_parloop_42136_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42134_total_runtime;
    int *futhark_mc_segmap_nested_task_42134_runs;
    int64_t *futhark_mc_segmap_nested_task_42134_iter;
    int64_t *futhark_mc_copy_parloop_42170_total_runtime;
    int *futhark_mc_copy_parloop_42170_runs;
    int64_t *futhark_mc_copy_parloop_42170_iter;
    int64_t futhark_mc_copy_parloop_42170_total_total_runtime;
    int futhark_mc_copy_parloop_42170_total_runs;
    int64_t futhark_mc_copy_parloop_42170_total_iter;
    int64_t *futhark_mc_copy_41795_task_42168_total_runtime;
    int *futhark_mc_copy_41795_task_42168_runs;
    int64_t *futhark_mc_copy_41795_task_42168_iter;
    int64_t futhark_mc_copy_41795_task_42168_total_time;
    int64_t futhark_mc_copy_41795_task_42168_total_iter;
    int64_t *futhark_mc_segmap_parloop_42127_total_runtime;
    int *futhark_mc_segmap_parloop_42127_runs;
    int64_t *futhark_mc_segmap_parloop_42127_iter;
    int64_t futhark_mc_segmap_parloop_42127_total_total_runtime;
    int futhark_mc_segmap_parloop_42127_total_runs;
    int64_t futhark_mc_segmap_parloop_42127_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42125_total_runtime;
    int *futhark_mc_segmap_nested_task_42125_runs;
    int64_t *futhark_mc_segmap_nested_task_42125_iter;
    int64_t *futhark_mc_copy_parloop_42174_total_runtime;
    int *futhark_mc_copy_parloop_42174_runs;
    int64_t *futhark_mc_copy_parloop_42174_iter;
    int64_t futhark_mc_copy_parloop_42174_total_total_runtime;
    int futhark_mc_copy_parloop_42174_total_runs;
    int64_t futhark_mc_copy_parloop_42174_total_iter;
    int64_t *futhark_mc_copy_41814_task_42172_total_runtime;
    int *futhark_mc_copy_41814_task_42172_runs;
    int64_t *futhark_mc_copy_41814_task_42172_iter;
    int64_t futhark_mc_copy_41814_task_42172_total_time;
    int64_t futhark_mc_copy_41814_task_42172_total_iter;
    int64_t *futhark_mc_segmap_parloop_42118_total_runtime;
    int *futhark_mc_segmap_parloop_42118_runs;
    int64_t *futhark_mc_segmap_parloop_42118_iter;
    int64_t futhark_mc_segmap_parloop_42118_total_total_runtime;
    int futhark_mc_segmap_parloop_42118_total_runs;
    int64_t futhark_mc_segmap_parloop_42118_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42116_total_runtime;
    int *futhark_mc_segmap_nested_task_42116_runs;
    int64_t *futhark_mc_segmap_nested_task_42116_iter;
    int64_t *futhark_mc_copy_parloop_42178_total_runtime;
    int *futhark_mc_copy_parloop_42178_runs;
    int64_t *futhark_mc_copy_parloop_42178_iter;
    int64_t futhark_mc_copy_parloop_42178_total_total_runtime;
    int futhark_mc_copy_parloop_42178_total_runs;
    int64_t futhark_mc_copy_parloop_42178_total_iter;
    int64_t *futhark_mc_copy_41836_task_42176_total_runtime;
    int *futhark_mc_copy_41836_task_42176_runs;
    int64_t *futhark_mc_copy_41836_task_42176_iter;
    int64_t futhark_mc_copy_41836_task_42176_total_time;
    int64_t futhark_mc_copy_41836_task_42176_total_iter;
    int64_t *futhark_mc_segmap_parloop_42109_total_runtime;
    int *futhark_mc_segmap_parloop_42109_runs;
    int64_t *futhark_mc_segmap_parloop_42109_iter;
    int64_t futhark_mc_segmap_parloop_42109_total_total_runtime;
    int futhark_mc_segmap_parloop_42109_total_runs;
    int64_t futhark_mc_segmap_parloop_42109_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42107_total_runtime;
    int *futhark_mc_segmap_nested_task_42107_runs;
    int64_t *futhark_mc_segmap_nested_task_42107_iter;
    int64_t *futhark_mc_copy_parloop_42182_total_runtime;
    int *futhark_mc_copy_parloop_42182_runs;
    int64_t *futhark_mc_copy_parloop_42182_iter;
    int64_t futhark_mc_copy_parloop_42182_total_total_runtime;
    int futhark_mc_copy_parloop_42182_total_runs;
    int64_t futhark_mc_copy_parloop_42182_total_iter;
    int64_t *futhark_mc_copy_41861_task_42180_total_runtime;
    int *futhark_mc_copy_41861_task_42180_runs;
    int64_t *futhark_mc_copy_41861_task_42180_iter;
    int64_t futhark_mc_copy_41861_task_42180_total_time;
    int64_t futhark_mc_copy_41861_task_42180_total_iter;
    int64_t *futhark_mc_segmap_parloop_42100_total_runtime;
    int *futhark_mc_segmap_parloop_42100_runs;
    int64_t *futhark_mc_segmap_parloop_42100_iter;
    int64_t futhark_mc_segmap_parloop_42100_total_total_runtime;
    int futhark_mc_segmap_parloop_42100_total_runs;
    int64_t futhark_mc_segmap_parloop_42100_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42098_total_runtime;
    int *futhark_mc_segmap_nested_task_42098_runs;
    int64_t *futhark_mc_segmap_nested_task_42098_iter;
    int64_t *futhark_mc_copy_parloop_42186_total_runtime;
    int *futhark_mc_copy_parloop_42186_runs;
    int64_t *futhark_mc_copy_parloop_42186_iter;
    int64_t futhark_mc_copy_parloop_42186_total_total_runtime;
    int futhark_mc_copy_parloop_42186_total_runs;
    int64_t futhark_mc_copy_parloop_42186_total_iter;
    int64_t *futhark_mc_copy_41889_task_42184_total_runtime;
    int *futhark_mc_copy_41889_task_42184_runs;
    int64_t *futhark_mc_copy_41889_task_42184_iter;
    int64_t futhark_mc_copy_41889_task_42184_total_time;
    int64_t futhark_mc_copy_41889_task_42184_total_iter;
    int64_t *futhark_mc_segmap_parloop_42091_total_runtime;
    int *futhark_mc_segmap_parloop_42091_runs;
    int64_t *futhark_mc_segmap_parloop_42091_iter;
    int64_t futhark_mc_segmap_parloop_42091_total_total_runtime;
    int futhark_mc_segmap_parloop_42091_total_runs;
    int64_t futhark_mc_segmap_parloop_42091_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42089_total_runtime;
    int *futhark_mc_segmap_nested_task_42089_runs;
    int64_t *futhark_mc_segmap_nested_task_42089_iter;
    int64_t *futhark_mc_copy_parloop_42190_total_runtime;
    int *futhark_mc_copy_parloop_42190_runs;
    int64_t *futhark_mc_copy_parloop_42190_iter;
    int64_t futhark_mc_copy_parloop_42190_total_total_runtime;
    int futhark_mc_copy_parloop_42190_total_runs;
    int64_t futhark_mc_copy_parloop_42190_total_iter;
    int64_t *futhark_mc_copy_41920_task_42188_total_runtime;
    int *futhark_mc_copy_41920_task_42188_runs;
    int64_t *futhark_mc_copy_41920_task_42188_iter;
    int64_t futhark_mc_copy_41920_task_42188_total_time;
    int64_t futhark_mc_copy_41920_task_42188_total_iter;
    int64_t *futhark_mc_segmap_parloop_42082_total_runtime;
    int *futhark_mc_segmap_parloop_42082_runs;
    int64_t *futhark_mc_segmap_parloop_42082_iter;
    int64_t futhark_mc_segmap_parloop_42082_total_total_runtime;
    int futhark_mc_segmap_parloop_42082_total_runs;
    int64_t futhark_mc_segmap_parloop_42082_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42080_total_runtime;
    int *futhark_mc_segmap_nested_task_42080_runs;
    int64_t *futhark_mc_segmap_nested_task_42080_iter;
    int64_t *futhark_mc_copy_parloop_42194_total_runtime;
    int *futhark_mc_copy_parloop_42194_runs;
    int64_t *futhark_mc_copy_parloop_42194_iter;
    int64_t futhark_mc_copy_parloop_42194_total_total_runtime;
    int futhark_mc_copy_parloop_42194_total_runs;
    int64_t futhark_mc_copy_parloop_42194_total_iter;
    int64_t *futhark_mc_copy_41954_task_42192_total_runtime;
    int *futhark_mc_copy_41954_task_42192_runs;
    int64_t *futhark_mc_copy_41954_task_42192_iter;
    int64_t futhark_mc_copy_41954_task_42192_total_time;
    int64_t futhark_mc_copy_41954_task_42192_total_iter;
    int64_t *futhark_mc_segmap_parloop_42073_total_runtime;
    int *futhark_mc_segmap_parloop_42073_runs;
    int64_t *futhark_mc_segmap_parloop_42073_iter;
    int64_t futhark_mc_segmap_parloop_42073_total_total_runtime;
    int futhark_mc_segmap_parloop_42073_total_runs;
    int64_t futhark_mc_segmap_parloop_42073_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42071_total_runtime;
    int *futhark_mc_segmap_nested_task_42071_runs;
    int64_t *futhark_mc_segmap_nested_task_42071_iter;
    int64_t *futhark_mc_copy_parloop_42198_total_runtime;
    int *futhark_mc_copy_parloop_42198_runs;
    int64_t *futhark_mc_copy_parloop_42198_iter;
    int64_t futhark_mc_copy_parloop_42198_total_total_runtime;
    int futhark_mc_copy_parloop_42198_total_runs;
    int64_t futhark_mc_copy_parloop_42198_total_iter;
    int64_t *futhark_mc_copy_41991_task_42196_total_runtime;
    int *futhark_mc_copy_41991_task_42196_runs;
    int64_t *futhark_mc_copy_41991_task_42196_iter;
    int64_t futhark_mc_copy_41991_task_42196_total_time;
    int64_t futhark_mc_copy_41991_task_42196_total_iter;
    int64_t *futhark_mc_segmap_parloop_42064_total_runtime;
    int *futhark_mc_segmap_parloop_42064_runs;
    int64_t *futhark_mc_segmap_parloop_42064_iter;
    int64_t futhark_mc_segmap_parloop_42064_total_total_runtime;
    int futhark_mc_segmap_parloop_42064_total_runs;
    int64_t futhark_mc_segmap_parloop_42064_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42062_total_runtime;
    int *futhark_mc_segmap_nested_task_42062_runs;
    int64_t *futhark_mc_segmap_nested_task_42062_iter;
    int64_t *futhark_mc_copy_parloop_42202_total_runtime;
    int *futhark_mc_copy_parloop_42202_runs;
    int64_t *futhark_mc_copy_parloop_42202_iter;
    int64_t futhark_mc_copy_parloop_42202_total_total_runtime;
    int futhark_mc_copy_parloop_42202_total_runs;
    int64_t futhark_mc_copy_parloop_42202_total_iter;
    int64_t *futhark_mc_copy_42031_task_42200_total_runtime;
    int *futhark_mc_copy_42031_task_42200_runs;
    int64_t *futhark_mc_copy_42031_task_42200_iter;
    int64_t futhark_mc_copy_42031_task_42200_total_time;
    int64_t futhark_mc_copy_42031_task_42200_total_iter;
    int64_t *futhark_mc_segmap_parloop_42055_total_runtime;
    int *futhark_mc_segmap_parloop_42055_runs;
    int64_t *futhark_mc_segmap_parloop_42055_iter;
    int64_t futhark_mc_segmap_parloop_42055_total_total_runtime;
    int futhark_mc_segmap_parloop_42055_total_runs;
    int64_t futhark_mc_segmap_parloop_42055_total_iter;
    int64_t *futhark_mc_segmap_nested_task_42053_total_runtime;
    int *futhark_mc_segmap_nested_task_42053_runs;
    int64_t *futhark_mc_segmap_nested_task_42053_iter;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
    ctx->program->futhark_mc_copy_parloop_42037_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42037_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42037_total_iter = 0;
    ctx->program->futhark_mc_copy_34864_task_42035_total_time = 0;
    ctx->program->futhark_mc_copy_34864_task_42035_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42042_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42042_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42042_total_iter = 0;
    ctx->program->futhark_mc_copy_34875_task_42040_total_time = 0;
    ctx->program->futhark_mc_copy_34875_task_42040_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42047_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42047_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42047_total_iter = 0;
    ctx->program->futhark_mc_copy_34886_task_42045_total_time = 0;
    ctx->program->futhark_mc_copy_34886_task_42045_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42051_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42051_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42051_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42049_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42049_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42060_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42060_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42060_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42058_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42058_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42069_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42069_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42069_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42067_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42067_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42078_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42078_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42078_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42076_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42076_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42087_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42087_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42087_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42085_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42085_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42096_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42096_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42096_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42094_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42094_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42105_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42105_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42105_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42103_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42103_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42114_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42114_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42114_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42112_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42112_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42123_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42123_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42123_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42121_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42121_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42132_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42132_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42132_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42130_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42130_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42141_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42141_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42141_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42139_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42139_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42150_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42150_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42150_total_iter = 0;
    ctx->program->futhark_mc_segmap_task_42148_total_time = 0;
    ctx->program->futhark_mc_segmap_task_42148_total_iter = 0;
    ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_total_runtime = 0;
    ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs = 0;
    ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_iter = 0;
    ctx->program->futhark_mc_segred_task_42155_total_time = 0;
    ctx->program->futhark_mc_segred_task_42155_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42153_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42153_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42153_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42162_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42162_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42162_total_iter = 0;
    ctx->program->futhark_mc_copy_41766_task_42160_total_time = 0;
    ctx->program->futhark_mc_copy_41766_task_42160_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42145_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42145_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42145_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42166_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42166_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42166_total_iter = 0;
    ctx->program->futhark_mc_copy_41779_task_42164_total_time = 0;
    ctx->program->futhark_mc_copy_41779_task_42164_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42136_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42136_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42136_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42170_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42170_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42170_total_iter = 0;
    ctx->program->futhark_mc_copy_41795_task_42168_total_time = 0;
    ctx->program->futhark_mc_copy_41795_task_42168_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42127_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42127_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42127_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42174_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42174_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42174_total_iter = 0;
    ctx->program->futhark_mc_copy_41814_task_42172_total_time = 0;
    ctx->program->futhark_mc_copy_41814_task_42172_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42118_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42118_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42118_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42178_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42178_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42178_total_iter = 0;
    ctx->program->futhark_mc_copy_41836_task_42176_total_time = 0;
    ctx->program->futhark_mc_copy_41836_task_42176_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42109_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42109_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42109_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42182_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42182_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42182_total_iter = 0;
    ctx->program->futhark_mc_copy_41861_task_42180_total_time = 0;
    ctx->program->futhark_mc_copy_41861_task_42180_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42100_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42100_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42100_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42186_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42186_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42186_total_iter = 0;
    ctx->program->futhark_mc_copy_41889_task_42184_total_time = 0;
    ctx->program->futhark_mc_copy_41889_task_42184_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42091_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42091_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42091_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42190_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42190_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42190_total_iter = 0;
    ctx->program->futhark_mc_copy_41920_task_42188_total_time = 0;
    ctx->program->futhark_mc_copy_41920_task_42188_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42082_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42082_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42082_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42194_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42194_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42194_total_iter = 0;
    ctx->program->futhark_mc_copy_41954_task_42192_total_time = 0;
    ctx->program->futhark_mc_copy_41954_task_42192_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42073_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42073_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42073_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42198_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42198_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42198_total_iter = 0;
    ctx->program->futhark_mc_copy_41991_task_42196_total_time = 0;
    ctx->program->futhark_mc_copy_41991_task_42196_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42064_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42064_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42064_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42202_total_total_runtime = 0;
    ctx->program->futhark_mc_copy_parloop_42202_total_runs = 0;
    ctx->program->futhark_mc_copy_parloop_42202_total_iter = 0;
    ctx->program->futhark_mc_copy_42031_task_42200_total_time = 0;
    ctx->program->futhark_mc_copy_42031_task_42200_total_iter = 0;
    ctx->program->futhark_mc_segmap_parloop_42055_total_total_runtime = 0;
    ctx->program->futhark_mc_segmap_parloop_42055_total_runs = 0;
    ctx->program->futhark_mc_segmap_parloop_42055_total_iter = 0;
    ctx->program->futhark_mc_copy_parloop_42037_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42037_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42037_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34864_task_42035_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34864_task_42035_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34864_task_42035_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42042_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42042_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42042_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34875_task_42040_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34875_task_42040_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34875_task_42040_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42047_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42047_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42047_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34886_task_42045_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34886_task_42045_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_34886_task_42045_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42051_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42051_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42051_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42049_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42049_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42049_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42060_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42060_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42060_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42058_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42058_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42058_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42069_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42069_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42069_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42067_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42067_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42067_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42078_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42078_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42078_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42076_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42076_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42076_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42087_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42087_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42087_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42085_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42085_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42085_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42096_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42096_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42096_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42094_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42094_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42094_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42105_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42105_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42105_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42103_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42103_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42103_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42114_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42114_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42114_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42112_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42112_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42112_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42123_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42123_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42123_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42121_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42121_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42121_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42132_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42132_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42132_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42130_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42130_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42130_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42141_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42141_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42141_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42139_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42139_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42139_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42150_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42150_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42150_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42148_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42148_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_task_42148_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segred_task_42155_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segred_task_42155_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segred_task_42155_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42153_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42153_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42153_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42151_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42151_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42151_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42162_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42162_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42162_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41766_task_42160_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41766_task_42160_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41766_task_42160_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42145_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42145_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42145_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42143_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42143_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42143_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42166_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42166_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42166_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41779_task_42164_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41779_task_42164_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41779_task_42164_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42136_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42136_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42136_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42134_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42134_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42134_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42170_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42170_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42170_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41795_task_42168_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41795_task_42168_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41795_task_42168_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42127_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42127_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42127_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42125_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42125_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42125_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42174_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42174_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42174_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41814_task_42172_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41814_task_42172_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41814_task_42172_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42118_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42118_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42118_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42116_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42116_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42116_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42178_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42178_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42178_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41836_task_42176_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41836_task_42176_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41836_task_42176_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42109_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42109_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42109_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42107_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42107_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42107_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42182_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42182_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42182_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41861_task_42180_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41861_task_42180_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41861_task_42180_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42100_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42100_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42100_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42098_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42098_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42098_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42186_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42186_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42186_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41889_task_42184_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41889_task_42184_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41889_task_42184_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42091_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42091_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42091_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42089_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42089_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42089_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42190_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42190_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42190_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41920_task_42188_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41920_task_42188_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41920_task_42188_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42082_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42082_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42082_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42080_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42080_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42080_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42194_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42194_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42194_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41954_task_42192_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41954_task_42192_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41954_task_42192_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42073_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42073_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42073_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42071_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42071_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42071_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42198_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42198_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42198_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41991_task_42196_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41991_task_42196_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_41991_task_42196_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42064_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42064_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42064_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42062_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42062_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42062_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42202_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42202_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_parloop_42202_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_42031_task_42200_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_42031_task_42200_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_copy_42031_task_42200_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42055_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42055_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_parloop_42055_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42053_total_runtime = calloc(sizeof(int64_t), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42053_runs = calloc(sizeof(int), ctx->scheduler.num_threads);
    ctx->program->futhark_mc_segmap_nested_task_42053_iter = calloc(sizeof(sizeof(int64_t)), ctx->scheduler.num_threads);
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    free(ctx->program->futhark_mc_copy_parloop_42037_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42037_runs);
    free(ctx->program->futhark_mc_copy_parloop_42037_iter);
    free(ctx->program->futhark_mc_copy_34864_task_42035_total_runtime);
    free(ctx->program->futhark_mc_copy_34864_task_42035_runs);
    free(ctx->program->futhark_mc_copy_34864_task_42035_iter);
    free(ctx->program->futhark_mc_copy_parloop_42042_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42042_runs);
    free(ctx->program->futhark_mc_copy_parloop_42042_iter);
    free(ctx->program->futhark_mc_copy_34875_task_42040_total_runtime);
    free(ctx->program->futhark_mc_copy_34875_task_42040_runs);
    free(ctx->program->futhark_mc_copy_34875_task_42040_iter);
    free(ctx->program->futhark_mc_copy_parloop_42047_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42047_runs);
    free(ctx->program->futhark_mc_copy_parloop_42047_iter);
    free(ctx->program->futhark_mc_copy_34886_task_42045_total_runtime);
    free(ctx->program->futhark_mc_copy_34886_task_42045_runs);
    free(ctx->program->futhark_mc_copy_34886_task_42045_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42051_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42051_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42051_iter);
    free(ctx->program->futhark_mc_segmap_task_42049_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42049_runs);
    free(ctx->program->futhark_mc_segmap_task_42049_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42060_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42060_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42060_iter);
    free(ctx->program->futhark_mc_segmap_task_42058_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42058_runs);
    free(ctx->program->futhark_mc_segmap_task_42058_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42069_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42069_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42069_iter);
    free(ctx->program->futhark_mc_segmap_task_42067_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42067_runs);
    free(ctx->program->futhark_mc_segmap_task_42067_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42078_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42078_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42078_iter);
    free(ctx->program->futhark_mc_segmap_task_42076_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42076_runs);
    free(ctx->program->futhark_mc_segmap_task_42076_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42087_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42087_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42087_iter);
    free(ctx->program->futhark_mc_segmap_task_42085_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42085_runs);
    free(ctx->program->futhark_mc_segmap_task_42085_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42096_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42096_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42096_iter);
    free(ctx->program->futhark_mc_segmap_task_42094_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42094_runs);
    free(ctx->program->futhark_mc_segmap_task_42094_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42105_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42105_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42105_iter);
    free(ctx->program->futhark_mc_segmap_task_42103_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42103_runs);
    free(ctx->program->futhark_mc_segmap_task_42103_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42114_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42114_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42114_iter);
    free(ctx->program->futhark_mc_segmap_task_42112_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42112_runs);
    free(ctx->program->futhark_mc_segmap_task_42112_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42123_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42123_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42123_iter);
    free(ctx->program->futhark_mc_segmap_task_42121_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42121_runs);
    free(ctx->program->futhark_mc_segmap_task_42121_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42132_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42132_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42132_iter);
    free(ctx->program->futhark_mc_segmap_task_42130_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42130_runs);
    free(ctx->program->futhark_mc_segmap_task_42130_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42141_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42141_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42141_iter);
    free(ctx->program->futhark_mc_segmap_task_42139_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42139_runs);
    free(ctx->program->futhark_mc_segmap_task_42139_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42150_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42150_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42150_iter);
    free(ctx->program->futhark_mc_segmap_task_42148_total_runtime);
    free(ctx->program->futhark_mc_segmap_task_42148_runs);
    free(ctx->program->futhark_mc_segmap_task_42148_iter);
    free(ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runtime);
    free(ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs);
    free(ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter);
    free(ctx->program->futhark_mc_segred_task_42155_total_runtime);
    free(ctx->program->futhark_mc_segred_task_42155_runs);
    free(ctx->program->futhark_mc_segred_task_42155_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42153_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42153_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42153_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42151_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42151_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42151_iter);
    free(ctx->program->futhark_mc_copy_parloop_42162_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42162_runs);
    free(ctx->program->futhark_mc_copy_parloop_42162_iter);
    free(ctx->program->futhark_mc_copy_41766_task_42160_total_runtime);
    free(ctx->program->futhark_mc_copy_41766_task_42160_runs);
    free(ctx->program->futhark_mc_copy_41766_task_42160_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42145_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42145_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42145_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42143_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42143_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42143_iter);
    free(ctx->program->futhark_mc_copy_parloop_42166_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42166_runs);
    free(ctx->program->futhark_mc_copy_parloop_42166_iter);
    free(ctx->program->futhark_mc_copy_41779_task_42164_total_runtime);
    free(ctx->program->futhark_mc_copy_41779_task_42164_runs);
    free(ctx->program->futhark_mc_copy_41779_task_42164_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42136_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42136_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42136_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42134_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42134_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42134_iter);
    free(ctx->program->futhark_mc_copy_parloop_42170_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42170_runs);
    free(ctx->program->futhark_mc_copy_parloop_42170_iter);
    free(ctx->program->futhark_mc_copy_41795_task_42168_total_runtime);
    free(ctx->program->futhark_mc_copy_41795_task_42168_runs);
    free(ctx->program->futhark_mc_copy_41795_task_42168_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42127_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42127_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42127_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42125_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42125_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42125_iter);
    free(ctx->program->futhark_mc_copy_parloop_42174_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42174_runs);
    free(ctx->program->futhark_mc_copy_parloop_42174_iter);
    free(ctx->program->futhark_mc_copy_41814_task_42172_total_runtime);
    free(ctx->program->futhark_mc_copy_41814_task_42172_runs);
    free(ctx->program->futhark_mc_copy_41814_task_42172_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42118_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42118_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42118_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42116_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42116_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42116_iter);
    free(ctx->program->futhark_mc_copy_parloop_42178_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42178_runs);
    free(ctx->program->futhark_mc_copy_parloop_42178_iter);
    free(ctx->program->futhark_mc_copy_41836_task_42176_total_runtime);
    free(ctx->program->futhark_mc_copy_41836_task_42176_runs);
    free(ctx->program->futhark_mc_copy_41836_task_42176_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42109_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42109_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42109_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42107_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42107_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42107_iter);
    free(ctx->program->futhark_mc_copy_parloop_42182_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42182_runs);
    free(ctx->program->futhark_mc_copy_parloop_42182_iter);
    free(ctx->program->futhark_mc_copy_41861_task_42180_total_runtime);
    free(ctx->program->futhark_mc_copy_41861_task_42180_runs);
    free(ctx->program->futhark_mc_copy_41861_task_42180_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42100_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42100_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42100_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42098_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42098_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42098_iter);
    free(ctx->program->futhark_mc_copy_parloop_42186_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42186_runs);
    free(ctx->program->futhark_mc_copy_parloop_42186_iter);
    free(ctx->program->futhark_mc_copy_41889_task_42184_total_runtime);
    free(ctx->program->futhark_mc_copy_41889_task_42184_runs);
    free(ctx->program->futhark_mc_copy_41889_task_42184_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42091_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42091_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42091_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42089_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42089_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42089_iter);
    free(ctx->program->futhark_mc_copy_parloop_42190_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42190_runs);
    free(ctx->program->futhark_mc_copy_parloop_42190_iter);
    free(ctx->program->futhark_mc_copy_41920_task_42188_total_runtime);
    free(ctx->program->futhark_mc_copy_41920_task_42188_runs);
    free(ctx->program->futhark_mc_copy_41920_task_42188_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42082_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42082_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42082_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42080_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42080_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42080_iter);
    free(ctx->program->futhark_mc_copy_parloop_42194_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42194_runs);
    free(ctx->program->futhark_mc_copy_parloop_42194_iter);
    free(ctx->program->futhark_mc_copy_41954_task_42192_total_runtime);
    free(ctx->program->futhark_mc_copy_41954_task_42192_runs);
    free(ctx->program->futhark_mc_copy_41954_task_42192_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42073_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42073_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42073_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42071_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42071_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42071_iter);
    free(ctx->program->futhark_mc_copy_parloop_42198_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42198_runs);
    free(ctx->program->futhark_mc_copy_parloop_42198_iter);
    free(ctx->program->futhark_mc_copy_41991_task_42196_total_runtime);
    free(ctx->program->futhark_mc_copy_41991_task_42196_runs);
    free(ctx->program->futhark_mc_copy_41991_task_42196_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42064_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42064_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42064_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42062_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42062_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42062_iter);
    free(ctx->program->futhark_mc_copy_parloop_42202_total_runtime);
    free(ctx->program->futhark_mc_copy_parloop_42202_runs);
    free(ctx->program->futhark_mc_copy_parloop_42202_iter);
    free(ctx->program->futhark_mc_copy_42031_task_42200_total_runtime);
    free(ctx->program->futhark_mc_copy_42031_task_42200_runs);
    free(ctx->program->futhark_mc_copy_42031_task_42200_iter);
    free(ctx->program->futhark_mc_segmap_parloop_42055_total_runtime);
    free(ctx->program->futhark_mc_segmap_parloop_42055_runs);
    free(ctx->program->futhark_mc_segmap_parloop_42055_iter);
    free(ctx->program->futhark_mc_segmap_nested_task_42053_total_runtime);
    free(ctx->program->futhark_mc_segmap_nested_task_42053_runs);
    free(ctx->program->futhark_mc_segmap_nested_task_42053_iter);
    free(ctx->program);
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default + size);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(ctx->log, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(ctx->log, ".\n");
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        ctx->cur_mem_usage_default += size;
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag)
{
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag)
{
    cfg->profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag)
{
    cfg->logging = flag;
}
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f)
{
    cfg->cache_fname = f;
}
int futhark_get_tuning_param_count(void)
{
    return num_tuning_params;
}
const char *futhark_get_tuning_param_name(int i)
{
    return tuning_param_names[i];
}
const char *futhark_get_tuning_param_class(int i)
{
    return tuning_param_classes[i];
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    { }
    if (ctx->profiling) {
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42037            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42037_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42037_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42037_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42037_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42037_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42037_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42037_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42037_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42037_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42037_iter[i] / (ctx->program->futhark_mc_copy_parloop_42037_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42037_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42037_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42037_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42037_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42037_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42037_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42037_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42037_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42037_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42037_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42037_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42037_total_iter / (ctx->program->futhark_mc_copy_parloop_42037_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42037_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42037_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42037_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_34864_task_42035         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_34864_task_42035_runs[i], (long) ctx->program->futhark_mc_copy_34864_task_42035_total_runtime[i] / (ctx->program->futhark_mc_copy_34864_task_42035_runs[i] != 0 ? ctx->program->futhark_mc_copy_34864_task_42035_runs[i] : 1), (long) ctx->program->futhark_mc_copy_34864_task_42035_total_runtime[i], (double) ctx->program->futhark_mc_copy_34864_task_42035_total_runtime[i] / (ctx->program->futhark_mc_copy_34864_task_42035_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_34864_task_42035_iter[i]), (long) ctx->program->futhark_mc_copy_34864_task_42035_iter[i], (long) ctx->program->futhark_mc_copy_34864_task_42035_iter[i] / (ctx->program->futhark_mc_copy_34864_task_42035_runs[i] != 0 ? ctx->program->futhark_mc_copy_34864_task_42035_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42042            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42042_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42042_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42042_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42042_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42042_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42042_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42042_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42042_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42042_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42042_iter[i] / (ctx->program->futhark_mc_copy_parloop_42042_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42042_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42042_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42042_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42042_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42042_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42042_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42042_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42042_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42042_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42042_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42042_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42042_total_iter / (ctx->program->futhark_mc_copy_parloop_42042_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42042_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42042_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42042_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_34875_task_42040         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_34875_task_42040_runs[i], (long) ctx->program->futhark_mc_copy_34875_task_42040_total_runtime[i] / (ctx->program->futhark_mc_copy_34875_task_42040_runs[i] != 0 ? ctx->program->futhark_mc_copy_34875_task_42040_runs[i] : 1), (long) ctx->program->futhark_mc_copy_34875_task_42040_total_runtime[i], (double) ctx->program->futhark_mc_copy_34875_task_42040_total_runtime[i] / (ctx->program->futhark_mc_copy_34875_task_42040_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_34875_task_42040_iter[i]), (long) ctx->program->futhark_mc_copy_34875_task_42040_iter[i], (long) ctx->program->futhark_mc_copy_34875_task_42040_iter[i] / (ctx->program->futhark_mc_copy_34875_task_42040_runs[i] != 0 ? ctx->program->futhark_mc_copy_34875_task_42040_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42047            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42047_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42047_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42047_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42047_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42047_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42047_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42047_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42047_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42047_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42047_iter[i] / (ctx->program->futhark_mc_copy_parloop_42047_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42047_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42047_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42047_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42047_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42047_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42047_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42047_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42047_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42047_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42047_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42047_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42047_total_iter / (ctx->program->futhark_mc_copy_parloop_42047_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42047_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42047_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42047_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_34886_task_42045         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_34886_task_42045_runs[i], (long) ctx->program->futhark_mc_copy_34886_task_42045_total_runtime[i] / (ctx->program->futhark_mc_copy_34886_task_42045_runs[i] != 0 ? ctx->program->futhark_mc_copy_34886_task_42045_runs[i] : 1), (long) ctx->program->futhark_mc_copy_34886_task_42045_total_runtime[i], (double) ctx->program->futhark_mc_copy_34886_task_42045_total_runtime[i] / (ctx->program->futhark_mc_copy_34886_task_42045_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_34886_task_42045_iter[i]), (long) ctx->program->futhark_mc_copy_34886_task_42045_iter[i], (long) ctx->program->futhark_mc_copy_34886_task_42045_iter[i] / (ctx->program->futhark_mc_copy_34886_task_42045_runs[i] != 0 ? ctx->program->futhark_mc_copy_34886_task_42045_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42051          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42051_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42051_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42051_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42051_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42051_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42051_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42051_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42051_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42051_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42051_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42051_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42051_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42051_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42051_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42051_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42051_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42051_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42051_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42051_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42051_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42051_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42051_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42051_total_iter / (ctx->program->futhark_mc_segmap_parloop_42051_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42051_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42051_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42051_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42060          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42060_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42060_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42060_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42060_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42060_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42060_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42060_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42060_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42060_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42060_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42060_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42060_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42060_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42060_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42060_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42060_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42060_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42060_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42060_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42060_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42060_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42060_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42060_total_iter / (ctx->program->futhark_mc_segmap_parloop_42060_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42060_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42060_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42060_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42069          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42069_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42069_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42069_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42069_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42069_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42069_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42069_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42069_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42069_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42069_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42069_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42069_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42069_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42069_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42069_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42069_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42069_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42069_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42069_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42069_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42069_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42069_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42069_total_iter / (ctx->program->futhark_mc_segmap_parloop_42069_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42069_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42069_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42069_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42078          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42078_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42078_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42078_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42078_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42078_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42078_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42078_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42078_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42078_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42078_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42078_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42078_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42078_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42078_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42078_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42078_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42078_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42078_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42078_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42078_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42078_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42078_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42078_total_iter / (ctx->program->futhark_mc_segmap_parloop_42078_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42078_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42078_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42078_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42087          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42087_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42087_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42087_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42087_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42087_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42087_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42087_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42087_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42087_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42087_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42087_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42087_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42087_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42087_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42087_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42087_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42087_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42087_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42087_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42087_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42087_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42087_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42087_total_iter / (ctx->program->futhark_mc_segmap_parloop_42087_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42087_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42087_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42087_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42096          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42096_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42096_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42096_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42096_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42096_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42096_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42096_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42096_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42096_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42096_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42096_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42096_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42096_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42096_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42096_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42096_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42096_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42096_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42096_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42096_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42096_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42096_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42096_total_iter / (ctx->program->futhark_mc_segmap_parloop_42096_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42096_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42096_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42096_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42105          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42105_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42105_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42105_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42105_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42105_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42105_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42105_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42105_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42105_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42105_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42105_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42105_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42105_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42105_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42105_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42105_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42105_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42105_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42105_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42105_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42105_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42105_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42105_total_iter / (ctx->program->futhark_mc_segmap_parloop_42105_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42105_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42105_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42105_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42114          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42114_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42114_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42114_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42114_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42114_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42114_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42114_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42114_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42114_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42114_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42114_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42114_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42114_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42114_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42114_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42114_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42114_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42114_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42114_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42114_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42114_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42114_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42114_total_iter / (ctx->program->futhark_mc_segmap_parloop_42114_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42114_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42114_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42114_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42123          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42123_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42123_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42123_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42123_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42123_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42123_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42123_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42123_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42123_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42123_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42123_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42123_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42123_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42123_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42123_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42123_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42123_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42123_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42123_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42123_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42123_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42123_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42123_total_iter / (ctx->program->futhark_mc_segmap_parloop_42123_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42123_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42123_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42123_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42132          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42132_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42132_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42132_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42132_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42132_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42132_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42132_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42132_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42132_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42132_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42132_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42132_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42132_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42132_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42132_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42132_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42132_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42132_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42132_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42132_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42132_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42132_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42132_total_iter / (ctx->program->futhark_mc_segmap_parloop_42132_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42132_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42132_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42132_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42141          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42141_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42141_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42141_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42141_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42141_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42141_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42141_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42141_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42141_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42141_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42141_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42141_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42141_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42141_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42141_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42141_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42141_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42141_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42141_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42141_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42141_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42141_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42141_total_iter / (ctx->program->futhark_mc_segmap_parloop_42141_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42141_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42141_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42141_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42150          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42150_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42150_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42150_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42150_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42150_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42150_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42150_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42150_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42150_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42150_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42150_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42150_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42150_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42150_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42150_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42150_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42150_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42150_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42150_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42150_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42150_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42150_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42150_total_iter / (ctx->program->futhark_mc_segmap_parloop_42150_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42150_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42150_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42150_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segred_stage_1_parloop_42158  ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs[i], (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runtime[i] / (ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs[i] != 0 ? ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs[i] : 1), (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runtime[i], (double) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runtime[i] / (ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter[i]), (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter[i], (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter[i] / (ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs[i] != 0 ? ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segred_stage_1_parloop_42158_total ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs, (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_total_runtime / (ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs != 0 ? ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs : 1), (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_total_runtime, (double) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_total_runtime / (ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_iter), (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_iter, (long) ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_iter / (ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs != 0 ? ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segred_task_42155             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segred_task_42155_runs[i], (long) ctx->program->futhark_mc_segred_task_42155_total_runtime[i] / (ctx->program->futhark_mc_segred_task_42155_runs[i] != 0 ? ctx->program->futhark_mc_segred_task_42155_runs[i] : 1), (long) ctx->program->futhark_mc_segred_task_42155_total_runtime[i], (double) ctx->program->futhark_mc_segred_task_42155_total_runtime[i] / (ctx->program->futhark_mc_segred_task_42155_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segred_task_42155_iter[i]), (long) ctx->program->futhark_mc_segred_task_42155_iter[i], (long) ctx->program->futhark_mc_segred_task_42155_iter[i] / (ctx->program->futhark_mc_segred_task_42155_runs[i] != 0 ? ctx->program->futhark_mc_segred_task_42155_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42153          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42153_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42153_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42153_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42153_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42153_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42153_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42153_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42153_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42153_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42153_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42153_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42153_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42153_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42153_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42153_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42153_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42153_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42153_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42153_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42153_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42153_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42153_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42153_total_iter / (ctx->program->futhark_mc_segmap_parloop_42153_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42153_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42153_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42153_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42148             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42148_runs[i], (long) ctx->program->futhark_mc_segmap_task_42148_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42148_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42148_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42148_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42148_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42148_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42148_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42148_iter[i], (long) ctx->program->futhark_mc_segmap_task_42148_iter[i] / (ctx->program->futhark_mc_segmap_task_42148_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42148_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42151      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42151_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42151_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42151_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42151_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42151_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42151_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42151_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42151_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42151_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42151_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42151_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42151_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42162            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42162_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42162_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42162_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42162_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42162_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42162_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42162_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42162_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42162_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42162_iter[i] / (ctx->program->futhark_mc_copy_parloop_42162_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42162_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42162_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42162_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42162_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42162_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42162_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42162_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42162_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42162_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42162_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42162_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42162_total_iter / (ctx->program->futhark_mc_copy_parloop_42162_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42162_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42162_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42162_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41766_task_42160         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41766_task_42160_runs[i], (long) ctx->program->futhark_mc_copy_41766_task_42160_total_runtime[i] / (ctx->program->futhark_mc_copy_41766_task_42160_runs[i] != 0 ? ctx->program->futhark_mc_copy_41766_task_42160_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41766_task_42160_total_runtime[i], (double) ctx->program->futhark_mc_copy_41766_task_42160_total_runtime[i] / (ctx->program->futhark_mc_copy_41766_task_42160_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41766_task_42160_iter[i]), (long) ctx->program->futhark_mc_copy_41766_task_42160_iter[i], (long) ctx->program->futhark_mc_copy_41766_task_42160_iter[i] / (ctx->program->futhark_mc_copy_41766_task_42160_runs[i] != 0 ? ctx->program->futhark_mc_copy_41766_task_42160_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42145          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42145_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42145_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42145_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42145_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42145_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42145_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42145_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42145_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42145_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42145_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42145_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42145_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42145_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42145_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42145_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42145_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42145_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42145_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42145_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42145_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42145_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42145_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42145_total_iter / (ctx->program->futhark_mc_segmap_parloop_42145_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42145_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42145_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42145_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42139             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42139_runs[i], (long) ctx->program->futhark_mc_segmap_task_42139_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42139_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42139_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42139_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42139_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42139_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42139_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42139_iter[i], (long) ctx->program->futhark_mc_segmap_task_42139_iter[i] / (ctx->program->futhark_mc_segmap_task_42139_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42139_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42143      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42143_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42143_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42143_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42143_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42143_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42143_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42143_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42143_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42143_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42143_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42143_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42143_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42166            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42166_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42166_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42166_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42166_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42166_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42166_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42166_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42166_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42166_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42166_iter[i] / (ctx->program->futhark_mc_copy_parloop_42166_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42166_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42166_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42166_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42166_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42166_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42166_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42166_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42166_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42166_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42166_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42166_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42166_total_iter / (ctx->program->futhark_mc_copy_parloop_42166_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42166_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42166_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42166_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41779_task_42164         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41779_task_42164_runs[i], (long) ctx->program->futhark_mc_copy_41779_task_42164_total_runtime[i] / (ctx->program->futhark_mc_copy_41779_task_42164_runs[i] != 0 ? ctx->program->futhark_mc_copy_41779_task_42164_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41779_task_42164_total_runtime[i], (double) ctx->program->futhark_mc_copy_41779_task_42164_total_runtime[i] / (ctx->program->futhark_mc_copy_41779_task_42164_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41779_task_42164_iter[i]), (long) ctx->program->futhark_mc_copy_41779_task_42164_iter[i], (long) ctx->program->futhark_mc_copy_41779_task_42164_iter[i] / (ctx->program->futhark_mc_copy_41779_task_42164_runs[i] != 0 ? ctx->program->futhark_mc_copy_41779_task_42164_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42136          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42136_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42136_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42136_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42136_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42136_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42136_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42136_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42136_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42136_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42136_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42136_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42136_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42136_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42136_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42136_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42136_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42136_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42136_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42136_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42136_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42136_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42136_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42136_total_iter / (ctx->program->futhark_mc_segmap_parloop_42136_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42136_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42136_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42136_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42130             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42130_runs[i], (long) ctx->program->futhark_mc_segmap_task_42130_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42130_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42130_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42130_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42130_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42130_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42130_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42130_iter[i], (long) ctx->program->futhark_mc_segmap_task_42130_iter[i] / (ctx->program->futhark_mc_segmap_task_42130_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42130_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42134      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42134_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42134_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42134_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42134_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42134_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42134_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42134_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42134_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42134_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42134_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42134_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42134_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42170            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42170_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42170_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42170_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42170_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42170_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42170_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42170_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42170_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42170_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42170_iter[i] / (ctx->program->futhark_mc_copy_parloop_42170_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42170_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42170_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42170_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42170_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42170_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42170_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42170_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42170_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42170_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42170_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42170_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42170_total_iter / (ctx->program->futhark_mc_copy_parloop_42170_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42170_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42170_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42170_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41795_task_42168         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41795_task_42168_runs[i], (long) ctx->program->futhark_mc_copy_41795_task_42168_total_runtime[i] / (ctx->program->futhark_mc_copy_41795_task_42168_runs[i] != 0 ? ctx->program->futhark_mc_copy_41795_task_42168_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41795_task_42168_total_runtime[i], (double) ctx->program->futhark_mc_copy_41795_task_42168_total_runtime[i] / (ctx->program->futhark_mc_copy_41795_task_42168_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41795_task_42168_iter[i]), (long) ctx->program->futhark_mc_copy_41795_task_42168_iter[i], (long) ctx->program->futhark_mc_copy_41795_task_42168_iter[i] / (ctx->program->futhark_mc_copy_41795_task_42168_runs[i] != 0 ? ctx->program->futhark_mc_copy_41795_task_42168_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42127          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42127_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42127_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42127_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42127_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42127_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42127_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42127_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42127_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42127_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42127_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42127_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42127_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42127_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42127_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42127_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42127_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42127_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42127_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42127_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42127_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42127_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42127_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42127_total_iter / (ctx->program->futhark_mc_segmap_parloop_42127_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42127_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42127_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42127_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42121             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42121_runs[i], (long) ctx->program->futhark_mc_segmap_task_42121_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42121_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42121_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42121_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42121_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42121_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42121_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42121_iter[i], (long) ctx->program->futhark_mc_segmap_task_42121_iter[i] / (ctx->program->futhark_mc_segmap_task_42121_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42121_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42125      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42125_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42125_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42125_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42125_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42125_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42125_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42125_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42125_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42125_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42125_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42125_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42125_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42174            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42174_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42174_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42174_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42174_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42174_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42174_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42174_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42174_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42174_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42174_iter[i] / (ctx->program->futhark_mc_copy_parloop_42174_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42174_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42174_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42174_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42174_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42174_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42174_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42174_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42174_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42174_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42174_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42174_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42174_total_iter / (ctx->program->futhark_mc_copy_parloop_42174_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42174_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42174_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42174_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41814_task_42172         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41814_task_42172_runs[i], (long) ctx->program->futhark_mc_copy_41814_task_42172_total_runtime[i] / (ctx->program->futhark_mc_copy_41814_task_42172_runs[i] != 0 ? ctx->program->futhark_mc_copy_41814_task_42172_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41814_task_42172_total_runtime[i], (double) ctx->program->futhark_mc_copy_41814_task_42172_total_runtime[i] / (ctx->program->futhark_mc_copy_41814_task_42172_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41814_task_42172_iter[i]), (long) ctx->program->futhark_mc_copy_41814_task_42172_iter[i], (long) ctx->program->futhark_mc_copy_41814_task_42172_iter[i] / (ctx->program->futhark_mc_copy_41814_task_42172_runs[i] != 0 ? ctx->program->futhark_mc_copy_41814_task_42172_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42118          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42118_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42118_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42118_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42118_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42118_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42118_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42118_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42118_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42118_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42118_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42118_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42118_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42118_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42118_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42118_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42118_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42118_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42118_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42118_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42118_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42118_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42118_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42118_total_iter / (ctx->program->futhark_mc_segmap_parloop_42118_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42118_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42118_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42118_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42112             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42112_runs[i], (long) ctx->program->futhark_mc_segmap_task_42112_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42112_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42112_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42112_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42112_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42112_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42112_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42112_iter[i], (long) ctx->program->futhark_mc_segmap_task_42112_iter[i] / (ctx->program->futhark_mc_segmap_task_42112_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42112_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42116      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42116_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42116_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42116_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42116_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42116_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42116_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42116_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42116_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42116_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42116_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42116_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42116_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42178            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42178_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42178_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42178_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42178_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42178_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42178_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42178_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42178_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42178_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42178_iter[i] / (ctx->program->futhark_mc_copy_parloop_42178_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42178_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42178_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42178_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42178_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42178_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42178_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42178_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42178_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42178_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42178_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42178_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42178_total_iter / (ctx->program->futhark_mc_copy_parloop_42178_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42178_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42178_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42178_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41836_task_42176         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41836_task_42176_runs[i], (long) ctx->program->futhark_mc_copy_41836_task_42176_total_runtime[i] / (ctx->program->futhark_mc_copy_41836_task_42176_runs[i] != 0 ? ctx->program->futhark_mc_copy_41836_task_42176_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41836_task_42176_total_runtime[i], (double) ctx->program->futhark_mc_copy_41836_task_42176_total_runtime[i] / (ctx->program->futhark_mc_copy_41836_task_42176_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41836_task_42176_iter[i]), (long) ctx->program->futhark_mc_copy_41836_task_42176_iter[i], (long) ctx->program->futhark_mc_copy_41836_task_42176_iter[i] / (ctx->program->futhark_mc_copy_41836_task_42176_runs[i] != 0 ? ctx->program->futhark_mc_copy_41836_task_42176_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42109          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42109_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42109_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42109_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42109_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42109_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42109_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42109_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42109_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42109_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42109_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42109_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42109_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42109_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42109_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42109_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42109_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42109_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42109_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42109_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42109_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42109_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42109_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42109_total_iter / (ctx->program->futhark_mc_segmap_parloop_42109_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42109_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42109_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42109_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42103             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42103_runs[i], (long) ctx->program->futhark_mc_segmap_task_42103_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42103_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42103_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42103_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42103_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42103_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42103_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42103_iter[i], (long) ctx->program->futhark_mc_segmap_task_42103_iter[i] / (ctx->program->futhark_mc_segmap_task_42103_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42103_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42107      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42107_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42107_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42107_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42107_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42107_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42107_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42107_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42107_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42107_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42107_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42107_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42107_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42182            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42182_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42182_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42182_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42182_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42182_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42182_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42182_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42182_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42182_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42182_iter[i] / (ctx->program->futhark_mc_copy_parloop_42182_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42182_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42182_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42182_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42182_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42182_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42182_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42182_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42182_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42182_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42182_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42182_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42182_total_iter / (ctx->program->futhark_mc_copy_parloop_42182_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42182_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42182_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42182_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41861_task_42180         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41861_task_42180_runs[i], (long) ctx->program->futhark_mc_copy_41861_task_42180_total_runtime[i] / (ctx->program->futhark_mc_copy_41861_task_42180_runs[i] != 0 ? ctx->program->futhark_mc_copy_41861_task_42180_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41861_task_42180_total_runtime[i], (double) ctx->program->futhark_mc_copy_41861_task_42180_total_runtime[i] / (ctx->program->futhark_mc_copy_41861_task_42180_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41861_task_42180_iter[i]), (long) ctx->program->futhark_mc_copy_41861_task_42180_iter[i], (long) ctx->program->futhark_mc_copy_41861_task_42180_iter[i] / (ctx->program->futhark_mc_copy_41861_task_42180_runs[i] != 0 ? ctx->program->futhark_mc_copy_41861_task_42180_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42100          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42100_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42100_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42100_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42100_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42100_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42100_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42100_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42100_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42100_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42100_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42100_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42100_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42100_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42100_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42100_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42100_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42100_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42100_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42100_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42100_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42100_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42100_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42100_total_iter / (ctx->program->futhark_mc_segmap_parloop_42100_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42100_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42100_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42100_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42094             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42094_runs[i], (long) ctx->program->futhark_mc_segmap_task_42094_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42094_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42094_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42094_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42094_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42094_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42094_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42094_iter[i], (long) ctx->program->futhark_mc_segmap_task_42094_iter[i] / (ctx->program->futhark_mc_segmap_task_42094_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42094_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42098      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42098_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42098_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42098_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42098_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42098_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42098_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42098_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42098_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42098_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42098_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42098_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42098_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42186            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42186_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42186_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42186_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42186_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42186_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42186_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42186_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42186_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42186_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42186_iter[i] / (ctx->program->futhark_mc_copy_parloop_42186_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42186_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42186_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42186_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42186_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42186_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42186_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42186_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42186_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42186_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42186_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42186_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42186_total_iter / (ctx->program->futhark_mc_copy_parloop_42186_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42186_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42186_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42186_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41889_task_42184         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41889_task_42184_runs[i], (long) ctx->program->futhark_mc_copy_41889_task_42184_total_runtime[i] / (ctx->program->futhark_mc_copy_41889_task_42184_runs[i] != 0 ? ctx->program->futhark_mc_copy_41889_task_42184_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41889_task_42184_total_runtime[i], (double) ctx->program->futhark_mc_copy_41889_task_42184_total_runtime[i] / (ctx->program->futhark_mc_copy_41889_task_42184_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41889_task_42184_iter[i]), (long) ctx->program->futhark_mc_copy_41889_task_42184_iter[i], (long) ctx->program->futhark_mc_copy_41889_task_42184_iter[i] / (ctx->program->futhark_mc_copy_41889_task_42184_runs[i] != 0 ? ctx->program->futhark_mc_copy_41889_task_42184_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42091          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42091_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42091_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42091_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42091_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42091_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42091_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42091_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42091_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42091_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42091_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42091_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42091_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42091_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42091_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42091_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42091_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42091_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42091_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42091_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42091_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42091_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42091_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42091_total_iter / (ctx->program->futhark_mc_segmap_parloop_42091_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42091_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42091_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42091_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42085             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42085_runs[i], (long) ctx->program->futhark_mc_segmap_task_42085_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42085_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42085_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42085_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42085_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42085_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42085_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42085_iter[i], (long) ctx->program->futhark_mc_segmap_task_42085_iter[i] / (ctx->program->futhark_mc_segmap_task_42085_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42085_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42089      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42089_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42089_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42089_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42089_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42089_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42089_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42089_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42089_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42089_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42089_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42089_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42089_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42190            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42190_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42190_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42190_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42190_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42190_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42190_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42190_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42190_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42190_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42190_iter[i] / (ctx->program->futhark_mc_copy_parloop_42190_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42190_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42190_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42190_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42190_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42190_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42190_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42190_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42190_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42190_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42190_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42190_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42190_total_iter / (ctx->program->futhark_mc_copy_parloop_42190_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42190_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42190_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42190_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41920_task_42188         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41920_task_42188_runs[i], (long) ctx->program->futhark_mc_copy_41920_task_42188_total_runtime[i] / (ctx->program->futhark_mc_copy_41920_task_42188_runs[i] != 0 ? ctx->program->futhark_mc_copy_41920_task_42188_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41920_task_42188_total_runtime[i], (double) ctx->program->futhark_mc_copy_41920_task_42188_total_runtime[i] / (ctx->program->futhark_mc_copy_41920_task_42188_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41920_task_42188_iter[i]), (long) ctx->program->futhark_mc_copy_41920_task_42188_iter[i], (long) ctx->program->futhark_mc_copy_41920_task_42188_iter[i] / (ctx->program->futhark_mc_copy_41920_task_42188_runs[i] != 0 ? ctx->program->futhark_mc_copy_41920_task_42188_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42082          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42082_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42082_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42082_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42082_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42082_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42082_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42082_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42082_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42082_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42082_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42082_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42082_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42082_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42082_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42082_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42082_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42082_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42082_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42082_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42082_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42082_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42082_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42082_total_iter / (ctx->program->futhark_mc_segmap_parloop_42082_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42082_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42082_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42082_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42076             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42076_runs[i], (long) ctx->program->futhark_mc_segmap_task_42076_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42076_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42076_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42076_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42076_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42076_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42076_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42076_iter[i], (long) ctx->program->futhark_mc_segmap_task_42076_iter[i] / (ctx->program->futhark_mc_segmap_task_42076_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42076_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42080      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42080_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42080_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42080_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42080_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42080_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42080_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42080_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42080_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42080_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42080_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42080_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42080_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42194            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42194_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42194_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42194_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42194_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42194_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42194_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42194_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42194_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42194_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42194_iter[i] / (ctx->program->futhark_mc_copy_parloop_42194_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42194_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42194_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42194_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42194_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42194_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42194_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42194_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42194_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42194_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42194_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42194_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42194_total_iter / (ctx->program->futhark_mc_copy_parloop_42194_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42194_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42194_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42194_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41954_task_42192         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41954_task_42192_runs[i], (long) ctx->program->futhark_mc_copy_41954_task_42192_total_runtime[i] / (ctx->program->futhark_mc_copy_41954_task_42192_runs[i] != 0 ? ctx->program->futhark_mc_copy_41954_task_42192_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41954_task_42192_total_runtime[i], (double) ctx->program->futhark_mc_copy_41954_task_42192_total_runtime[i] / (ctx->program->futhark_mc_copy_41954_task_42192_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41954_task_42192_iter[i]), (long) ctx->program->futhark_mc_copy_41954_task_42192_iter[i], (long) ctx->program->futhark_mc_copy_41954_task_42192_iter[i] / (ctx->program->futhark_mc_copy_41954_task_42192_runs[i] != 0 ? ctx->program->futhark_mc_copy_41954_task_42192_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42073          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42073_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42073_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42073_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42073_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42073_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42073_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42073_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42073_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42073_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42073_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42073_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42073_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42073_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42073_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42073_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42073_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42073_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42073_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42073_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42073_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42073_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42073_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42073_total_iter / (ctx->program->futhark_mc_segmap_parloop_42073_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42073_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42073_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42073_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42067             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42067_runs[i], (long) ctx->program->futhark_mc_segmap_task_42067_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42067_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42067_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42067_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42067_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42067_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42067_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42067_iter[i], (long) ctx->program->futhark_mc_segmap_task_42067_iter[i] / (ctx->program->futhark_mc_segmap_task_42067_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42067_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42071      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42071_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42071_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42071_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42071_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42071_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42071_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42071_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42071_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42071_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42071_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42071_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42071_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42198            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42198_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42198_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42198_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42198_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42198_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42198_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42198_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42198_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42198_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42198_iter[i] / (ctx->program->futhark_mc_copy_parloop_42198_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42198_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42198_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42198_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42198_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42198_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42198_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42198_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42198_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42198_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42198_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42198_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42198_total_iter / (ctx->program->futhark_mc_copy_parloop_42198_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42198_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42198_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42198_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_41991_task_42196         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_41991_task_42196_runs[i], (long) ctx->program->futhark_mc_copy_41991_task_42196_total_runtime[i] / (ctx->program->futhark_mc_copy_41991_task_42196_runs[i] != 0 ? ctx->program->futhark_mc_copy_41991_task_42196_runs[i] : 1), (long) ctx->program->futhark_mc_copy_41991_task_42196_total_runtime[i], (double) ctx->program->futhark_mc_copy_41991_task_42196_total_runtime[i] / (ctx->program->futhark_mc_copy_41991_task_42196_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_41991_task_42196_iter[i]), (long) ctx->program->futhark_mc_copy_41991_task_42196_iter[i], (long) ctx->program->futhark_mc_copy_41991_task_42196_iter[i] / (ctx->program->futhark_mc_copy_41991_task_42196_runs[i] != 0 ? ctx->program->futhark_mc_copy_41991_task_42196_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42064          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42064_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42064_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42064_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42064_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42064_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42064_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42064_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42064_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42064_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42064_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42064_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42064_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42064_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42064_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42064_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42064_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42064_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42064_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42064_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42064_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42064_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42064_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42064_total_iter / (ctx->program->futhark_mc_segmap_parloop_42064_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42064_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42064_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42064_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42058             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42058_runs[i], (long) ctx->program->futhark_mc_segmap_task_42058_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42058_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42058_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42058_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42058_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42058_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42058_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42058_iter[i], (long) ctx->program->futhark_mc_segmap_task_42058_iter[i] / (ctx->program->futhark_mc_segmap_task_42058_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42058_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42062      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42062_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42062_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42062_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42062_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42062_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42062_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42062_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42062_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42062_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42062_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42062_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42062_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_parloop_42202            ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_parloop_42202_runs[i], (long) ctx->program->futhark_mc_copy_parloop_42202_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42202_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42202_runs[i] : 1), (long) ctx->program->futhark_mc_copy_parloop_42202_total_runtime[i], (double) ctx->program->futhark_mc_copy_parloop_42202_total_runtime[i] / (ctx->program->futhark_mc_copy_parloop_42202_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42202_iter[i]), (long) ctx->program->futhark_mc_copy_parloop_42202_iter[i], (long) ctx->program->futhark_mc_copy_parloop_42202_iter[i] / (ctx->program->futhark_mc_copy_parloop_42202_runs[i] != 0 ? ctx->program->futhark_mc_copy_parloop_42202_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_copy_parloop_42202_total      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_copy_parloop_42202_total_runs, (long) ctx->program->futhark_mc_copy_parloop_42202_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42202_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42202_total_runs : 1), (long) ctx->program->futhark_mc_copy_parloop_42202_total_total_runtime, (double) ctx->program->futhark_mc_copy_parloop_42202_total_total_runtime / (ctx->program->futhark_mc_copy_parloop_42202_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_copy_parloop_42202_total_iter), (long) ctx->program->futhark_mc_copy_parloop_42202_total_iter, (long) ctx->program->futhark_mc_copy_parloop_42202_total_iter / (ctx->program->futhark_mc_copy_parloop_42202_total_runs != 0 ? ctx->program->futhark_mc_copy_parloop_42202_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_copy_parloop_42202_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_copy_parloop_42202_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_copy_42031_task_42200         ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_copy_42031_task_42200_runs[i], (long) ctx->program->futhark_mc_copy_42031_task_42200_total_runtime[i] / (ctx->program->futhark_mc_copy_42031_task_42200_runs[i] != 0 ? ctx->program->futhark_mc_copy_42031_task_42200_runs[i] : 1), (long) ctx->program->futhark_mc_copy_42031_task_42200_total_runtime[i], (double) ctx->program->futhark_mc_copy_42031_task_42200_total_runtime[i] / (ctx->program->futhark_mc_copy_42031_task_42200_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_copy_42031_task_42200_iter[i]), (long) ctx->program->futhark_mc_copy_42031_task_42200_iter[i], (long) ctx->program->futhark_mc_copy_42031_task_42200_iter[i] / (ctx->program->futhark_mc_copy_42031_task_42200_runs[i] != 0 ? ctx->program->futhark_mc_copy_42031_task_42200_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_parloop_42055          ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_parloop_42055_runs[i], (long) ctx->program->futhark_mc_segmap_parloop_42055_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42055_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42055_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_parloop_42055_total_runtime[i], (double) ctx->program->futhark_mc_segmap_parloop_42055_total_runtime[i] / (ctx->program->futhark_mc_segmap_parloop_42055_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42055_iter[i]), (long) ctx->program->futhark_mc_segmap_parloop_42055_iter[i], (long) ctx->program->futhark_mc_segmap_parloop_42055_iter[i] / (ctx->program->futhark_mc_segmap_parloop_42055_runs[i] != 0 ? ctx->program->futhark_mc_segmap_parloop_42055_runs[i] : 1));
        fprintf(ctx->log, "         futhark_mc_segmap_parloop_42055_total    ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", ctx->program->futhark_mc_segmap_parloop_42055_total_runs, (long) ctx->program->futhark_mc_segmap_parloop_42055_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42055_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42055_total_runs : 1), (long) ctx->program->futhark_mc_segmap_parloop_42055_total_total_runtime, (double) ctx->program->futhark_mc_segmap_parloop_42055_total_total_runtime / (ctx->program->futhark_mc_segmap_parloop_42055_total_iter == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_parloop_42055_total_iter), (long) ctx->program->futhark_mc_segmap_parloop_42055_total_iter, (long) ctx->program->futhark_mc_segmap_parloop_42055_total_iter / (ctx->program->futhark_mc_segmap_parloop_42055_total_runs != 0 ? ctx->program->futhark_mc_segmap_parloop_42055_total_runs : 1));
        ctx->total_runtime += ctx->program->futhark_mc_segmap_parloop_42055_total_total_runtime;
        ctx->total_runs += ctx->program->futhark_mc_segmap_parloop_42055_total_runs;
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_task_42049             ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_task_42049_runs[i], (long) ctx->program->futhark_mc_segmap_task_42049_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42049_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42049_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_task_42049_total_runtime[i], (double) ctx->program->futhark_mc_segmap_task_42049_total_runtime[i] / (ctx->program->futhark_mc_segmap_task_42049_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_task_42049_iter[i]), (long) ctx->program->futhark_mc_segmap_task_42049_iter[i], (long) ctx->program->futhark_mc_segmap_task_42049_iter[i] / (ctx->program->futhark_mc_segmap_task_42049_runs[i] != 0 ? ctx->program->futhark_mc_segmap_task_42049_runs[i] : 1));
        for (int i = 0; i < ctx->scheduler.num_threads; i++)
            fprintf(ctx->log, "tid %2d - futhark_mc_segmap_nested_task_42053      ran %10d times; avg: %10ldus; total: %10ldus; time pr. iter %9.6f; iters %9ld; avg %ld\n", i, ctx->program->futhark_mc_segmap_nested_task_42053_runs[i], (long) ctx->program->futhark_mc_segmap_nested_task_42053_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42053_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42053_runs[i] : 1), (long) ctx->program->futhark_mc_segmap_nested_task_42053_total_runtime[i], (double) ctx->program->futhark_mc_segmap_nested_task_42053_total_runtime[i] / (ctx->program->futhark_mc_segmap_nested_task_42053_iter[i] == 0 ? 1 : (double) ctx->program->futhark_mc_segmap_nested_task_42053_iter[i]), (long) ctx->program->futhark_mc_segmap_nested_task_42053_iter[i], (long) ctx->program->futhark_mc_segmap_nested_task_42053_iter[i] / (ctx->program->futhark_mc_segmap_nested_task_42053_runs[i] != 0 ? ctx->program->futhark_mc_segmap_nested_task_42053_runs[i] : 1));
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f)
{
    ctx->log = f;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    worker_local = &ctx->scheduler.workers[0];
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Eventually it would be nice to move the context definition in here
// instead of generating it in the compiler.  For now it defines
// various helper functions that must be available.

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->detail_memory = cfg->debugging;
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  free_constants(ctx);
  teardown_program(ctx);
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  free(ctx->constants);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

static int futrts_entry_main(struct futhark_context *ctx, bool *out_prim_out_42203);

struct futhark_mc_task_42034 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30513;
    unsigned char *free_static_array_34855;
};
struct futhark_mc_copy_parloop_struct_42036 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30513;
    unsigned char *free_static_array_34855;
};
static int futhark_mc_copy_parloop_42037(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42036 *futhark_mc_copy_parloop_struct_42036 = (struct futhark_mc_copy_parloop_struct_42036 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42036->ctx;
    uint64_t futhark_mc_copy_parloop_42037_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42037_start = get_wall_time();
    
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_copy_parloop_struct_42036->free_mem_30513, .size =0, .references =NULL};
    struct memblock static_array_34855 = {.desc ="static_array_34855", .mem =futhark_mc_copy_parloop_struct_42036->free_static_array_34855, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_34856;
        int64_t end_34857;
        
        start_34856 = start;
        end_34857 = end;
        
        int64_t n_34858 = end_34857 - start_34856;
        
        for (int64_t copy_i_34859 = start_34856; copy_i_34859 < start_34856 + n_34858; copy_i_34859++) {
            int64_t slice_34861 = (int64_t) 2;
            int64_t i_34860 = copy_i_34859;
            int64_t remnant_34862 = copy_i_34859 - i_34860;
            bool tmp_34863 = ((bool *) static_array_34855.mem)[i_34860];
            
            ((bool *) mem_30513.mem)[i_34860] = tmp_34863;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42037_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42037_end - futhark_mc_copy_parloop_42037_start;
        
        ctx->program->futhark_mc_copy_parloop_42037_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42037_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42037_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_34864_task_42035(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42034 *futhark_mc_task_42034 = (struct futhark_mc_task_42034 *) args;
    struct futhark_context *ctx = futhark_mc_task_42034->ctx;
    uint64_t futhark_mc_copy_34864_task_42035_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_34864_task_42035_start = get_wall_time();
    
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42034->free_mem_30513, .size =0, .references =NULL};
    struct memblock static_array_34855 = {.desc ="static_array_34855", .mem =futhark_mc_task_42034->free_static_array_34855, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42036 futhark_mc_copy_parloop_struct_42036_;
    
    futhark_mc_copy_parloop_struct_42036_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42036_.free_mem_30513 = mem_30513.mem;
    futhark_mc_copy_parloop_struct_42036_.free_static_array_34855 = static_array_34855.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42037_task;
    
    futhark_mc_copy_parloop_42037_task.name = "futhark_mc_copy_parloop_42037";
    futhark_mc_copy_parloop_42037_task.fn = futhark_mc_copy_parloop_42037;
    futhark_mc_copy_parloop_42037_task.args = &futhark_mc_copy_parloop_struct_42036_;
    futhark_mc_copy_parloop_42037_task.iterations = iterations;
    futhark_mc_copy_parloop_42037_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42037_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42037_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42037_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42037_task);
    
    if (futhark_mc_copy_parloop_42037_err != 0) {
        err = futhark_mc_copy_parloop_42037_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42037_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42037_total_end - futhark_mc_copy_parloop_42037_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42037_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42037_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42037_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_34864_task_42035_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_34864_task_42035_end - futhark_mc_copy_34864_task_42035_start;
        
        ctx->program->futhark_mc_copy_34864_task_42035_runs[tid]++;
        ctx->program->futhark_mc_copy_34864_task_42035_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_34864_task_42035_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42039 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30515;
    unsigned char *free_static_array_34866;
};
struct futhark_mc_copy_parloop_struct_42041 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30515;
    unsigned char *free_static_array_34866;
};
static int futhark_mc_copy_parloop_42042(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42041 *futhark_mc_copy_parloop_struct_42041 = (struct futhark_mc_copy_parloop_struct_42041 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42041->ctx;
    uint64_t futhark_mc_copy_parloop_42042_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42042_start = get_wall_time();
    
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_copy_parloop_struct_42041->free_mem_30515, .size =0, .references =NULL};
    struct memblock static_array_34866 = {.desc ="static_array_34866", .mem =futhark_mc_copy_parloop_struct_42041->free_static_array_34866, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_34867;
        int64_t end_34868;
        
        start_34867 = start;
        end_34868 = end;
        
        int64_t n_34869 = end_34868 - start_34867;
        
        for (int64_t copy_i_34870 = start_34867; copy_i_34870 < start_34867 + n_34869; copy_i_34870++) {
            int64_t slice_34872 = (int64_t) 16;
            int64_t i_34871 = copy_i_34870;
            int64_t remnant_34873 = copy_i_34870 - i_34871;
            int8_t tmp_34874 = ((int8_t *) static_array_34866.mem)[i_34871];
            
            ((int8_t *) mem_30515.mem)[i_34871] = tmp_34874;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42042_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42042_end - futhark_mc_copy_parloop_42042_start;
        
        ctx->program->futhark_mc_copy_parloop_42042_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42042_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42042_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_34875_task_42040(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42039 *futhark_mc_task_42039 = (struct futhark_mc_task_42039 *) args;
    struct futhark_context *ctx = futhark_mc_task_42039->ctx;
    uint64_t futhark_mc_copy_34875_task_42040_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_34875_task_42040_start = get_wall_time();
    
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42039->free_mem_30515, .size =0, .references =NULL};
    struct memblock static_array_34866 = {.desc ="static_array_34866", .mem =futhark_mc_task_42039->free_static_array_34866, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42041 futhark_mc_copy_parloop_struct_42041_;
    
    futhark_mc_copy_parloop_struct_42041_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42041_.free_mem_30515 = mem_30515.mem;
    futhark_mc_copy_parloop_struct_42041_.free_static_array_34866 = static_array_34866.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42042_task;
    
    futhark_mc_copy_parloop_42042_task.name = "futhark_mc_copy_parloop_42042";
    futhark_mc_copy_parloop_42042_task.fn = futhark_mc_copy_parloop_42042;
    futhark_mc_copy_parloop_42042_task.args = &futhark_mc_copy_parloop_struct_42041_;
    futhark_mc_copy_parloop_42042_task.iterations = iterations;
    futhark_mc_copy_parloop_42042_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42042_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42042_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42042_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42042_task);
    
    if (futhark_mc_copy_parloop_42042_err != 0) {
        err = futhark_mc_copy_parloop_42042_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42042_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42042_total_end - futhark_mc_copy_parloop_42042_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42042_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42042_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42042_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_34875_task_42040_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_34875_task_42040_end - futhark_mc_copy_34875_task_42040_start;
        
        ctx->program->futhark_mc_copy_34875_task_42040_runs[tid]++;
        ctx->program->futhark_mc_copy_34875_task_42040_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_34875_task_42040_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42044 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30517;
    unsigned char *free_static_array_34877;
};
struct futhark_mc_copy_parloop_struct_42046 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30517;
    unsigned char *free_static_array_34877;
};
static int futhark_mc_copy_parloop_42047(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42046 *futhark_mc_copy_parloop_struct_42046 = (struct futhark_mc_copy_parloop_struct_42046 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42046->ctx;
    uint64_t futhark_mc_copy_parloop_42047_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42047_start = get_wall_time();
    
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_copy_parloop_struct_42046->free_mem_30517, .size =0, .references =NULL};
    struct memblock static_array_34877 = {.desc ="static_array_34877", .mem =futhark_mc_copy_parloop_struct_42046->free_static_array_34877, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_34878;
        int64_t end_34879;
        
        start_34878 = start;
        end_34879 = end;
        
        int64_t n_34880 = end_34879 - start_34878;
        
        for (int64_t copy_i_34881 = start_34878; copy_i_34881 < start_34878 + n_34880; copy_i_34881++) {
            int64_t slice_34883 = (int64_t) 16;
            int64_t i_34882 = copy_i_34881;
            int64_t remnant_34884 = copy_i_34881 - i_34882;
            int8_t tmp_34885 = ((int8_t *) static_array_34877.mem)[i_34882];
            
            ((int8_t *) mem_30517.mem)[i_34882] = tmp_34885;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42047_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42047_end - futhark_mc_copy_parloop_42047_start;
        
        ctx->program->futhark_mc_copy_parloop_42047_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42047_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42047_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_34886_task_42045(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42044 *futhark_mc_task_42044 = (struct futhark_mc_task_42044 *) args;
    struct futhark_context *ctx = futhark_mc_task_42044->ctx;
    uint64_t futhark_mc_copy_34886_task_42045_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_34886_task_42045_start = get_wall_time();
    
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42044->free_mem_30517, .size =0, .references =NULL};
    struct memblock static_array_34877 = {.desc ="static_array_34877", .mem =futhark_mc_task_42044->free_static_array_34877, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42046 futhark_mc_copy_parloop_struct_42046_;
    
    futhark_mc_copy_parloop_struct_42046_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42046_.free_mem_30517 = mem_30517.mem;
    futhark_mc_copy_parloop_struct_42046_.free_static_array_34877 = static_array_34877.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42047_task;
    
    futhark_mc_copy_parloop_42047_task.name = "futhark_mc_copy_parloop_42047";
    futhark_mc_copy_parloop_42047_task.fn = futhark_mc_copy_parloop_42047;
    futhark_mc_copy_parloop_42047_task.args = &futhark_mc_copy_parloop_struct_42046_;
    futhark_mc_copy_parloop_42047_task.iterations = iterations;
    futhark_mc_copy_parloop_42047_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42047_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42047_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42047_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42047_task);
    
    if (futhark_mc_copy_parloop_42047_err != 0) {
        err = futhark_mc_copy_parloop_42047_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42047_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42047_total_end - futhark_mc_copy_parloop_42047_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42047_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42047_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42047_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_34886_task_42045_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_34886_task_42045_end - futhark_mc_copy_34886_task_42045_start;
        
        ctx->program->futhark_mc_copy_34886_task_42045_runs[tid]++;
        ctx->program->futhark_mc_copy_34886_task_42045_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_34886_task_42045_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42048 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    unsigned char *free_mem_34853;
};
struct futhark_mc_segmap_parloop_struct_42050 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    unsigned char *free_mem_34853;
};
static int futhark_mc_segmap_parloop_42051(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42050 *futhark_mc_segmap_parloop_struct_42050 = (struct futhark_mc_segmap_parloop_struct_42050 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42050->ctx;
    uint64_t futhark_mc_segmap_parloop_42051_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42051_start = get_wall_time();
    
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42050->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42050->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42050->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_34853 = {.desc ="mem_34853", .mem =futhark_mc_segmap_parloop_struct_42050->free_mem_34853, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_33841_cached_sizze_42052 = 0;
    unsigned char *mem_33841 = NULL;
    int64_t flat_tid_23263;
    
    flat_tid_23263 = subtask_id;
    {
        int64_t start_34986;
        int64_t end_34987;
        
        start_34986 = start;
        end_34987 = end;
        
        int64_t n_34988 = end_34987 - start_34986;
        
        if (mem_33841_cached_sizze_42052 < (int64_t) 67108864) {
            err = lexical_realloc(ctx, &mem_33841, &mem_33841_cached_sizze_42052, (int64_t) 67108864);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_34989 = start_34986; SegMap_i_34989 < start_34986 + n_34988; SegMap_i_34989++) {
            int64_t slice_34990 = (int64_t) 16;
            int64_t gtid_23264 = SegMap_i_34989;
            int64_t remnant_34991 = SegMap_i_34989 - gtid_23264;
            int8_t x_22683 = ((int8_t *) mem_30515.mem)[gtid_23264];
            
            for (int64_t i_34889 = 0; i_34889 < (int64_t) 16; i_34889++) {
                int8_t x_34891 = ((int8_t *) mem_30515.mem)[i_34889];
                
                for (int64_t i_34893 = 0; i_34893 < (int64_t) 2; i_34893++) {
                    bool x_34895 = ((bool *) mem_30513.mem)[i_34893];
                    
                    for (int64_t i_34897 = 0; i_34897 < (int64_t) 2; i_34897++) {
                        bool x_34899 = ((bool *) mem_30513.mem)[i_34897];
                        
                        for (int64_t i_34901 = 0; i_34901 < (int64_t) 16; i_34901++) {
                            int8_t x_34903 = ((int8_t *) mem_30515.mem)[i_34901];
                            
                            for (int64_t i_34905 = 0; i_34905 < (int64_t) 16; i_34905++) {
                                int8_t x_34907 = ((int8_t *) mem_30515.mem)[i_34905];
                                
                                for (int64_t i_34909 = 0; i_34909 < (int64_t) 2; i_34909++) {
                                    bool x_34911 = ((bool *) mem_30513.mem)[i_34909];
                                    
                                    for (int64_t i_34913 = 0; i_34913 < (int64_t) 2; i_34913++) {
                                        bool x_34915 = ((bool *) mem_30513.mem)[i_34913];
                                        
                                        for (int64_t i_34917 = 0; i_34917 < (int64_t) 16; i_34917++) {
                                            int8_t x_34919 = ((int8_t *) mem_30515.mem)[i_34917];
                                            
                                            for (int64_t i_34921 = 0; i_34921 < (int64_t) 16; i_34921++) {
                                                int8_t x_34923 = ((int8_t *) mem_30515.mem)[i_34921];
                                                
                                                for (int64_t i_34925 = 0; i_34925 < (int64_t) 2; i_34925++) {
                                                    bool x_34927 = ((bool *) mem_30513.mem)[i_34925];
                                                    
                                                    for (int64_t i_34929 = 0; i_34929 < (int64_t) 2; i_34929++) {
                                                        bool x_34931 = ((bool *) mem_30513.mem)[i_34929];
                                                        bool all_equal_34932;
                                                        bool redout_34934 = 1;
                                                        
                                                        for (int64_t i_34933 = 0; i_34933 < (int64_t) 16; i_34933++) {
                                                            int8_t x_34935 = ((int8_t *) mem_30515.mem)[i_34933];
                                                            int8_t y_34936 = ((int8_t *) mem_30517.mem)[i_34933];
                                                            int8_t comperator_res_34937;
                                                            
                                                            if (x_34895 == 1) {
                                                                bool cond_34938 = ult8(x_22683, x_34935);
                                                                int8_t comperator_res_t_res_34939;
                                                                
                                                                if (cond_34938 == 1) {
                                                                    int8_t comperator_res_t_res_t_res_34940 = sub8(x_34935, x_22683);
                                                                    
                                                                    comperator_res_t_res_34939 = comperator_res_t_res_t_res_34940;
                                                                } else {
                                                                    comperator_res_t_res_34939 = (int8_t) 0;
                                                                }
                                                                comperator_res_34937 = comperator_res_t_res_34939;
                                                            } else {
                                                                bool cond_34941 = ult8(x_22683, x_34935);
                                                                int8_t comperator_res_f_res_34942;
                                                                
                                                                if (cond_34941 == 1) {
                                                                    comperator_res_f_res_34942 = x_34935;
                                                                } else {
                                                                    comperator_res_f_res_34942 = (int8_t) 0;
                                                                }
                                                                comperator_res_34937 = comperator_res_f_res_34942;
                                                            }
                                                            
                                                            int8_t comperator_res_34943;
                                                            
                                                            if (x_34899 == 1) {
                                                                bool cond_34944 = ult8(x_34935, x_34891);
                                                                int8_t comperator_res_t_res_34945;
                                                                
                                                                if (cond_34944 == 1) {
                                                                    int8_t comperator_res_t_res_t_res_34946 = sub8(x_34891, x_34935);
                                                                    
                                                                    comperator_res_t_res_34945 = comperator_res_t_res_t_res_34946;
                                                                } else {
                                                                    comperator_res_t_res_34945 = (int8_t) 0;
                                                                }
                                                                comperator_res_34943 = comperator_res_t_res_34945;
                                                            } else {
                                                                bool cond_34947 = ult8(x_34935, x_34891);
                                                                int8_t comperator_res_f_res_34948;
                                                                
                                                                if (cond_34947 == 1) {
                                                                    comperator_res_f_res_34948 = x_34891;
                                                                } else {
                                                                    comperator_res_f_res_34948 = (int8_t) 0;
                                                                }
                                                                comperator_res_34943 = comperator_res_f_res_34948;
                                                            }
                                                            
                                                            bool cond_34949 = ult8(comperator_res_34943, comperator_res_34937);
                                                            int8_t layer_res_34950;
                                                            
                                                            if (cond_34949 == 1) {
                                                                layer_res_34950 = comperator_res_34937;
                                                            } else {
                                                                layer_res_34950 = comperator_res_34943;
                                                            }
                                                            
                                                            int8_t comperator_res_34951;
                                                            
                                                            if (x_34911 == 1) {
                                                                bool cond_34952 = ult8(x_34903, layer_res_34950);
                                                                int8_t comperator_res_t_res_34953;
                                                                
                                                                if (cond_34952 == 1) {
                                                                    int8_t comperator_res_t_res_t_res_34954 = sub8(layer_res_34950, x_34903);
                                                                    
                                                                    comperator_res_t_res_34953 = comperator_res_t_res_t_res_34954;
                                                                } else {
                                                                    comperator_res_t_res_34953 = (int8_t) 0;
                                                                }
                                                                comperator_res_34951 = comperator_res_t_res_34953;
                                                            } else {
                                                                bool cond_34955 = ult8(x_34903, layer_res_34950);
                                                                int8_t comperator_res_f_res_34956;
                                                                
                                                                if (cond_34955 == 1) {
                                                                    comperator_res_f_res_34956 = layer_res_34950;
                                                                } else {
                                                                    comperator_res_f_res_34956 = (int8_t) 0;
                                                                }
                                                                comperator_res_34951 = comperator_res_f_res_34956;
                                                            }
                                                            
                                                            int8_t comperator_res_34957;
                                                            
                                                            if (x_34915 == 1) {
                                                                bool cond_34958 = ult8(layer_res_34950, x_34907);
                                                                int8_t comperator_res_t_res_34959;
                                                                
                                                                if (cond_34958 == 1) {
                                                                    int8_t comperator_res_t_res_t_res_34960 = sub8(x_34907, layer_res_34950);
                                                                    
                                                                    comperator_res_t_res_34959 = comperator_res_t_res_t_res_34960;
                                                                } else {
                                                                    comperator_res_t_res_34959 = (int8_t) 0;
                                                                }
                                                                comperator_res_34957 = comperator_res_t_res_34959;
                                                            } else {
                                                                bool cond_34961 = ult8(layer_res_34950, x_34907);
                                                                int8_t comperator_res_f_res_34962;
                                                                
                                                                if (cond_34961 == 1) {
                                                                    comperator_res_f_res_34962 = x_34907;
                                                                } else {
                                                                    comperator_res_f_res_34962 = (int8_t) 0;
                                                                }
                                                                comperator_res_34957 = comperator_res_f_res_34962;
                                                            }
                                                            
                                                            bool cond_34963 = ult8(comperator_res_34957, comperator_res_34951);
                                                            int8_t layer_res_34964;
                                                            
                                                            if (cond_34963 == 1) {
                                                                layer_res_34964 = comperator_res_34951;
                                                            } else {
                                                                layer_res_34964 = comperator_res_34957;
                                                            }
                                                            
                                                            int8_t comperator_res_34965;
                                                            
                                                            if (x_34927 == 1) {
                                                                bool cond_34966 = ult8(x_34919, layer_res_34964);
                                                                int8_t comperator_res_t_res_34967;
                                                                
                                                                if (cond_34966 == 1) {
                                                                    int8_t comperator_res_t_res_t_res_34968 = sub8(layer_res_34964, x_34919);
                                                                    
                                                                    comperator_res_t_res_34967 = comperator_res_t_res_t_res_34968;
                                                                } else {
                                                                    comperator_res_t_res_34967 = (int8_t) 0;
                                                                }
                                                                comperator_res_34965 = comperator_res_t_res_34967;
                                                            } else {
                                                                bool cond_34969 = ult8(x_34919, layer_res_34964);
                                                                int8_t comperator_res_f_res_34970;
                                                                
                                                                if (cond_34969 == 1) {
                                                                    comperator_res_f_res_34970 = layer_res_34964;
                                                                } else {
                                                                    comperator_res_f_res_34970 = (int8_t) 0;
                                                                }
                                                                comperator_res_34965 = comperator_res_f_res_34970;
                                                            }
                                                            
                                                            int8_t comperator_res_34971;
                                                            
                                                            if (x_34931 == 1) {
                                                                bool cond_34972 = ult8(layer_res_34964, x_34923);
                                                                int8_t comperator_res_t_res_34973;
                                                                
                                                                if (cond_34972 == 1) {
                                                                    int8_t comperator_res_t_res_t_res_34974 = sub8(x_34923, layer_res_34964);
                                                                    
                                                                    comperator_res_t_res_34973 = comperator_res_t_res_t_res_34974;
                                                                } else {
                                                                    comperator_res_t_res_34973 = (int8_t) 0;
                                                                }
                                                                comperator_res_34971 = comperator_res_t_res_34973;
                                                            } else {
                                                                bool cond_34975 = ult8(layer_res_34964, x_34923);
                                                                int8_t comperator_res_f_res_34976;
                                                                
                                                                if (cond_34975 == 1) {
                                                                    comperator_res_f_res_34976 = x_34923;
                                                                } else {
                                                                    comperator_res_f_res_34976 = (int8_t) 0;
                                                                }
                                                                comperator_res_34971 = comperator_res_f_res_34976;
                                                            }
                                                            
                                                            bool cond_34977 = ult8(comperator_res_34971, comperator_res_34965);
                                                            bool eq_x_y_34978 = y_34936 == comperator_res_34965;
                                                            bool eq_x_zz_34979 = y_34936 == comperator_res_34971;
                                                            bool p_and_eq_x_y_34980 = cond_34977 && eq_x_y_34978;
                                                            bool not_p_34981 = !cond_34977;
                                                            bool p_and_eq_x_y_34982 = eq_x_zz_34979 && not_p_34981;
                                                            bool binlam_res_34983 = p_and_eq_x_y_34980 || p_and_eq_x_y_34982;
                                                            bool binlam_res_34984 = binlam_res_34983 && redout_34934;
                                                            bool redout_tmp_35003 = binlam_res_34984;
                                                            
                                                            redout_34934 = redout_tmp_35003;
                                                        }
                                                        all_equal_34932 = redout_34934;
                                                        ((bool *) mem_33841)[i_34889 * (int64_t) 4194304 + i_34893 * (int64_t) 2097152 + i_34897 * (int64_t) 1048576 + i_34901 * (int64_t) 65536 + i_34905 * (int64_t) 4096 + i_34909 * (int64_t) 2048 + i_34913 * (int64_t) 1024 + i_34917 * (int64_t) 64 + i_34921 * (int64_t) 4 + i_34925 * (int64_t) 2 + i_34929] = all_equal_34932;
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if ((int64_t) 67108864 > 0)
                memmove(mem_34853.mem + gtid_23264 * (int64_t) 67108864, mem_33841 + (int64_t) 0, (int64_t) 67108864);
        }
    }
    
  cleanup:
    {
        free(mem_33841);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42051_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42051_end - futhark_mc_segmap_parloop_42051_start;
        
        ctx->program->futhark_mc_segmap_parloop_42051_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42051_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42051_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42049(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42048 *futhark_mc_task_42048 = (struct futhark_mc_task_42048 *) args;
    struct futhark_context *ctx = futhark_mc_task_42048->ctx;
    uint64_t futhark_mc_segmap_task_42049_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42049_start = get_wall_time();
    
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42048->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42048->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42048->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_34853 = {.desc ="mem_34853", .mem =futhark_mc_task_42048->free_mem_34853, .size =0, .references =NULL};
    int32_t nsubtasks_34888;
    
    nsubtasks_34888 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42050 futhark_mc_segmap_parloop_struct_42050_;
    
    futhark_mc_segmap_parloop_struct_42050_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42050_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42050_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42050_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42050_.free_mem_34853 = mem_34853.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42051_task;
    
    futhark_mc_segmap_parloop_42051_task.name = "futhark_mc_segmap_parloop_42051";
    futhark_mc_segmap_parloop_42051_task.fn = futhark_mc_segmap_parloop_42051;
    futhark_mc_segmap_parloop_42051_task.args = &futhark_mc_segmap_parloop_struct_42050_;
    futhark_mc_segmap_parloop_42051_task.iterations = iterations;
    futhark_mc_segmap_parloop_42051_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42051_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42051_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42051_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42051_task);
    
    if (futhark_mc_segmap_parloop_42051_err != 0) {
        err = futhark_mc_segmap_parloop_42051_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42051_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42051_total_end - futhark_mc_segmap_parloop_42051_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42051_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42051_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42051_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42049_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42049_end - futhark_mc_segmap_task_42049_start;
        
        ctx->program->futhark_mc_segmap_task_42049_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42049_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42049_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42054 {
    struct futhark_context *ctx;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    unsigned char *free_mem_34853;
};
struct futhark_mc_task_42057 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    unsigned char *free_mem_33839;
};
struct futhark_mc_segmap_parloop_struct_42059 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    unsigned char *free_mem_33839;
};
static int futhark_mc_segmap_parloop_42060(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42059 *futhark_mc_segmap_parloop_struct_42059 = (struct futhark_mc_segmap_parloop_struct_42059 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42059->ctx;
    uint64_t futhark_mc_segmap_parloop_42060_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42060_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42059->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42059->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42059->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42059->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_segmap_parloop_struct_42059->free_mem_33839, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_35883_cached_sizze_42061 = 0;
    unsigned char *mem_35883 = NULL;
    int64_t flat_tid_35880;
    
    flat_tid_35880 = subtask_id;
    {
        int64_t start_36079;
        int64_t end_36080;
        
        start_36079 = start;
        end_36080 = end;
        
        int64_t n_36081 = end_36080 - start_36079;
        
        if (mem_35883_cached_sizze_42061 < (int64_t) 4194304) {
            err = lexical_realloc(ctx, &mem_35883, &mem_35883_cached_sizze_42061, (int64_t) 4194304);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_36082 = start_36079; SegMap_i_36082 < start_36079 + n_36081; SegMap_i_36082++) {
            int64_t slice_36083 = (int64_t) 16;
            int64_t gtid_35881 = SegMap_i_36082;
            int64_t remnant_36084 = SegMap_i_36082 - gtid_35881;
            int8_t x_35882 = ((int8_t *) mem_30515.mem)[gtid_35881];
            
            for (int64_t i_35986 = 0; i_35986 < (int64_t) 2; i_35986++) {
                bool x_35988 = ((bool *) mem_30513.mem)[i_35986];
                
                for (int64_t i_35990 = 0; i_35990 < (int64_t) 2; i_35990++) {
                    bool x_35992 = ((bool *) mem_30513.mem)[i_35990];
                    
                    for (int64_t i_35994 = 0; i_35994 < (int64_t) 16; i_35994++) {
                        int8_t x_35996 = ((int8_t *) mem_30515.mem)[i_35994];
                        
                        for (int64_t i_35998 = 0; i_35998 < (int64_t) 16; i_35998++) {
                            int8_t x_36000 = ((int8_t *) mem_30515.mem)[i_35998];
                            
                            for (int64_t i_36002 = 0; i_36002 < (int64_t) 2; i_36002++) {
                                bool x_36004 = ((bool *) mem_30513.mem)[i_36002];
                                
                                for (int64_t i_36006 = 0; i_36006 < (int64_t) 2; i_36006++) {
                                    bool x_36008 = ((bool *) mem_30513.mem)[i_36006];
                                    
                                    for (int64_t i_36010 = 0; i_36010 < (int64_t) 16; i_36010++) {
                                        int8_t x_36012 = ((int8_t *) mem_30515.mem)[i_36010];
                                        
                                        for (int64_t i_36014 = 0; i_36014 < (int64_t) 16; i_36014++) {
                                            int8_t x_36016 = ((int8_t *) mem_30515.mem)[i_36014];
                                            
                                            for (int64_t i_36018 = 0; i_36018 < (int64_t) 2; i_36018++) {
                                                bool x_36020 = ((bool *) mem_30513.mem)[i_36018];
                                                
                                                for (int64_t i_36022 = 0; i_36022 < (int64_t) 2; i_36022++) {
                                                    bool x_36024 = ((bool *) mem_30513.mem)[i_36022];
                                                    bool all_equal_36025;
                                                    bool redout_36027 = 1;
                                                    
                                                    for (int64_t i_36026 = 0; i_36026 < (int64_t) 16; i_36026++) {
                                                        int8_t x_36028 = ((int8_t *) mem_30515.mem)[i_36026];
                                                        int8_t y_36029 = ((int8_t *) mem_30517.mem)[i_36026];
                                                        int8_t comperator_res_36030;
                                                        
                                                        if (x_35988 == 1) {
                                                            bool cond_36031 = ult8(x_27583, x_36028);
                                                            int8_t comperator_res_t_res_36032;
                                                            
                                                            if (cond_36031 == 1) {
                                                                int8_t comperator_res_t_res_t_res_36033 = sub8(x_36028, x_27583);
                                                                
                                                                comperator_res_t_res_36032 = comperator_res_t_res_t_res_36033;
                                                            } else {
                                                                comperator_res_t_res_36032 = (int8_t) 0;
                                                            }
                                                            comperator_res_36030 = comperator_res_t_res_36032;
                                                        } else {
                                                            bool cond_36034 = ult8(x_27583, x_36028);
                                                            int8_t comperator_res_f_res_36035;
                                                            
                                                            if (cond_36034 == 1) {
                                                                comperator_res_f_res_36035 = x_36028;
                                                            } else {
                                                                comperator_res_f_res_36035 = (int8_t) 0;
                                                            }
                                                            comperator_res_36030 = comperator_res_f_res_36035;
                                                        }
                                                        
                                                        int8_t comperator_res_36036;
                                                        
                                                        if (x_35992 == 1) {
                                                            bool cond_36037 = ult8(x_36028, x_35882);
                                                            int8_t comperator_res_t_res_36038;
                                                            
                                                            if (cond_36037 == 1) {
                                                                int8_t comperator_res_t_res_t_res_36039 = sub8(x_35882, x_36028);
                                                                
                                                                comperator_res_t_res_36038 = comperator_res_t_res_t_res_36039;
                                                            } else {
                                                                comperator_res_t_res_36038 = (int8_t) 0;
                                                            }
                                                            comperator_res_36036 = comperator_res_t_res_36038;
                                                        } else {
                                                            bool cond_36040 = ult8(x_36028, x_35882);
                                                            int8_t comperator_res_f_res_36041;
                                                            
                                                            if (cond_36040 == 1) {
                                                                comperator_res_f_res_36041 = x_35882;
                                                            } else {
                                                                comperator_res_f_res_36041 = (int8_t) 0;
                                                            }
                                                            comperator_res_36036 = comperator_res_f_res_36041;
                                                        }
                                                        
                                                        bool cond_36042 = ult8(comperator_res_36036, comperator_res_36030);
                                                        int8_t layer_res_36043;
                                                        
                                                        if (cond_36042 == 1) {
                                                            layer_res_36043 = comperator_res_36030;
                                                        } else {
                                                            layer_res_36043 = comperator_res_36036;
                                                        }
                                                        
                                                        int8_t comperator_res_36044;
                                                        
                                                        if (x_36004 == 1) {
                                                            bool cond_36045 = ult8(x_35996, layer_res_36043);
                                                            int8_t comperator_res_t_res_36046;
                                                            
                                                            if (cond_36045 == 1) {
                                                                int8_t comperator_res_t_res_t_res_36047 = sub8(layer_res_36043, x_35996);
                                                                
                                                                comperator_res_t_res_36046 = comperator_res_t_res_t_res_36047;
                                                            } else {
                                                                comperator_res_t_res_36046 = (int8_t) 0;
                                                            }
                                                            comperator_res_36044 = comperator_res_t_res_36046;
                                                        } else {
                                                            bool cond_36048 = ult8(x_35996, layer_res_36043);
                                                            int8_t comperator_res_f_res_36049;
                                                            
                                                            if (cond_36048 == 1) {
                                                                comperator_res_f_res_36049 = layer_res_36043;
                                                            } else {
                                                                comperator_res_f_res_36049 = (int8_t) 0;
                                                            }
                                                            comperator_res_36044 = comperator_res_f_res_36049;
                                                        }
                                                        
                                                        int8_t comperator_res_36050;
                                                        
                                                        if (x_36008 == 1) {
                                                            bool cond_36051 = ult8(layer_res_36043, x_36000);
                                                            int8_t comperator_res_t_res_36052;
                                                            
                                                            if (cond_36051 == 1) {
                                                                int8_t comperator_res_t_res_t_res_36053 = sub8(x_36000, layer_res_36043);
                                                                
                                                                comperator_res_t_res_36052 = comperator_res_t_res_t_res_36053;
                                                            } else {
                                                                comperator_res_t_res_36052 = (int8_t) 0;
                                                            }
                                                            comperator_res_36050 = comperator_res_t_res_36052;
                                                        } else {
                                                            bool cond_36054 = ult8(layer_res_36043, x_36000);
                                                            int8_t comperator_res_f_res_36055;
                                                            
                                                            if (cond_36054 == 1) {
                                                                comperator_res_f_res_36055 = x_36000;
                                                            } else {
                                                                comperator_res_f_res_36055 = (int8_t) 0;
                                                            }
                                                            comperator_res_36050 = comperator_res_f_res_36055;
                                                        }
                                                        
                                                        bool cond_36056 = ult8(comperator_res_36050, comperator_res_36044);
                                                        int8_t layer_res_36057;
                                                        
                                                        if (cond_36056 == 1) {
                                                            layer_res_36057 = comperator_res_36044;
                                                        } else {
                                                            layer_res_36057 = comperator_res_36050;
                                                        }
                                                        
                                                        int8_t comperator_res_36058;
                                                        
                                                        if (x_36020 == 1) {
                                                            bool cond_36059 = ult8(x_36012, layer_res_36057);
                                                            int8_t comperator_res_t_res_36060;
                                                            
                                                            if (cond_36059 == 1) {
                                                                int8_t comperator_res_t_res_t_res_36061 = sub8(layer_res_36057, x_36012);
                                                                
                                                                comperator_res_t_res_36060 = comperator_res_t_res_t_res_36061;
                                                            } else {
                                                                comperator_res_t_res_36060 = (int8_t) 0;
                                                            }
                                                            comperator_res_36058 = comperator_res_t_res_36060;
                                                        } else {
                                                            bool cond_36062 = ult8(x_36012, layer_res_36057);
                                                            int8_t comperator_res_f_res_36063;
                                                            
                                                            if (cond_36062 == 1) {
                                                                comperator_res_f_res_36063 = layer_res_36057;
                                                            } else {
                                                                comperator_res_f_res_36063 = (int8_t) 0;
                                                            }
                                                            comperator_res_36058 = comperator_res_f_res_36063;
                                                        }
                                                        
                                                        int8_t comperator_res_36064;
                                                        
                                                        if (x_36024 == 1) {
                                                            bool cond_36065 = ult8(layer_res_36057, x_36016);
                                                            int8_t comperator_res_t_res_36066;
                                                            
                                                            if (cond_36065 == 1) {
                                                                int8_t comperator_res_t_res_t_res_36067 = sub8(x_36016, layer_res_36057);
                                                                
                                                                comperator_res_t_res_36066 = comperator_res_t_res_t_res_36067;
                                                            } else {
                                                                comperator_res_t_res_36066 = (int8_t) 0;
                                                            }
                                                            comperator_res_36064 = comperator_res_t_res_36066;
                                                        } else {
                                                            bool cond_36068 = ult8(layer_res_36057, x_36016);
                                                            int8_t comperator_res_f_res_36069;
                                                            
                                                            if (cond_36068 == 1) {
                                                                comperator_res_f_res_36069 = x_36016;
                                                            } else {
                                                                comperator_res_f_res_36069 = (int8_t) 0;
                                                            }
                                                            comperator_res_36064 = comperator_res_f_res_36069;
                                                        }
                                                        
                                                        bool cond_36070 = ult8(comperator_res_36064, comperator_res_36058);
                                                        bool eq_x_y_36071 = y_36029 == comperator_res_36058;
                                                        bool eq_x_zz_36072 = y_36029 == comperator_res_36064;
                                                        bool p_and_eq_x_y_36073 = cond_36070 && eq_x_y_36071;
                                                        bool not_p_36074 = !cond_36070;
                                                        bool p_and_eq_x_y_36075 = eq_x_zz_36072 && not_p_36074;
                                                        bool binlam_res_36076 = p_and_eq_x_y_36073 || p_and_eq_x_y_36075;
                                                        bool binlam_res_36077 = binlam_res_36076 && redout_36027;
                                                        bool redout_tmp_36095 = binlam_res_36077;
                                                        
                                                        redout_36027 = redout_tmp_36095;
                                                    }
                                                    all_equal_36025 = redout_36027;
                                                    ((bool *) mem_35883)[i_35986 * (int64_t) 2097152 + i_35990 * (int64_t) 1048576 + i_35994 * (int64_t) 65536 + i_35998 * (int64_t) 4096 + i_36002 * (int64_t) 2048 + i_36006 * (int64_t) 1024 + i_36010 * (int64_t) 64 + i_36014 * (int64_t) 4 + i_36018 * (int64_t) 2 + i_36022] = all_equal_36025;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if ((int64_t) 4194304 > 0)
                memmove(mem_33839.mem + gtid_35881 * (int64_t) 4194304, mem_35883 + (int64_t) 0, (int64_t) 4194304);
        }
    }
    
  cleanup:
    {
        free(mem_35883);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42060_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42060_end - futhark_mc_segmap_parloop_42060_start;
        
        ctx->program->futhark_mc_segmap_parloop_42060_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42060_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42060_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42058(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42057 *futhark_mc_task_42057 = (struct futhark_mc_task_42057 *) args;
    struct futhark_context *ctx = futhark_mc_task_42057->ctx;
    uint64_t futhark_mc_segmap_task_42058_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42058_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42057->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42057->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42057->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42057->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_task_42057->free_mem_33839, .size =0, .references =NULL};
    int32_t nsubtasks_35985;
    
    nsubtasks_35985 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42059 futhark_mc_segmap_parloop_struct_42059_;
    
    futhark_mc_segmap_parloop_struct_42059_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42059_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42059_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42059_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42059_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42059_.free_mem_33839 = mem_33839.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42060_task;
    
    futhark_mc_segmap_parloop_42060_task.name = "futhark_mc_segmap_parloop_42060";
    futhark_mc_segmap_parloop_42060_task.fn = futhark_mc_segmap_parloop_42060;
    futhark_mc_segmap_parloop_42060_task.args = &futhark_mc_segmap_parloop_struct_42059_;
    futhark_mc_segmap_parloop_42060_task.iterations = iterations;
    futhark_mc_segmap_parloop_42060_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42060_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42060_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42060_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42060_task);
    
    if (futhark_mc_segmap_parloop_42060_err != 0) {
        err = futhark_mc_segmap_parloop_42060_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42060_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42060_total_end - futhark_mc_segmap_parloop_42060_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42060_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42060_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42060_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42058_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42058_end - futhark_mc_segmap_task_42058_start;
        
        ctx->program->futhark_mc_segmap_task_42058_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42058_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42058_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42063 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    unsigned char *free_mem_33839;
};
struct futhark_mc_task_42066 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    unsigned char *free_mem_35008;
};
struct futhark_mc_segmap_parloop_struct_42068 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    unsigned char *free_mem_35008;
};
static int futhark_mc_segmap_parloop_42069(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42068 *futhark_mc_segmap_parloop_struct_42068 = (struct futhark_mc_segmap_parloop_struct_42068 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42068->ctx;
    uint64_t futhark_mc_segmap_parloop_42069_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42069_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42068->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42068->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42068->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42068->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42068->free_x_35007;
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_segmap_parloop_struct_42068->free_mem_35008, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_36875_cached_sizze_42070 = 0;
    unsigned char *mem_36875 = NULL;
    int64_t flat_tid_36872;
    
    flat_tid_36872 = subtask_id;
    {
        int64_t start_37063;
        int64_t end_37064;
        
        start_37063 = start;
        end_37064 = end;
        
        int64_t n_37065 = end_37064 - start_37063;
        
        if (mem_36875_cached_sizze_42070 < (int64_t) 2097152) {
            err = lexical_realloc(ctx, &mem_36875, &mem_36875_cached_sizze_42070, (int64_t) 2097152);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_37066 = start_37063; SegMap_i_37066 < start_37063 + n_37065; SegMap_i_37066++) {
            int64_t slice_37067 = (int64_t) 2;
            int64_t gtid_36873 = SegMap_i_37066;
            int64_t remnant_37068 = SegMap_i_37066 - gtid_36873;
            bool x_36874 = ((bool *) mem_30513.mem)[gtid_36873];
            
            for (int64_t i_36974 = 0; i_36974 < (int64_t) 2; i_36974++) {
                bool x_36976 = ((bool *) mem_30513.mem)[i_36974];
                
                for (int64_t i_36978 = 0; i_36978 < (int64_t) 16; i_36978++) {
                    int8_t x_36980 = ((int8_t *) mem_30515.mem)[i_36978];
                    
                    for (int64_t i_36982 = 0; i_36982 < (int64_t) 16; i_36982++) {
                        int8_t x_36984 = ((int8_t *) mem_30515.mem)[i_36982];
                        
                        for (int64_t i_36986 = 0; i_36986 < (int64_t) 2; i_36986++) {
                            bool x_36988 = ((bool *) mem_30513.mem)[i_36986];
                            
                            for (int64_t i_36990 = 0; i_36990 < (int64_t) 2; i_36990++) {
                                bool x_36992 = ((bool *) mem_30513.mem)[i_36990];
                                
                                for (int64_t i_36994 = 0; i_36994 < (int64_t) 16; i_36994++) {
                                    int8_t x_36996 = ((int8_t *) mem_30515.mem)[i_36994];
                                    
                                    for (int64_t i_36998 = 0; i_36998 < (int64_t) 16; i_36998++) {
                                        int8_t x_37000 = ((int8_t *) mem_30515.mem)[i_36998];
                                        
                                        for (int64_t i_37002 = 0; i_37002 < (int64_t) 2; i_37002++) {
                                            bool x_37004 = ((bool *) mem_30513.mem)[i_37002];
                                            
                                            for (int64_t i_37006 = 0; i_37006 < (int64_t) 2; i_37006++) {
                                                bool x_37008 = ((bool *) mem_30513.mem)[i_37006];
                                                bool all_equal_37009;
                                                bool redout_37011 = 1;
                                                
                                                for (int64_t i_37010 = 0; i_37010 < (int64_t) 16; i_37010++) {
                                                    int8_t x_37012 = ((int8_t *) mem_30515.mem)[i_37010];
                                                    int8_t y_37013 = ((int8_t *) mem_30517.mem)[i_37010];
                                                    int8_t comperator_res_37014;
                                                    
                                                    if (x_36874 == 1) {
                                                        bool cond_37015 = ult8(x_27583, x_37012);
                                                        int8_t comperator_res_t_res_37016;
                                                        
                                                        if (cond_37015 == 1) {
                                                            int8_t comperator_res_t_res_t_res_37017 = sub8(x_37012, x_27583);
                                                            
                                                            comperator_res_t_res_37016 = comperator_res_t_res_t_res_37017;
                                                        } else {
                                                            comperator_res_t_res_37016 = (int8_t) 0;
                                                        }
                                                        comperator_res_37014 = comperator_res_t_res_37016;
                                                    } else {
                                                        bool cond_37018 = ult8(x_27583, x_37012);
                                                        int8_t comperator_res_f_res_37019;
                                                        
                                                        if (cond_37018 == 1) {
                                                            comperator_res_f_res_37019 = x_37012;
                                                        } else {
                                                            comperator_res_f_res_37019 = (int8_t) 0;
                                                        }
                                                        comperator_res_37014 = comperator_res_f_res_37019;
                                                    }
                                                    
                                                    int8_t comperator_res_37020;
                                                    
                                                    if (x_36976 == 1) {
                                                        bool cond_37021 = ult8(x_37012, x_35007);
                                                        int8_t comperator_res_t_res_37022;
                                                        
                                                        if (cond_37021 == 1) {
                                                            int8_t comperator_res_t_res_t_res_37023 = sub8(x_35007, x_37012);
                                                            
                                                            comperator_res_t_res_37022 = comperator_res_t_res_t_res_37023;
                                                        } else {
                                                            comperator_res_t_res_37022 = (int8_t) 0;
                                                        }
                                                        comperator_res_37020 = comperator_res_t_res_37022;
                                                    } else {
                                                        bool cond_37024 = ult8(x_37012, x_35007);
                                                        int8_t comperator_res_f_res_37025;
                                                        
                                                        if (cond_37024 == 1) {
                                                            comperator_res_f_res_37025 = x_35007;
                                                        } else {
                                                            comperator_res_f_res_37025 = (int8_t) 0;
                                                        }
                                                        comperator_res_37020 = comperator_res_f_res_37025;
                                                    }
                                                    
                                                    bool cond_37026 = ult8(comperator_res_37020, comperator_res_37014);
                                                    int8_t layer_res_37027;
                                                    
                                                    if (cond_37026 == 1) {
                                                        layer_res_37027 = comperator_res_37014;
                                                    } else {
                                                        layer_res_37027 = comperator_res_37020;
                                                    }
                                                    
                                                    int8_t comperator_res_37028;
                                                    
                                                    if (x_36988 == 1) {
                                                        bool cond_37029 = ult8(x_36980, layer_res_37027);
                                                        int8_t comperator_res_t_res_37030;
                                                        
                                                        if (cond_37029 == 1) {
                                                            int8_t comperator_res_t_res_t_res_37031 = sub8(layer_res_37027, x_36980);
                                                            
                                                            comperator_res_t_res_37030 = comperator_res_t_res_t_res_37031;
                                                        } else {
                                                            comperator_res_t_res_37030 = (int8_t) 0;
                                                        }
                                                        comperator_res_37028 = comperator_res_t_res_37030;
                                                    } else {
                                                        bool cond_37032 = ult8(x_36980, layer_res_37027);
                                                        int8_t comperator_res_f_res_37033;
                                                        
                                                        if (cond_37032 == 1) {
                                                            comperator_res_f_res_37033 = layer_res_37027;
                                                        } else {
                                                            comperator_res_f_res_37033 = (int8_t) 0;
                                                        }
                                                        comperator_res_37028 = comperator_res_f_res_37033;
                                                    }
                                                    
                                                    int8_t comperator_res_37034;
                                                    
                                                    if (x_36992 == 1) {
                                                        bool cond_37035 = ult8(layer_res_37027, x_36984);
                                                        int8_t comperator_res_t_res_37036;
                                                        
                                                        if (cond_37035 == 1) {
                                                            int8_t comperator_res_t_res_t_res_37037 = sub8(x_36984, layer_res_37027);
                                                            
                                                            comperator_res_t_res_37036 = comperator_res_t_res_t_res_37037;
                                                        } else {
                                                            comperator_res_t_res_37036 = (int8_t) 0;
                                                        }
                                                        comperator_res_37034 = comperator_res_t_res_37036;
                                                    } else {
                                                        bool cond_37038 = ult8(layer_res_37027, x_36984);
                                                        int8_t comperator_res_f_res_37039;
                                                        
                                                        if (cond_37038 == 1) {
                                                            comperator_res_f_res_37039 = x_36984;
                                                        } else {
                                                            comperator_res_f_res_37039 = (int8_t) 0;
                                                        }
                                                        comperator_res_37034 = comperator_res_f_res_37039;
                                                    }
                                                    
                                                    bool cond_37040 = ult8(comperator_res_37034, comperator_res_37028);
                                                    int8_t layer_res_37041;
                                                    
                                                    if (cond_37040 == 1) {
                                                        layer_res_37041 = comperator_res_37028;
                                                    } else {
                                                        layer_res_37041 = comperator_res_37034;
                                                    }
                                                    
                                                    int8_t comperator_res_37042;
                                                    
                                                    if (x_37004 == 1) {
                                                        bool cond_37043 = ult8(x_36996, layer_res_37041);
                                                        int8_t comperator_res_t_res_37044;
                                                        
                                                        if (cond_37043 == 1) {
                                                            int8_t comperator_res_t_res_t_res_37045 = sub8(layer_res_37041, x_36996);
                                                            
                                                            comperator_res_t_res_37044 = comperator_res_t_res_t_res_37045;
                                                        } else {
                                                            comperator_res_t_res_37044 = (int8_t) 0;
                                                        }
                                                        comperator_res_37042 = comperator_res_t_res_37044;
                                                    } else {
                                                        bool cond_37046 = ult8(x_36996, layer_res_37041);
                                                        int8_t comperator_res_f_res_37047;
                                                        
                                                        if (cond_37046 == 1) {
                                                            comperator_res_f_res_37047 = layer_res_37041;
                                                        } else {
                                                            comperator_res_f_res_37047 = (int8_t) 0;
                                                        }
                                                        comperator_res_37042 = comperator_res_f_res_37047;
                                                    }
                                                    
                                                    int8_t comperator_res_37048;
                                                    
                                                    if (x_37008 == 1) {
                                                        bool cond_37049 = ult8(layer_res_37041, x_37000);
                                                        int8_t comperator_res_t_res_37050;
                                                        
                                                        if (cond_37049 == 1) {
                                                            int8_t comperator_res_t_res_t_res_37051 = sub8(x_37000, layer_res_37041);
                                                            
                                                            comperator_res_t_res_37050 = comperator_res_t_res_t_res_37051;
                                                        } else {
                                                            comperator_res_t_res_37050 = (int8_t) 0;
                                                        }
                                                        comperator_res_37048 = comperator_res_t_res_37050;
                                                    } else {
                                                        bool cond_37052 = ult8(layer_res_37041, x_37000);
                                                        int8_t comperator_res_f_res_37053;
                                                        
                                                        if (cond_37052 == 1) {
                                                            comperator_res_f_res_37053 = x_37000;
                                                        } else {
                                                            comperator_res_f_res_37053 = (int8_t) 0;
                                                        }
                                                        comperator_res_37048 = comperator_res_f_res_37053;
                                                    }
                                                    
                                                    bool cond_37054 = ult8(comperator_res_37048, comperator_res_37042);
                                                    bool eq_x_y_37055 = y_37013 == comperator_res_37042;
                                                    bool eq_x_zz_37056 = y_37013 == comperator_res_37048;
                                                    bool p_and_eq_x_y_37057 = cond_37054 && eq_x_y_37055;
                                                    bool not_p_37058 = !cond_37054;
                                                    bool p_and_eq_x_y_37059 = eq_x_zz_37056 && not_p_37058;
                                                    bool binlam_res_37060 = p_and_eq_x_y_37057 || p_and_eq_x_y_37059;
                                                    bool binlam_res_37061 = binlam_res_37060 && redout_37011;
                                                    bool redout_tmp_37078 = binlam_res_37061;
                                                    
                                                    redout_37011 = redout_tmp_37078;
                                                }
                                                all_equal_37009 = redout_37011;
                                                ((bool *) mem_36875)[i_36974 * (int64_t) 1048576 + i_36978 * (int64_t) 65536 + i_36982 * (int64_t) 4096 + i_36986 * (int64_t) 2048 + i_36990 * (int64_t) 1024 + i_36994 * (int64_t) 64 + i_36998 * (int64_t) 4 + i_37002 * (int64_t) 2 + i_37006] = all_equal_37009;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if ((int64_t) 2097152 > 0)
                memmove(mem_35008.mem + gtid_36873 * (int64_t) 2097152, mem_36875 + (int64_t) 0, (int64_t) 2097152);
        }
    }
    
  cleanup:
    {
        free(mem_36875);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42069_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42069_end - futhark_mc_segmap_parloop_42069_start;
        
        ctx->program->futhark_mc_segmap_parloop_42069_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42069_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42069_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42067(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42066 *futhark_mc_task_42066 = (struct futhark_mc_task_42066 *) args;
    struct futhark_context *ctx = futhark_mc_task_42066->ctx;
    uint64_t futhark_mc_segmap_task_42067_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42067_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42066->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42066->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42066->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42066->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42066->free_x_35007;
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_task_42066->free_mem_35008, .size =0, .references =NULL};
    int32_t nsubtasks_36973;
    
    nsubtasks_36973 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42068 futhark_mc_segmap_parloop_struct_42068_;
    
    futhark_mc_segmap_parloop_struct_42068_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42068_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42068_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42068_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42068_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42068_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42068_.free_mem_35008 = mem_35008.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42069_task;
    
    futhark_mc_segmap_parloop_42069_task.name = "futhark_mc_segmap_parloop_42069";
    futhark_mc_segmap_parloop_42069_task.fn = futhark_mc_segmap_parloop_42069;
    futhark_mc_segmap_parloop_42069_task.args = &futhark_mc_segmap_parloop_struct_42068_;
    futhark_mc_segmap_parloop_42069_task.iterations = iterations;
    futhark_mc_segmap_parloop_42069_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42069_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42069_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42069_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42069_task);
    
    if (futhark_mc_segmap_parloop_42069_err != 0) {
        err = futhark_mc_segmap_parloop_42069_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42069_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42069_total_end - futhark_mc_segmap_parloop_42069_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42069_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42069_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42069_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42067_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42067_end - futhark_mc_segmap_task_42067_start;
        
        ctx->program->futhark_mc_segmap_task_42067_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42067_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42067_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42072 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    unsigned char *free_mem_35008;
};
struct futhark_mc_task_42075 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    unsigned char *free_mem_36100;
};
struct futhark_mc_segmap_parloop_struct_42077 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    unsigned char *free_mem_36100;
};
static int futhark_mc_segmap_parloop_42078(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42077 *futhark_mc_segmap_parloop_struct_42077 = (struct futhark_mc_segmap_parloop_struct_42077 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42077->ctx;
    uint64_t futhark_mc_segmap_parloop_42078_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42078_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42077->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42077->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42077->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42077->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42077->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42077->free_x_36099;
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_segmap_parloop_struct_42077->free_mem_36100, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_37762_cached_sizze_42079 = 0;
    unsigned char *mem_37762 = NULL;
    int64_t flat_tid_37759;
    
    flat_tid_37759 = subtask_id;
    {
        int64_t start_37942;
        int64_t end_37943;
        
        start_37942 = start;
        end_37943 = end;
        
        int64_t n_37944 = end_37943 - start_37942;
        
        if (mem_37762_cached_sizze_42079 < (int64_t) 1048576) {
            err = lexical_realloc(ctx, &mem_37762, &mem_37762_cached_sizze_42079, (int64_t) 1048576);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_37945 = start_37942; SegMap_i_37945 < start_37942 + n_37944; SegMap_i_37945++) {
            int64_t slice_37946 = (int64_t) 2;
            int64_t gtid_37760 = SegMap_i_37945;
            int64_t remnant_37947 = SegMap_i_37945 - gtid_37760;
            bool x_37761 = ((bool *) mem_30513.mem)[gtid_37760];
            
            for (int64_t i_37857 = 0; i_37857 < (int64_t) 16; i_37857++) {
                int8_t x_37859 = ((int8_t *) mem_30515.mem)[i_37857];
                
                for (int64_t i_37861 = 0; i_37861 < (int64_t) 16; i_37861++) {
                    int8_t x_37863 = ((int8_t *) mem_30515.mem)[i_37861];
                    
                    for (int64_t i_37865 = 0; i_37865 < (int64_t) 2; i_37865++) {
                        bool x_37867 = ((bool *) mem_30513.mem)[i_37865];
                        
                        for (int64_t i_37869 = 0; i_37869 < (int64_t) 2; i_37869++) {
                            bool x_37871 = ((bool *) mem_30513.mem)[i_37869];
                            
                            for (int64_t i_37873 = 0; i_37873 < (int64_t) 16; i_37873++) {
                                int8_t x_37875 = ((int8_t *) mem_30515.mem)[i_37873];
                                
                                for (int64_t i_37877 = 0; i_37877 < (int64_t) 16; i_37877++) {
                                    int8_t x_37879 = ((int8_t *) mem_30515.mem)[i_37877];
                                    
                                    for (int64_t i_37881 = 0; i_37881 < (int64_t) 2; i_37881++) {
                                        bool x_37883 = ((bool *) mem_30513.mem)[i_37881];
                                        
                                        for (int64_t i_37885 = 0; i_37885 < (int64_t) 2; i_37885++) {
                                            bool x_37887 = ((bool *) mem_30513.mem)[i_37885];
                                            bool all_equal_37888;
                                            bool redout_37890 = 1;
                                            
                                            for (int64_t i_37889 = 0; i_37889 < (int64_t) 16; i_37889++) {
                                                int8_t x_37891 = ((int8_t *) mem_30515.mem)[i_37889];
                                                int8_t y_37892 = ((int8_t *) mem_30517.mem)[i_37889];
                                                int8_t comperator_res_37893;
                                                
                                                if (x_36099 == 1) {
                                                    bool cond_37894 = ult8(x_27583, x_37891);
                                                    int8_t comperator_res_t_res_37895;
                                                    
                                                    if (cond_37894 == 1) {
                                                        int8_t comperator_res_t_res_t_res_37896 = sub8(x_37891, x_27583);
                                                        
                                                        comperator_res_t_res_37895 = comperator_res_t_res_t_res_37896;
                                                    } else {
                                                        comperator_res_t_res_37895 = (int8_t) 0;
                                                    }
                                                    comperator_res_37893 = comperator_res_t_res_37895;
                                                } else {
                                                    bool cond_37897 = ult8(x_27583, x_37891);
                                                    int8_t comperator_res_f_res_37898;
                                                    
                                                    if (cond_37897 == 1) {
                                                        comperator_res_f_res_37898 = x_37891;
                                                    } else {
                                                        comperator_res_f_res_37898 = (int8_t) 0;
                                                    }
                                                    comperator_res_37893 = comperator_res_f_res_37898;
                                                }
                                                
                                                int8_t comperator_res_37899;
                                                
                                                if (x_37761 == 1) {
                                                    bool cond_37900 = ult8(x_37891, x_35007);
                                                    int8_t comperator_res_t_res_37901;
                                                    
                                                    if (cond_37900 == 1) {
                                                        int8_t comperator_res_t_res_t_res_37902 = sub8(x_35007, x_37891);
                                                        
                                                        comperator_res_t_res_37901 = comperator_res_t_res_t_res_37902;
                                                    } else {
                                                        comperator_res_t_res_37901 = (int8_t) 0;
                                                    }
                                                    comperator_res_37899 = comperator_res_t_res_37901;
                                                } else {
                                                    bool cond_37903 = ult8(x_37891, x_35007);
                                                    int8_t comperator_res_f_res_37904;
                                                    
                                                    if (cond_37903 == 1) {
                                                        comperator_res_f_res_37904 = x_35007;
                                                    } else {
                                                        comperator_res_f_res_37904 = (int8_t) 0;
                                                    }
                                                    comperator_res_37899 = comperator_res_f_res_37904;
                                                }
                                                
                                                bool cond_37905 = ult8(comperator_res_37899, comperator_res_37893);
                                                int8_t layer_res_37906;
                                                
                                                if (cond_37905 == 1) {
                                                    layer_res_37906 = comperator_res_37893;
                                                } else {
                                                    layer_res_37906 = comperator_res_37899;
                                                }
                                                
                                                int8_t comperator_res_37907;
                                                
                                                if (x_37867 == 1) {
                                                    bool cond_37908 = ult8(x_37859, layer_res_37906);
                                                    int8_t comperator_res_t_res_37909;
                                                    
                                                    if (cond_37908 == 1) {
                                                        int8_t comperator_res_t_res_t_res_37910 = sub8(layer_res_37906, x_37859);
                                                        
                                                        comperator_res_t_res_37909 = comperator_res_t_res_t_res_37910;
                                                    } else {
                                                        comperator_res_t_res_37909 = (int8_t) 0;
                                                    }
                                                    comperator_res_37907 = comperator_res_t_res_37909;
                                                } else {
                                                    bool cond_37911 = ult8(x_37859, layer_res_37906);
                                                    int8_t comperator_res_f_res_37912;
                                                    
                                                    if (cond_37911 == 1) {
                                                        comperator_res_f_res_37912 = layer_res_37906;
                                                    } else {
                                                        comperator_res_f_res_37912 = (int8_t) 0;
                                                    }
                                                    comperator_res_37907 = comperator_res_f_res_37912;
                                                }
                                                
                                                int8_t comperator_res_37913;
                                                
                                                if (x_37871 == 1) {
                                                    bool cond_37914 = ult8(layer_res_37906, x_37863);
                                                    int8_t comperator_res_t_res_37915;
                                                    
                                                    if (cond_37914 == 1) {
                                                        int8_t comperator_res_t_res_t_res_37916 = sub8(x_37863, layer_res_37906);
                                                        
                                                        comperator_res_t_res_37915 = comperator_res_t_res_t_res_37916;
                                                    } else {
                                                        comperator_res_t_res_37915 = (int8_t) 0;
                                                    }
                                                    comperator_res_37913 = comperator_res_t_res_37915;
                                                } else {
                                                    bool cond_37917 = ult8(layer_res_37906, x_37863);
                                                    int8_t comperator_res_f_res_37918;
                                                    
                                                    if (cond_37917 == 1) {
                                                        comperator_res_f_res_37918 = x_37863;
                                                    } else {
                                                        comperator_res_f_res_37918 = (int8_t) 0;
                                                    }
                                                    comperator_res_37913 = comperator_res_f_res_37918;
                                                }
                                                
                                                bool cond_37919 = ult8(comperator_res_37913, comperator_res_37907);
                                                int8_t layer_res_37920;
                                                
                                                if (cond_37919 == 1) {
                                                    layer_res_37920 = comperator_res_37907;
                                                } else {
                                                    layer_res_37920 = comperator_res_37913;
                                                }
                                                
                                                int8_t comperator_res_37921;
                                                
                                                if (x_37883 == 1) {
                                                    bool cond_37922 = ult8(x_37875, layer_res_37920);
                                                    int8_t comperator_res_t_res_37923;
                                                    
                                                    if (cond_37922 == 1) {
                                                        int8_t comperator_res_t_res_t_res_37924 = sub8(layer_res_37920, x_37875);
                                                        
                                                        comperator_res_t_res_37923 = comperator_res_t_res_t_res_37924;
                                                    } else {
                                                        comperator_res_t_res_37923 = (int8_t) 0;
                                                    }
                                                    comperator_res_37921 = comperator_res_t_res_37923;
                                                } else {
                                                    bool cond_37925 = ult8(x_37875, layer_res_37920);
                                                    int8_t comperator_res_f_res_37926;
                                                    
                                                    if (cond_37925 == 1) {
                                                        comperator_res_f_res_37926 = layer_res_37920;
                                                    } else {
                                                        comperator_res_f_res_37926 = (int8_t) 0;
                                                    }
                                                    comperator_res_37921 = comperator_res_f_res_37926;
                                                }
                                                
                                                int8_t comperator_res_37927;
                                                
                                                if (x_37887 == 1) {
                                                    bool cond_37928 = ult8(layer_res_37920, x_37879);
                                                    int8_t comperator_res_t_res_37929;
                                                    
                                                    if (cond_37928 == 1) {
                                                        int8_t comperator_res_t_res_t_res_37930 = sub8(x_37879, layer_res_37920);
                                                        
                                                        comperator_res_t_res_37929 = comperator_res_t_res_t_res_37930;
                                                    } else {
                                                        comperator_res_t_res_37929 = (int8_t) 0;
                                                    }
                                                    comperator_res_37927 = comperator_res_t_res_37929;
                                                } else {
                                                    bool cond_37931 = ult8(layer_res_37920, x_37879);
                                                    int8_t comperator_res_f_res_37932;
                                                    
                                                    if (cond_37931 == 1) {
                                                        comperator_res_f_res_37932 = x_37879;
                                                    } else {
                                                        comperator_res_f_res_37932 = (int8_t) 0;
                                                    }
                                                    comperator_res_37927 = comperator_res_f_res_37932;
                                                }
                                                
                                                bool cond_37933 = ult8(comperator_res_37927, comperator_res_37921);
                                                bool eq_x_y_37934 = y_37892 == comperator_res_37921;
                                                bool eq_x_zz_37935 = y_37892 == comperator_res_37927;
                                                bool p_and_eq_x_y_37936 = cond_37933 && eq_x_y_37934;
                                                bool not_p_37937 = !cond_37933;
                                                bool p_and_eq_x_y_37938 = eq_x_zz_37935 && not_p_37937;
                                                bool binlam_res_37939 = p_and_eq_x_y_37936 || p_and_eq_x_y_37938;
                                                bool binlam_res_37940 = binlam_res_37939 && redout_37890;
                                                bool redout_tmp_37956 = binlam_res_37940;
                                                
                                                redout_37890 = redout_tmp_37956;
                                            }
                                            all_equal_37888 = redout_37890;
                                            ((bool *) mem_37762)[i_37857 * (int64_t) 65536 + i_37861 * (int64_t) 4096 + i_37865 * (int64_t) 2048 + i_37869 * (int64_t) 1024 + i_37873 * (int64_t) 64 + i_37877 * (int64_t) 4 + i_37881 * (int64_t) 2 + i_37885] = all_equal_37888;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if ((int64_t) 1048576 > 0)
                memmove(mem_36100.mem + gtid_37760 * (int64_t) 1048576, mem_37762 + (int64_t) 0, (int64_t) 1048576);
        }
    }
    
  cleanup:
    {
        free(mem_37762);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42078_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42078_end - futhark_mc_segmap_parloop_42078_start;
        
        ctx->program->futhark_mc_segmap_parloop_42078_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42078_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42078_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42076(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42075 *futhark_mc_task_42075 = (struct futhark_mc_task_42075 *) args;
    struct futhark_context *ctx = futhark_mc_task_42075->ctx;
    uint64_t futhark_mc_segmap_task_42076_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42076_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42075->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42075->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42075->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42075->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42075->free_x_35007;
    bool x_36099 = futhark_mc_task_42075->free_x_36099;
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_task_42075->free_mem_36100, .size =0, .references =NULL};
    int32_t nsubtasks_37856;
    
    nsubtasks_37856 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42077 futhark_mc_segmap_parloop_struct_42077_;
    
    futhark_mc_segmap_parloop_struct_42077_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42077_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42077_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42077_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42077_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42077_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42077_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42077_.free_mem_36100 = mem_36100.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42078_task;
    
    futhark_mc_segmap_parloop_42078_task.name = "futhark_mc_segmap_parloop_42078";
    futhark_mc_segmap_parloop_42078_task.fn = futhark_mc_segmap_parloop_42078;
    futhark_mc_segmap_parloop_42078_task.args = &futhark_mc_segmap_parloop_struct_42077_;
    futhark_mc_segmap_parloop_42078_task.iterations = iterations;
    futhark_mc_segmap_parloop_42078_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42078_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42078_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42078_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42078_task);
    
    if (futhark_mc_segmap_parloop_42078_err != 0) {
        err = futhark_mc_segmap_parloop_42078_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42078_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42078_total_end - futhark_mc_segmap_parloop_42078_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42078_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42078_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42078_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42076_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42076_end - futhark_mc_segmap_task_42076_start;
        
        ctx->program->futhark_mc_segmap_task_42076_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42076_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42076_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42081 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    unsigned char *free_mem_36100;
};
struct futhark_mc_task_42084 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    unsigned char *free_mem_37083;
};
struct futhark_mc_segmap_parloop_struct_42086 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    unsigned char *free_mem_37083;
};
static int futhark_mc_segmap_parloop_42087(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42086 *futhark_mc_segmap_parloop_struct_42086 = (struct futhark_mc_segmap_parloop_struct_42086 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42086->ctx;
    uint64_t futhark_mc_segmap_parloop_42087_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42087_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42086->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42086->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42086->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42086->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42086->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42086->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42086->free_x_37082;
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_segmap_parloop_struct_42086->free_mem_37083, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_38548_cached_sizze_42088 = 0;
    unsigned char *mem_38548 = NULL;
    int64_t flat_tid_38545;
    
    flat_tid_38545 = subtask_id;
    {
        int64_t start_38720;
        int64_t end_38721;
        
        start_38720 = start;
        end_38721 = end;
        
        int64_t n_38722 = end_38721 - start_38720;
        
        if (mem_38548_cached_sizze_42088 < (int64_t) 65536) {
            err = lexical_realloc(ctx, &mem_38548, &mem_38548_cached_sizze_42088, (int64_t) 65536);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_38723 = start_38720; SegMap_i_38723 < start_38720 + n_38722; SegMap_i_38723++) {
            int64_t slice_38724 = (int64_t) 16;
            int64_t gtid_38546 = SegMap_i_38723;
            int64_t remnant_38725 = SegMap_i_38723 - gtid_38546;
            int8_t x_38547 = ((int8_t *) mem_30515.mem)[gtid_38546];
            
            for (int64_t i_38639 = 0; i_38639 < (int64_t) 16; i_38639++) {
                int8_t x_38641 = ((int8_t *) mem_30515.mem)[i_38639];
                
                for (int64_t i_38643 = 0; i_38643 < (int64_t) 2; i_38643++) {
                    bool x_38645 = ((bool *) mem_30513.mem)[i_38643];
                    
                    for (int64_t i_38647 = 0; i_38647 < (int64_t) 2; i_38647++) {
                        bool x_38649 = ((bool *) mem_30513.mem)[i_38647];
                        
                        for (int64_t i_38651 = 0; i_38651 < (int64_t) 16; i_38651++) {
                            int8_t x_38653 = ((int8_t *) mem_30515.mem)[i_38651];
                            
                            for (int64_t i_38655 = 0; i_38655 < (int64_t) 16; i_38655++) {
                                int8_t x_38657 = ((int8_t *) mem_30515.mem)[i_38655];
                                
                                for (int64_t i_38659 = 0; i_38659 < (int64_t) 2; i_38659++) {
                                    bool x_38661 = ((bool *) mem_30513.mem)[i_38659];
                                    
                                    for (int64_t i_38663 = 0; i_38663 < (int64_t) 2; i_38663++) {
                                        bool x_38665 = ((bool *) mem_30513.mem)[i_38663];
                                        bool all_equal_38666;
                                        bool redout_38668 = 1;
                                        
                                        for (int64_t i_38667 = 0; i_38667 < (int64_t) 16; i_38667++) {
                                            int8_t x_38669 = ((int8_t *) mem_30515.mem)[i_38667];
                                            int8_t y_38670 = ((int8_t *) mem_30517.mem)[i_38667];
                                            int8_t comperator_res_38671;
                                            
                                            if (x_36099 == 1) {
                                                bool cond_38672 = ult8(x_27583, x_38669);
                                                int8_t comperator_res_t_res_38673;
                                                
                                                if (cond_38672 == 1) {
                                                    int8_t comperator_res_t_res_t_res_38674 = sub8(x_38669, x_27583);
                                                    
                                                    comperator_res_t_res_38673 = comperator_res_t_res_t_res_38674;
                                                } else {
                                                    comperator_res_t_res_38673 = (int8_t) 0;
                                                }
                                                comperator_res_38671 = comperator_res_t_res_38673;
                                            } else {
                                                bool cond_38675 = ult8(x_27583, x_38669);
                                                int8_t comperator_res_f_res_38676;
                                                
                                                if (cond_38675 == 1) {
                                                    comperator_res_f_res_38676 = x_38669;
                                                } else {
                                                    comperator_res_f_res_38676 = (int8_t) 0;
                                                }
                                                comperator_res_38671 = comperator_res_f_res_38676;
                                            }
                                            
                                            int8_t comperator_res_38677;
                                            
                                            if (x_37082 == 1) {
                                                bool cond_38678 = ult8(x_38669, x_35007);
                                                int8_t comperator_res_t_res_38679;
                                                
                                                if (cond_38678 == 1) {
                                                    int8_t comperator_res_t_res_t_res_38680 = sub8(x_35007, x_38669);
                                                    
                                                    comperator_res_t_res_38679 = comperator_res_t_res_t_res_38680;
                                                } else {
                                                    comperator_res_t_res_38679 = (int8_t) 0;
                                                }
                                                comperator_res_38677 = comperator_res_t_res_38679;
                                            } else {
                                                bool cond_38681 = ult8(x_38669, x_35007);
                                                int8_t comperator_res_f_res_38682;
                                                
                                                if (cond_38681 == 1) {
                                                    comperator_res_f_res_38682 = x_35007;
                                                } else {
                                                    comperator_res_f_res_38682 = (int8_t) 0;
                                                }
                                                comperator_res_38677 = comperator_res_f_res_38682;
                                            }
                                            
                                            bool cond_38683 = ult8(comperator_res_38677, comperator_res_38671);
                                            int8_t layer_res_38684;
                                            
                                            if (cond_38683 == 1) {
                                                layer_res_38684 = comperator_res_38671;
                                            } else {
                                                layer_res_38684 = comperator_res_38677;
                                            }
                                            
                                            int8_t comperator_res_38685;
                                            
                                            if (x_38645 == 1) {
                                                bool cond_38686 = ult8(x_38547, layer_res_38684);
                                                int8_t comperator_res_t_res_38687;
                                                
                                                if (cond_38686 == 1) {
                                                    int8_t comperator_res_t_res_t_res_38688 = sub8(layer_res_38684, x_38547);
                                                    
                                                    comperator_res_t_res_38687 = comperator_res_t_res_t_res_38688;
                                                } else {
                                                    comperator_res_t_res_38687 = (int8_t) 0;
                                                }
                                                comperator_res_38685 = comperator_res_t_res_38687;
                                            } else {
                                                bool cond_38689 = ult8(x_38547, layer_res_38684);
                                                int8_t comperator_res_f_res_38690;
                                                
                                                if (cond_38689 == 1) {
                                                    comperator_res_f_res_38690 = layer_res_38684;
                                                } else {
                                                    comperator_res_f_res_38690 = (int8_t) 0;
                                                }
                                                comperator_res_38685 = comperator_res_f_res_38690;
                                            }
                                            
                                            int8_t comperator_res_38691;
                                            
                                            if (x_38649 == 1) {
                                                bool cond_38692 = ult8(layer_res_38684, x_38641);
                                                int8_t comperator_res_t_res_38693;
                                                
                                                if (cond_38692 == 1) {
                                                    int8_t comperator_res_t_res_t_res_38694 = sub8(x_38641, layer_res_38684);
                                                    
                                                    comperator_res_t_res_38693 = comperator_res_t_res_t_res_38694;
                                                } else {
                                                    comperator_res_t_res_38693 = (int8_t) 0;
                                                }
                                                comperator_res_38691 = comperator_res_t_res_38693;
                                            } else {
                                                bool cond_38695 = ult8(layer_res_38684, x_38641);
                                                int8_t comperator_res_f_res_38696;
                                                
                                                if (cond_38695 == 1) {
                                                    comperator_res_f_res_38696 = x_38641;
                                                } else {
                                                    comperator_res_f_res_38696 = (int8_t) 0;
                                                }
                                                comperator_res_38691 = comperator_res_f_res_38696;
                                            }
                                            
                                            bool cond_38697 = ult8(comperator_res_38691, comperator_res_38685);
                                            int8_t layer_res_38698;
                                            
                                            if (cond_38697 == 1) {
                                                layer_res_38698 = comperator_res_38685;
                                            } else {
                                                layer_res_38698 = comperator_res_38691;
                                            }
                                            
                                            int8_t comperator_res_38699;
                                            
                                            if (x_38661 == 1) {
                                                bool cond_38700 = ult8(x_38653, layer_res_38698);
                                                int8_t comperator_res_t_res_38701;
                                                
                                                if (cond_38700 == 1) {
                                                    int8_t comperator_res_t_res_t_res_38702 = sub8(layer_res_38698, x_38653);
                                                    
                                                    comperator_res_t_res_38701 = comperator_res_t_res_t_res_38702;
                                                } else {
                                                    comperator_res_t_res_38701 = (int8_t) 0;
                                                }
                                                comperator_res_38699 = comperator_res_t_res_38701;
                                            } else {
                                                bool cond_38703 = ult8(x_38653, layer_res_38698);
                                                int8_t comperator_res_f_res_38704;
                                                
                                                if (cond_38703 == 1) {
                                                    comperator_res_f_res_38704 = layer_res_38698;
                                                } else {
                                                    comperator_res_f_res_38704 = (int8_t) 0;
                                                }
                                                comperator_res_38699 = comperator_res_f_res_38704;
                                            }
                                            
                                            int8_t comperator_res_38705;
                                            
                                            if (x_38665 == 1) {
                                                bool cond_38706 = ult8(layer_res_38698, x_38657);
                                                int8_t comperator_res_t_res_38707;
                                                
                                                if (cond_38706 == 1) {
                                                    int8_t comperator_res_t_res_t_res_38708 = sub8(x_38657, layer_res_38698);
                                                    
                                                    comperator_res_t_res_38707 = comperator_res_t_res_t_res_38708;
                                                } else {
                                                    comperator_res_t_res_38707 = (int8_t) 0;
                                                }
                                                comperator_res_38705 = comperator_res_t_res_38707;
                                            } else {
                                                bool cond_38709 = ult8(layer_res_38698, x_38657);
                                                int8_t comperator_res_f_res_38710;
                                                
                                                if (cond_38709 == 1) {
                                                    comperator_res_f_res_38710 = x_38657;
                                                } else {
                                                    comperator_res_f_res_38710 = (int8_t) 0;
                                                }
                                                comperator_res_38705 = comperator_res_f_res_38710;
                                            }
                                            
                                            bool cond_38711 = ult8(comperator_res_38705, comperator_res_38699);
                                            bool eq_x_y_38712 = y_38670 == comperator_res_38699;
                                            bool eq_x_zz_38713 = y_38670 == comperator_res_38705;
                                            bool p_and_eq_x_y_38714 = cond_38711 && eq_x_y_38712;
                                            bool not_p_38715 = !cond_38711;
                                            bool p_and_eq_x_y_38716 = eq_x_zz_38713 && not_p_38715;
                                            bool binlam_res_38717 = p_and_eq_x_y_38714 || p_and_eq_x_y_38716;
                                            bool binlam_res_38718 = binlam_res_38717 && redout_38668;
                                            bool redout_tmp_38733 = binlam_res_38718;
                                            
                                            redout_38668 = redout_tmp_38733;
                                        }
                                        all_equal_38666 = redout_38668;
                                        ((bool *) mem_38548)[i_38639 * (int64_t) 4096 + i_38643 * (int64_t) 2048 + i_38647 * (int64_t) 1024 + i_38651 * (int64_t) 64 + i_38655 * (int64_t) 4 + i_38659 * (int64_t) 2 + i_38663] = all_equal_38666;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if ((int64_t) 65536 > 0)
                memmove(mem_37083.mem + gtid_38546 * (int64_t) 65536, mem_38548 + (int64_t) 0, (int64_t) 65536);
        }
    }
    
  cleanup:
    {
        free(mem_38548);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42087_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42087_end - futhark_mc_segmap_parloop_42087_start;
        
        ctx->program->futhark_mc_segmap_parloop_42087_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42087_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42087_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42085(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42084 *futhark_mc_task_42084 = (struct futhark_mc_task_42084 *) args;
    struct futhark_context *ctx = futhark_mc_task_42084->ctx;
    uint64_t futhark_mc_segmap_task_42085_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42085_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42084->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42084->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42084->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42084->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42084->free_x_35007;
    bool x_36099 = futhark_mc_task_42084->free_x_36099;
    bool x_37082 = futhark_mc_task_42084->free_x_37082;
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_task_42084->free_mem_37083, .size =0, .references =NULL};
    int32_t nsubtasks_38638;
    
    nsubtasks_38638 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42086 futhark_mc_segmap_parloop_struct_42086_;
    
    futhark_mc_segmap_parloop_struct_42086_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42086_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42086_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42086_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42086_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42086_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42086_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42086_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42086_.free_mem_37083 = mem_37083.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42087_task;
    
    futhark_mc_segmap_parloop_42087_task.name = "futhark_mc_segmap_parloop_42087";
    futhark_mc_segmap_parloop_42087_task.fn = futhark_mc_segmap_parloop_42087;
    futhark_mc_segmap_parloop_42087_task.args = &futhark_mc_segmap_parloop_struct_42086_;
    futhark_mc_segmap_parloop_42087_task.iterations = iterations;
    futhark_mc_segmap_parloop_42087_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42087_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42087_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42087_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42087_task);
    
    if (futhark_mc_segmap_parloop_42087_err != 0) {
        err = futhark_mc_segmap_parloop_42087_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42087_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42087_total_end - futhark_mc_segmap_parloop_42087_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42087_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42087_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42087_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42085_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42085_end - futhark_mc_segmap_task_42085_start;
        
        ctx->program->futhark_mc_segmap_task_42085_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42085_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42085_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42090 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    unsigned char *free_mem_37083;
};
struct futhark_mc_task_42093 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    unsigned char *free_mem_37961;
};
struct futhark_mc_segmap_parloop_struct_42095 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    unsigned char *free_mem_37961;
};
static int futhark_mc_segmap_parloop_42096(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42095 *futhark_mc_segmap_parloop_struct_42095 = (struct futhark_mc_segmap_parloop_struct_42095 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42095->ctx;
    uint64_t futhark_mc_segmap_parloop_42096_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42096_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42095->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42095->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42095->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42095->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42095->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42095->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42095->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42095->free_x_37960;
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_segmap_parloop_struct_42095->free_mem_37961, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_39237_cached_sizze_42097 = 0;
    unsigned char *mem_39237 = NULL;
    int64_t flat_tid_39234;
    
    flat_tid_39234 = subtask_id;
    {
        int64_t start_39401;
        int64_t end_39402;
        
        start_39401 = start;
        end_39402 = end;
        
        int64_t n_39403 = end_39402 - start_39401;
        
        if (mem_39237_cached_sizze_42097 < (int64_t) 4096) {
            err = lexical_realloc(ctx, &mem_39237, &mem_39237_cached_sizze_42097, (int64_t) 4096);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_39404 = start_39401; SegMap_i_39404 < start_39401 + n_39403; SegMap_i_39404++) {
            int64_t slice_39405 = (int64_t) 16;
            int64_t gtid_39235 = SegMap_i_39404;
            int64_t remnant_39406 = SegMap_i_39404 - gtid_39235;
            int8_t x_39236 = ((int8_t *) mem_30515.mem)[gtid_39235];
            
            for (int64_t i_39324 = 0; i_39324 < (int64_t) 2; i_39324++) {
                bool x_39326 = ((bool *) mem_30513.mem)[i_39324];
                
                for (int64_t i_39328 = 0; i_39328 < (int64_t) 2; i_39328++) {
                    bool x_39330 = ((bool *) mem_30513.mem)[i_39328];
                    
                    for (int64_t i_39332 = 0; i_39332 < (int64_t) 16; i_39332++) {
                        int8_t x_39334 = ((int8_t *) mem_30515.mem)[i_39332];
                        
                        for (int64_t i_39336 = 0; i_39336 < (int64_t) 16; i_39336++) {
                            int8_t x_39338 = ((int8_t *) mem_30515.mem)[i_39336];
                            
                            for (int64_t i_39340 = 0; i_39340 < (int64_t) 2; i_39340++) {
                                bool x_39342 = ((bool *) mem_30513.mem)[i_39340];
                                
                                for (int64_t i_39344 = 0; i_39344 < (int64_t) 2; i_39344++) {
                                    bool x_39346 = ((bool *) mem_30513.mem)[i_39344];
                                    bool all_equal_39347;
                                    bool redout_39349 = 1;
                                    
                                    for (int64_t i_39348 = 0; i_39348 < (int64_t) 16; i_39348++) {
                                        int8_t x_39350 = ((int8_t *) mem_30515.mem)[i_39348];
                                        int8_t y_39351 = ((int8_t *) mem_30517.mem)[i_39348];
                                        int8_t comperator_res_39352;
                                        
                                        if (x_36099 == 1) {
                                            bool cond_39353 = ult8(x_27583, x_39350);
                                            int8_t comperator_res_t_res_39354;
                                            
                                            if (cond_39353 == 1) {
                                                int8_t comperator_res_t_res_t_res_39355 = sub8(x_39350, x_27583);
                                                
                                                comperator_res_t_res_39354 = comperator_res_t_res_t_res_39355;
                                            } else {
                                                comperator_res_t_res_39354 = (int8_t) 0;
                                            }
                                            comperator_res_39352 = comperator_res_t_res_39354;
                                        } else {
                                            bool cond_39356 = ult8(x_27583, x_39350);
                                            int8_t comperator_res_f_res_39357;
                                            
                                            if (cond_39356 == 1) {
                                                comperator_res_f_res_39357 = x_39350;
                                            } else {
                                                comperator_res_f_res_39357 = (int8_t) 0;
                                            }
                                            comperator_res_39352 = comperator_res_f_res_39357;
                                        }
                                        
                                        int8_t comperator_res_39358;
                                        
                                        if (x_37082 == 1) {
                                            bool cond_39359 = ult8(x_39350, x_35007);
                                            int8_t comperator_res_t_res_39360;
                                            
                                            if (cond_39359 == 1) {
                                                int8_t comperator_res_t_res_t_res_39361 = sub8(x_35007, x_39350);
                                                
                                                comperator_res_t_res_39360 = comperator_res_t_res_t_res_39361;
                                            } else {
                                                comperator_res_t_res_39360 = (int8_t) 0;
                                            }
                                            comperator_res_39358 = comperator_res_t_res_39360;
                                        } else {
                                            bool cond_39362 = ult8(x_39350, x_35007);
                                            int8_t comperator_res_f_res_39363;
                                            
                                            if (cond_39362 == 1) {
                                                comperator_res_f_res_39363 = x_35007;
                                            } else {
                                                comperator_res_f_res_39363 = (int8_t) 0;
                                            }
                                            comperator_res_39358 = comperator_res_f_res_39363;
                                        }
                                        
                                        bool cond_39364 = ult8(comperator_res_39358, comperator_res_39352);
                                        int8_t layer_res_39365;
                                        
                                        if (cond_39364 == 1) {
                                            layer_res_39365 = comperator_res_39352;
                                        } else {
                                            layer_res_39365 = comperator_res_39358;
                                        }
                                        
                                        int8_t comperator_res_39366;
                                        
                                        if (x_39326 == 1) {
                                            bool cond_39367 = ult8(x_37960, layer_res_39365);
                                            int8_t comperator_res_t_res_39368;
                                            
                                            if (cond_39367 == 1) {
                                                int8_t comperator_res_t_res_t_res_39369 = sub8(layer_res_39365, x_37960);
                                                
                                                comperator_res_t_res_39368 = comperator_res_t_res_t_res_39369;
                                            } else {
                                                comperator_res_t_res_39368 = (int8_t) 0;
                                            }
                                            comperator_res_39366 = comperator_res_t_res_39368;
                                        } else {
                                            bool cond_39370 = ult8(x_37960, layer_res_39365);
                                            int8_t comperator_res_f_res_39371;
                                            
                                            if (cond_39370 == 1) {
                                                comperator_res_f_res_39371 = layer_res_39365;
                                            } else {
                                                comperator_res_f_res_39371 = (int8_t) 0;
                                            }
                                            comperator_res_39366 = comperator_res_f_res_39371;
                                        }
                                        
                                        int8_t comperator_res_39372;
                                        
                                        if (x_39330 == 1) {
                                            bool cond_39373 = ult8(layer_res_39365, x_39236);
                                            int8_t comperator_res_t_res_39374;
                                            
                                            if (cond_39373 == 1) {
                                                int8_t comperator_res_t_res_t_res_39375 = sub8(x_39236, layer_res_39365);
                                                
                                                comperator_res_t_res_39374 = comperator_res_t_res_t_res_39375;
                                            } else {
                                                comperator_res_t_res_39374 = (int8_t) 0;
                                            }
                                            comperator_res_39372 = comperator_res_t_res_39374;
                                        } else {
                                            bool cond_39376 = ult8(layer_res_39365, x_39236);
                                            int8_t comperator_res_f_res_39377;
                                            
                                            if (cond_39376 == 1) {
                                                comperator_res_f_res_39377 = x_39236;
                                            } else {
                                                comperator_res_f_res_39377 = (int8_t) 0;
                                            }
                                            comperator_res_39372 = comperator_res_f_res_39377;
                                        }
                                        
                                        bool cond_39378 = ult8(comperator_res_39372, comperator_res_39366);
                                        int8_t layer_res_39379;
                                        
                                        if (cond_39378 == 1) {
                                            layer_res_39379 = comperator_res_39366;
                                        } else {
                                            layer_res_39379 = comperator_res_39372;
                                        }
                                        
                                        int8_t comperator_res_39380;
                                        
                                        if (x_39342 == 1) {
                                            bool cond_39381 = ult8(x_39334, layer_res_39379);
                                            int8_t comperator_res_t_res_39382;
                                            
                                            if (cond_39381 == 1) {
                                                int8_t comperator_res_t_res_t_res_39383 = sub8(layer_res_39379, x_39334);
                                                
                                                comperator_res_t_res_39382 = comperator_res_t_res_t_res_39383;
                                            } else {
                                                comperator_res_t_res_39382 = (int8_t) 0;
                                            }
                                            comperator_res_39380 = comperator_res_t_res_39382;
                                        } else {
                                            bool cond_39384 = ult8(x_39334, layer_res_39379);
                                            int8_t comperator_res_f_res_39385;
                                            
                                            if (cond_39384 == 1) {
                                                comperator_res_f_res_39385 = layer_res_39379;
                                            } else {
                                                comperator_res_f_res_39385 = (int8_t) 0;
                                            }
                                            comperator_res_39380 = comperator_res_f_res_39385;
                                        }
                                        
                                        int8_t comperator_res_39386;
                                        
                                        if (x_39346 == 1) {
                                            bool cond_39387 = ult8(layer_res_39379, x_39338);
                                            int8_t comperator_res_t_res_39388;
                                            
                                            if (cond_39387 == 1) {
                                                int8_t comperator_res_t_res_t_res_39389 = sub8(x_39338, layer_res_39379);
                                                
                                                comperator_res_t_res_39388 = comperator_res_t_res_t_res_39389;
                                            } else {
                                                comperator_res_t_res_39388 = (int8_t) 0;
                                            }
                                            comperator_res_39386 = comperator_res_t_res_39388;
                                        } else {
                                            bool cond_39390 = ult8(layer_res_39379, x_39338);
                                            int8_t comperator_res_f_res_39391;
                                            
                                            if (cond_39390 == 1) {
                                                comperator_res_f_res_39391 = x_39338;
                                            } else {
                                                comperator_res_f_res_39391 = (int8_t) 0;
                                            }
                                            comperator_res_39386 = comperator_res_f_res_39391;
                                        }
                                        
                                        bool cond_39392 = ult8(comperator_res_39386, comperator_res_39380);
                                        bool eq_x_y_39393 = y_39351 == comperator_res_39380;
                                        bool eq_x_zz_39394 = y_39351 == comperator_res_39386;
                                        bool p_and_eq_x_y_39395 = cond_39392 && eq_x_y_39393;
                                        bool not_p_39396 = !cond_39392;
                                        bool p_and_eq_x_y_39397 = eq_x_zz_39394 && not_p_39396;
                                        bool binlam_res_39398 = p_and_eq_x_y_39395 || p_and_eq_x_y_39397;
                                        bool binlam_res_39399 = binlam_res_39398 && redout_39349;
                                        bool redout_tmp_39413 = binlam_res_39399;
                                        
                                        redout_39349 = redout_tmp_39413;
                                    }
                                    all_equal_39347 = redout_39349;
                                    ((bool *) mem_39237)[i_39324 * (int64_t) 2048 + i_39328 * (int64_t) 1024 + i_39332 * (int64_t) 64 + i_39336 * (int64_t) 4 + i_39340 * (int64_t) 2 + i_39344] = all_equal_39347;
                                }
                            }
                        }
                    }
                }
            }
            if ((int64_t) 4096 > 0)
                memmove(mem_37961.mem + gtid_39235 * (int64_t) 4096, mem_39237 + (int64_t) 0, (int64_t) 4096);
        }
    }
    
  cleanup:
    {
        free(mem_39237);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42096_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42096_end - futhark_mc_segmap_parloop_42096_start;
        
        ctx->program->futhark_mc_segmap_parloop_42096_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42096_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42096_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42094(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42093 *futhark_mc_task_42093 = (struct futhark_mc_task_42093 *) args;
    struct futhark_context *ctx = futhark_mc_task_42093->ctx;
    uint64_t futhark_mc_segmap_task_42094_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42094_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42093->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42093->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42093->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42093->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42093->free_x_35007;
    bool x_36099 = futhark_mc_task_42093->free_x_36099;
    bool x_37082 = futhark_mc_task_42093->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42093->free_x_37960;
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_task_42093->free_mem_37961, .size =0, .references =NULL};
    int32_t nsubtasks_39323;
    
    nsubtasks_39323 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42095 futhark_mc_segmap_parloop_struct_42095_;
    
    futhark_mc_segmap_parloop_struct_42095_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42095_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42095_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42095_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42095_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42095_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42095_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42095_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42095_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42095_.free_mem_37961 = mem_37961.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42096_task;
    
    futhark_mc_segmap_parloop_42096_task.name = "futhark_mc_segmap_parloop_42096";
    futhark_mc_segmap_parloop_42096_task.fn = futhark_mc_segmap_parloop_42096;
    futhark_mc_segmap_parloop_42096_task.args = &futhark_mc_segmap_parloop_struct_42095_;
    futhark_mc_segmap_parloop_42096_task.iterations = iterations;
    futhark_mc_segmap_parloop_42096_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42096_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42096_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42096_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42096_task);
    
    if (futhark_mc_segmap_parloop_42096_err != 0) {
        err = futhark_mc_segmap_parloop_42096_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42096_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42096_total_end - futhark_mc_segmap_parloop_42096_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42096_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42096_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42096_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42094_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42094_end - futhark_mc_segmap_task_42094_start;
        
        ctx->program->futhark_mc_segmap_task_42094_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42094_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42094_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42099 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    unsigned char *free_mem_37961;
};
struct futhark_mc_task_42102 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    unsigned char *free_mem_38738;
};
struct futhark_mc_segmap_parloop_struct_42104 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    unsigned char *free_mem_38738;
};
static int futhark_mc_segmap_parloop_42105(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42104 *futhark_mc_segmap_parloop_struct_42104 = (struct futhark_mc_segmap_parloop_struct_42104 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42104->ctx;
    uint64_t futhark_mc_segmap_parloop_42105_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42105_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42104->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42104->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42104->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42104->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42104->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42104->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42104->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42104->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42104->free_x_38737;
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_segmap_parloop_struct_42104->free_mem_38738, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_39833_cached_sizze_42106 = 0;
    unsigned char *mem_39833 = NULL;
    int64_t flat_tid_39830;
    
    flat_tid_39830 = subtask_id;
    {
        int64_t start_39989;
        int64_t end_39990;
        
        start_39989 = start;
        end_39990 = end;
        
        int64_t n_39991 = end_39990 - start_39989;
        
        if (mem_39833_cached_sizze_42106 < (int64_t) 2048) {
            err = lexical_realloc(ctx, &mem_39833, &mem_39833_cached_sizze_42106, (int64_t) 2048);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_39992 = start_39989; SegMap_i_39992 < start_39989 + n_39991; SegMap_i_39992++) {
            int64_t slice_39993 = (int64_t) 2;
            int64_t gtid_39831 = SegMap_i_39992;
            int64_t remnant_39994 = SegMap_i_39992 - gtid_39831;
            bool x_39832 = ((bool *) mem_30513.mem)[gtid_39831];
            
            for (int64_t i_39916 = 0; i_39916 < (int64_t) 2; i_39916++) {
                bool x_39918 = ((bool *) mem_30513.mem)[i_39916];
                
                for (int64_t i_39920 = 0; i_39920 < (int64_t) 16; i_39920++) {
                    int8_t x_39922 = ((int8_t *) mem_30515.mem)[i_39920];
                    
                    for (int64_t i_39924 = 0; i_39924 < (int64_t) 16; i_39924++) {
                        int8_t x_39926 = ((int8_t *) mem_30515.mem)[i_39924];
                        
                        for (int64_t i_39928 = 0; i_39928 < (int64_t) 2; i_39928++) {
                            bool x_39930 = ((bool *) mem_30513.mem)[i_39928];
                            
                            for (int64_t i_39932 = 0; i_39932 < (int64_t) 2; i_39932++) {
                                bool x_39934 = ((bool *) mem_30513.mem)[i_39932];
                                bool all_equal_39935;
                                bool redout_39937 = 1;
                                
                                for (int64_t i_39936 = 0; i_39936 < (int64_t) 16; i_39936++) {
                                    int8_t x_39938 = ((int8_t *) mem_30515.mem)[i_39936];
                                    int8_t y_39939 = ((int8_t *) mem_30517.mem)[i_39936];
                                    int8_t comperator_res_39940;
                                    
                                    if (x_36099 == 1) {
                                        bool cond_39941 = ult8(x_27583, x_39938);
                                        int8_t comperator_res_t_res_39942;
                                        
                                        if (cond_39941 == 1) {
                                            int8_t comperator_res_t_res_t_res_39943 = sub8(x_39938, x_27583);
                                            
                                            comperator_res_t_res_39942 = comperator_res_t_res_t_res_39943;
                                        } else {
                                            comperator_res_t_res_39942 = (int8_t) 0;
                                        }
                                        comperator_res_39940 = comperator_res_t_res_39942;
                                    } else {
                                        bool cond_39944 = ult8(x_27583, x_39938);
                                        int8_t comperator_res_f_res_39945;
                                        
                                        if (cond_39944 == 1) {
                                            comperator_res_f_res_39945 = x_39938;
                                        } else {
                                            comperator_res_f_res_39945 = (int8_t) 0;
                                        }
                                        comperator_res_39940 = comperator_res_f_res_39945;
                                    }
                                    
                                    int8_t comperator_res_39946;
                                    
                                    if (x_37082 == 1) {
                                        bool cond_39947 = ult8(x_39938, x_35007);
                                        int8_t comperator_res_t_res_39948;
                                        
                                        if (cond_39947 == 1) {
                                            int8_t comperator_res_t_res_t_res_39949 = sub8(x_35007, x_39938);
                                            
                                            comperator_res_t_res_39948 = comperator_res_t_res_t_res_39949;
                                        } else {
                                            comperator_res_t_res_39948 = (int8_t) 0;
                                        }
                                        comperator_res_39946 = comperator_res_t_res_39948;
                                    } else {
                                        bool cond_39950 = ult8(x_39938, x_35007);
                                        int8_t comperator_res_f_res_39951;
                                        
                                        if (cond_39950 == 1) {
                                            comperator_res_f_res_39951 = x_35007;
                                        } else {
                                            comperator_res_f_res_39951 = (int8_t) 0;
                                        }
                                        comperator_res_39946 = comperator_res_f_res_39951;
                                    }
                                    
                                    bool cond_39952 = ult8(comperator_res_39946, comperator_res_39940);
                                    int8_t layer_res_39953;
                                    
                                    if (cond_39952 == 1) {
                                        layer_res_39953 = comperator_res_39940;
                                    } else {
                                        layer_res_39953 = comperator_res_39946;
                                    }
                                    
                                    int8_t comperator_res_39954;
                                    
                                    if (x_39832 == 1) {
                                        bool cond_39955 = ult8(x_37960, layer_res_39953);
                                        int8_t comperator_res_t_res_39956;
                                        
                                        if (cond_39955 == 1) {
                                            int8_t comperator_res_t_res_t_res_39957 = sub8(layer_res_39953, x_37960);
                                            
                                            comperator_res_t_res_39956 = comperator_res_t_res_t_res_39957;
                                        } else {
                                            comperator_res_t_res_39956 = (int8_t) 0;
                                        }
                                        comperator_res_39954 = comperator_res_t_res_39956;
                                    } else {
                                        bool cond_39958 = ult8(x_37960, layer_res_39953);
                                        int8_t comperator_res_f_res_39959;
                                        
                                        if (cond_39958 == 1) {
                                            comperator_res_f_res_39959 = layer_res_39953;
                                        } else {
                                            comperator_res_f_res_39959 = (int8_t) 0;
                                        }
                                        comperator_res_39954 = comperator_res_f_res_39959;
                                    }
                                    
                                    int8_t comperator_res_39960;
                                    
                                    if (x_39918 == 1) {
                                        bool cond_39961 = ult8(layer_res_39953, x_38737);
                                        int8_t comperator_res_t_res_39962;
                                        
                                        if (cond_39961 == 1) {
                                            int8_t comperator_res_t_res_t_res_39963 = sub8(x_38737, layer_res_39953);
                                            
                                            comperator_res_t_res_39962 = comperator_res_t_res_t_res_39963;
                                        } else {
                                            comperator_res_t_res_39962 = (int8_t) 0;
                                        }
                                        comperator_res_39960 = comperator_res_t_res_39962;
                                    } else {
                                        bool cond_39964 = ult8(layer_res_39953, x_38737);
                                        int8_t comperator_res_f_res_39965;
                                        
                                        if (cond_39964 == 1) {
                                            comperator_res_f_res_39965 = x_38737;
                                        } else {
                                            comperator_res_f_res_39965 = (int8_t) 0;
                                        }
                                        comperator_res_39960 = comperator_res_f_res_39965;
                                    }
                                    
                                    bool cond_39966 = ult8(comperator_res_39960, comperator_res_39954);
                                    int8_t layer_res_39967;
                                    
                                    if (cond_39966 == 1) {
                                        layer_res_39967 = comperator_res_39954;
                                    } else {
                                        layer_res_39967 = comperator_res_39960;
                                    }
                                    
                                    int8_t comperator_res_39968;
                                    
                                    if (x_39930 == 1) {
                                        bool cond_39969 = ult8(x_39922, layer_res_39967);
                                        int8_t comperator_res_t_res_39970;
                                        
                                        if (cond_39969 == 1) {
                                            int8_t comperator_res_t_res_t_res_39971 = sub8(layer_res_39967, x_39922);
                                            
                                            comperator_res_t_res_39970 = comperator_res_t_res_t_res_39971;
                                        } else {
                                            comperator_res_t_res_39970 = (int8_t) 0;
                                        }
                                        comperator_res_39968 = comperator_res_t_res_39970;
                                    } else {
                                        bool cond_39972 = ult8(x_39922, layer_res_39967);
                                        int8_t comperator_res_f_res_39973;
                                        
                                        if (cond_39972 == 1) {
                                            comperator_res_f_res_39973 = layer_res_39967;
                                        } else {
                                            comperator_res_f_res_39973 = (int8_t) 0;
                                        }
                                        comperator_res_39968 = comperator_res_f_res_39973;
                                    }
                                    
                                    int8_t comperator_res_39974;
                                    
                                    if (x_39934 == 1) {
                                        bool cond_39975 = ult8(layer_res_39967, x_39926);
                                        int8_t comperator_res_t_res_39976;
                                        
                                        if (cond_39975 == 1) {
                                            int8_t comperator_res_t_res_t_res_39977 = sub8(x_39926, layer_res_39967);
                                            
                                            comperator_res_t_res_39976 = comperator_res_t_res_t_res_39977;
                                        } else {
                                            comperator_res_t_res_39976 = (int8_t) 0;
                                        }
                                        comperator_res_39974 = comperator_res_t_res_39976;
                                    } else {
                                        bool cond_39978 = ult8(layer_res_39967, x_39926);
                                        int8_t comperator_res_f_res_39979;
                                        
                                        if (cond_39978 == 1) {
                                            comperator_res_f_res_39979 = x_39926;
                                        } else {
                                            comperator_res_f_res_39979 = (int8_t) 0;
                                        }
                                        comperator_res_39974 = comperator_res_f_res_39979;
                                    }
                                    
                                    bool cond_39980 = ult8(comperator_res_39974, comperator_res_39968);
                                    bool eq_x_y_39981 = y_39939 == comperator_res_39968;
                                    bool eq_x_zz_39982 = y_39939 == comperator_res_39974;
                                    bool p_and_eq_x_y_39983 = cond_39980 && eq_x_y_39981;
                                    bool not_p_39984 = !cond_39980;
                                    bool p_and_eq_x_y_39985 = eq_x_zz_39982 && not_p_39984;
                                    bool binlam_res_39986 = p_and_eq_x_y_39983 || p_and_eq_x_y_39985;
                                    bool binlam_res_39987 = binlam_res_39986 && redout_39937;
                                    bool redout_tmp_40000 = binlam_res_39987;
                                    
                                    redout_39937 = redout_tmp_40000;
                                }
                                all_equal_39935 = redout_39937;
                                ((bool *) mem_39833)[i_39916 * (int64_t) 1024 + i_39920 * (int64_t) 64 + i_39924 * (int64_t) 4 + i_39928 * (int64_t) 2 + i_39932] = all_equal_39935;
                            }
                        }
                    }
                }
            }
            if ((int64_t) 2048 > 0)
                memmove(mem_38738.mem + gtid_39831 * (int64_t) 2048, mem_39833 + (int64_t) 0, (int64_t) 2048);
        }
    }
    
  cleanup:
    {
        free(mem_39833);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42105_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42105_end - futhark_mc_segmap_parloop_42105_start;
        
        ctx->program->futhark_mc_segmap_parloop_42105_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42105_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42105_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42103(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42102 *futhark_mc_task_42102 = (struct futhark_mc_task_42102 *) args;
    struct futhark_context *ctx = futhark_mc_task_42102->ctx;
    uint64_t futhark_mc_segmap_task_42103_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42103_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42102->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42102->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42102->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42102->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42102->free_x_35007;
    bool x_36099 = futhark_mc_task_42102->free_x_36099;
    bool x_37082 = futhark_mc_task_42102->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42102->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42102->free_x_38737;
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_task_42102->free_mem_38738, .size =0, .references =NULL};
    int32_t nsubtasks_39915;
    
    nsubtasks_39915 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42104 futhark_mc_segmap_parloop_struct_42104_;
    
    futhark_mc_segmap_parloop_struct_42104_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42104_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42104_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42104_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42104_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42104_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42104_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42104_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42104_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42104_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42104_.free_mem_38738 = mem_38738.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42105_task;
    
    futhark_mc_segmap_parloop_42105_task.name = "futhark_mc_segmap_parloop_42105";
    futhark_mc_segmap_parloop_42105_task.fn = futhark_mc_segmap_parloop_42105;
    futhark_mc_segmap_parloop_42105_task.args = &futhark_mc_segmap_parloop_struct_42104_;
    futhark_mc_segmap_parloop_42105_task.iterations = iterations;
    futhark_mc_segmap_parloop_42105_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42105_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42105_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42105_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42105_task);
    
    if (futhark_mc_segmap_parloop_42105_err != 0) {
        err = futhark_mc_segmap_parloop_42105_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42105_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42105_total_end - futhark_mc_segmap_parloop_42105_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42105_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42105_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42105_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42103_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42103_end - futhark_mc_segmap_task_42103_start;
        
        ctx->program->futhark_mc_segmap_task_42103_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42103_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42103_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42108 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    unsigned char *free_mem_38738;
};
struct futhark_mc_task_42111 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    unsigned char *free_mem_39418;
};
struct futhark_mc_segmap_parloop_struct_42113 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    unsigned char *free_mem_39418;
};
static int futhark_mc_segmap_parloop_42114(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42113 *futhark_mc_segmap_parloop_struct_42113 = (struct futhark_mc_segmap_parloop_struct_42113 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42113->ctx;
    uint64_t futhark_mc_segmap_parloop_42114_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42114_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42113->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42113->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42113->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42113->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42113->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42113->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42113->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42113->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42113->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42113->free_x_39417;
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_segmap_parloop_struct_42113->free_mem_39418, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_40340_cached_sizze_42115 = 0;
    unsigned char *mem_40340 = NULL;
    int64_t flat_tid_40337;
    
    flat_tid_40337 = subtask_id;
    {
        int64_t start_40488;
        int64_t end_40489;
        
        start_40488 = start;
        end_40489 = end;
        
        int64_t n_40490 = end_40489 - start_40488;
        
        if (mem_40340_cached_sizze_42115 < (int64_t) 1024) {
            err = lexical_realloc(ctx, &mem_40340, &mem_40340_cached_sizze_42115, (int64_t) 1024);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_40491 = start_40488; SegMap_i_40491 < start_40488 + n_40490; SegMap_i_40491++) {
            int64_t slice_40492 = (int64_t) 2;
            int64_t gtid_40338 = SegMap_i_40491;
            int64_t remnant_40493 = SegMap_i_40491 - gtid_40338;
            bool x_40339 = ((bool *) mem_30513.mem)[gtid_40338];
            
            for (int64_t i_40419 = 0; i_40419 < (int64_t) 16; i_40419++) {
                int8_t x_40421 = ((int8_t *) mem_30515.mem)[i_40419];
                
                for (int64_t i_40423 = 0; i_40423 < (int64_t) 16; i_40423++) {
                    int8_t x_40425 = ((int8_t *) mem_30515.mem)[i_40423];
                    
                    for (int64_t i_40427 = 0; i_40427 < (int64_t) 2; i_40427++) {
                        bool x_40429 = ((bool *) mem_30513.mem)[i_40427];
                        
                        for (int64_t i_40431 = 0; i_40431 < (int64_t) 2; i_40431++) {
                            bool x_40433 = ((bool *) mem_30513.mem)[i_40431];
                            bool all_equal_40434;
                            bool redout_40436 = 1;
                            
                            for (int64_t i_40435 = 0; i_40435 < (int64_t) 16; i_40435++) {
                                int8_t x_40437 = ((int8_t *) mem_30515.mem)[i_40435];
                                int8_t y_40438 = ((int8_t *) mem_30517.mem)[i_40435];
                                int8_t comperator_res_40439;
                                
                                if (x_36099 == 1) {
                                    bool cond_40440 = ult8(x_27583, x_40437);
                                    int8_t comperator_res_t_res_40441;
                                    
                                    if (cond_40440 == 1) {
                                        int8_t comperator_res_t_res_t_res_40442 = sub8(x_40437, x_27583);
                                        
                                        comperator_res_t_res_40441 = comperator_res_t_res_t_res_40442;
                                    } else {
                                        comperator_res_t_res_40441 = (int8_t) 0;
                                    }
                                    comperator_res_40439 = comperator_res_t_res_40441;
                                } else {
                                    bool cond_40443 = ult8(x_27583, x_40437);
                                    int8_t comperator_res_f_res_40444;
                                    
                                    if (cond_40443 == 1) {
                                        comperator_res_f_res_40444 = x_40437;
                                    } else {
                                        comperator_res_f_res_40444 = (int8_t) 0;
                                    }
                                    comperator_res_40439 = comperator_res_f_res_40444;
                                }
                                
                                int8_t comperator_res_40445;
                                
                                if (x_37082 == 1) {
                                    bool cond_40446 = ult8(x_40437, x_35007);
                                    int8_t comperator_res_t_res_40447;
                                    
                                    if (cond_40446 == 1) {
                                        int8_t comperator_res_t_res_t_res_40448 = sub8(x_35007, x_40437);
                                        
                                        comperator_res_t_res_40447 = comperator_res_t_res_t_res_40448;
                                    } else {
                                        comperator_res_t_res_40447 = (int8_t) 0;
                                    }
                                    comperator_res_40445 = comperator_res_t_res_40447;
                                } else {
                                    bool cond_40449 = ult8(x_40437, x_35007);
                                    int8_t comperator_res_f_res_40450;
                                    
                                    if (cond_40449 == 1) {
                                        comperator_res_f_res_40450 = x_35007;
                                    } else {
                                        comperator_res_f_res_40450 = (int8_t) 0;
                                    }
                                    comperator_res_40445 = comperator_res_f_res_40450;
                                }
                                
                                bool cond_40451 = ult8(comperator_res_40445, comperator_res_40439);
                                int8_t layer_res_40452;
                                
                                if (cond_40451 == 1) {
                                    layer_res_40452 = comperator_res_40439;
                                } else {
                                    layer_res_40452 = comperator_res_40445;
                                }
                                
                                int8_t comperator_res_40453;
                                
                                if (x_39417 == 1) {
                                    bool cond_40454 = ult8(x_37960, layer_res_40452);
                                    int8_t comperator_res_t_res_40455;
                                    
                                    if (cond_40454 == 1) {
                                        int8_t comperator_res_t_res_t_res_40456 = sub8(layer_res_40452, x_37960);
                                        
                                        comperator_res_t_res_40455 = comperator_res_t_res_t_res_40456;
                                    } else {
                                        comperator_res_t_res_40455 = (int8_t) 0;
                                    }
                                    comperator_res_40453 = comperator_res_t_res_40455;
                                } else {
                                    bool cond_40457 = ult8(x_37960, layer_res_40452);
                                    int8_t comperator_res_f_res_40458;
                                    
                                    if (cond_40457 == 1) {
                                        comperator_res_f_res_40458 = layer_res_40452;
                                    } else {
                                        comperator_res_f_res_40458 = (int8_t) 0;
                                    }
                                    comperator_res_40453 = comperator_res_f_res_40458;
                                }
                                
                                int8_t comperator_res_40459;
                                
                                if (x_40339 == 1) {
                                    bool cond_40460 = ult8(layer_res_40452, x_38737);
                                    int8_t comperator_res_t_res_40461;
                                    
                                    if (cond_40460 == 1) {
                                        int8_t comperator_res_t_res_t_res_40462 = sub8(x_38737, layer_res_40452);
                                        
                                        comperator_res_t_res_40461 = comperator_res_t_res_t_res_40462;
                                    } else {
                                        comperator_res_t_res_40461 = (int8_t) 0;
                                    }
                                    comperator_res_40459 = comperator_res_t_res_40461;
                                } else {
                                    bool cond_40463 = ult8(layer_res_40452, x_38737);
                                    int8_t comperator_res_f_res_40464;
                                    
                                    if (cond_40463 == 1) {
                                        comperator_res_f_res_40464 = x_38737;
                                    } else {
                                        comperator_res_f_res_40464 = (int8_t) 0;
                                    }
                                    comperator_res_40459 = comperator_res_f_res_40464;
                                }
                                
                                bool cond_40465 = ult8(comperator_res_40459, comperator_res_40453);
                                int8_t layer_res_40466;
                                
                                if (cond_40465 == 1) {
                                    layer_res_40466 = comperator_res_40453;
                                } else {
                                    layer_res_40466 = comperator_res_40459;
                                }
                                
                                int8_t comperator_res_40467;
                                
                                if (x_40429 == 1) {
                                    bool cond_40468 = ult8(x_40421, layer_res_40466);
                                    int8_t comperator_res_t_res_40469;
                                    
                                    if (cond_40468 == 1) {
                                        int8_t comperator_res_t_res_t_res_40470 = sub8(layer_res_40466, x_40421);
                                        
                                        comperator_res_t_res_40469 = comperator_res_t_res_t_res_40470;
                                    } else {
                                        comperator_res_t_res_40469 = (int8_t) 0;
                                    }
                                    comperator_res_40467 = comperator_res_t_res_40469;
                                } else {
                                    bool cond_40471 = ult8(x_40421, layer_res_40466);
                                    int8_t comperator_res_f_res_40472;
                                    
                                    if (cond_40471 == 1) {
                                        comperator_res_f_res_40472 = layer_res_40466;
                                    } else {
                                        comperator_res_f_res_40472 = (int8_t) 0;
                                    }
                                    comperator_res_40467 = comperator_res_f_res_40472;
                                }
                                
                                int8_t comperator_res_40473;
                                
                                if (x_40433 == 1) {
                                    bool cond_40474 = ult8(layer_res_40466, x_40425);
                                    int8_t comperator_res_t_res_40475;
                                    
                                    if (cond_40474 == 1) {
                                        int8_t comperator_res_t_res_t_res_40476 = sub8(x_40425, layer_res_40466);
                                        
                                        comperator_res_t_res_40475 = comperator_res_t_res_t_res_40476;
                                    } else {
                                        comperator_res_t_res_40475 = (int8_t) 0;
                                    }
                                    comperator_res_40473 = comperator_res_t_res_40475;
                                } else {
                                    bool cond_40477 = ult8(layer_res_40466, x_40425);
                                    int8_t comperator_res_f_res_40478;
                                    
                                    if (cond_40477 == 1) {
                                        comperator_res_f_res_40478 = x_40425;
                                    } else {
                                        comperator_res_f_res_40478 = (int8_t) 0;
                                    }
                                    comperator_res_40473 = comperator_res_f_res_40478;
                                }
                                
                                bool cond_40479 = ult8(comperator_res_40473, comperator_res_40467);
                                bool eq_x_y_40480 = y_40438 == comperator_res_40467;
                                bool eq_x_zz_40481 = y_40438 == comperator_res_40473;
                                bool p_and_eq_x_y_40482 = cond_40479 && eq_x_y_40480;
                                bool not_p_40483 = !cond_40479;
                                bool p_and_eq_x_y_40484 = eq_x_zz_40481 && not_p_40483;
                                bool binlam_res_40485 = p_and_eq_x_y_40482 || p_and_eq_x_y_40484;
                                bool binlam_res_40486 = binlam_res_40485 && redout_40436;
                                bool redout_tmp_40498 = binlam_res_40486;
                                
                                redout_40436 = redout_tmp_40498;
                            }
                            all_equal_40434 = redout_40436;
                            ((bool *) mem_40340)[i_40419 * (int64_t) 64 + i_40423 * (int64_t) 4 + i_40427 * (int64_t) 2 + i_40431] = all_equal_40434;
                        }
                    }
                }
            }
            if ((int64_t) 1024 > 0)
                memmove(mem_39418.mem + gtid_40338 * (int64_t) 1024, mem_40340 + (int64_t) 0, (int64_t) 1024);
        }
    }
    
  cleanup:
    {
        free(mem_40340);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42114_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42114_end - futhark_mc_segmap_parloop_42114_start;
        
        ctx->program->futhark_mc_segmap_parloop_42114_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42114_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42114_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42112(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42111 *futhark_mc_task_42111 = (struct futhark_mc_task_42111 *) args;
    struct futhark_context *ctx = futhark_mc_task_42111->ctx;
    uint64_t futhark_mc_segmap_task_42112_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42112_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42111->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42111->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42111->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42111->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42111->free_x_35007;
    bool x_36099 = futhark_mc_task_42111->free_x_36099;
    bool x_37082 = futhark_mc_task_42111->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42111->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42111->free_x_38737;
    bool x_39417 = futhark_mc_task_42111->free_x_39417;
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_task_42111->free_mem_39418, .size =0, .references =NULL};
    int32_t nsubtasks_40418;
    
    nsubtasks_40418 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42113 futhark_mc_segmap_parloop_struct_42113_;
    
    futhark_mc_segmap_parloop_struct_42113_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42113_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42113_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42113_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42113_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42113_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42113_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42113_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42113_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42113_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42113_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42113_.free_mem_39418 = mem_39418.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42114_task;
    
    futhark_mc_segmap_parloop_42114_task.name = "futhark_mc_segmap_parloop_42114";
    futhark_mc_segmap_parloop_42114_task.fn = futhark_mc_segmap_parloop_42114;
    futhark_mc_segmap_parloop_42114_task.args = &futhark_mc_segmap_parloop_struct_42113_;
    futhark_mc_segmap_parloop_42114_task.iterations = iterations;
    futhark_mc_segmap_parloop_42114_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42114_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42114_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42114_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42114_task);
    
    if (futhark_mc_segmap_parloop_42114_err != 0) {
        err = futhark_mc_segmap_parloop_42114_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42114_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42114_total_end - futhark_mc_segmap_parloop_42114_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42114_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42114_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42114_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42112_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42112_end - futhark_mc_segmap_task_42112_start;
        
        ctx->program->futhark_mc_segmap_task_42112_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42112_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42112_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42117 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    unsigned char *free_mem_39418;
};
struct futhark_mc_task_42120 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    unsigned char *free_mem_40005;
};
struct futhark_mc_segmap_parloop_struct_42122 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    unsigned char *free_mem_40005;
};
static int futhark_mc_segmap_parloop_42123(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42122 *futhark_mc_segmap_parloop_struct_42122 = (struct futhark_mc_segmap_parloop_struct_42122 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42122->ctx;
    uint64_t futhark_mc_segmap_parloop_42123_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42123_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42122->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42122->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42122->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42122->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42122->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42122->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42122->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42122->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42122->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42122->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42122->free_x_40004;
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_segmap_parloop_struct_42122->free_mem_40005, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_40762_cached_sizze_42124 = 0;
    unsigned char *mem_40762 = NULL;
    int64_t flat_tid_40759;
    
    flat_tid_40759 = subtask_id;
    {
        int64_t start_40902;
        int64_t end_40903;
        
        start_40902 = start;
        end_40903 = end;
        
        int64_t n_40904 = end_40903 - start_40902;
        
        if (mem_40762_cached_sizze_42124 < (int64_t) 64) {
            err = lexical_realloc(ctx, &mem_40762, &mem_40762_cached_sizze_42124, (int64_t) 64);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_40905 = start_40902; SegMap_i_40905 < start_40902 + n_40904; SegMap_i_40905++) {
            int64_t slice_40906 = (int64_t) 16;
            int64_t gtid_40760 = SegMap_i_40905;
            int64_t remnant_40907 = SegMap_i_40905 - gtid_40760;
            int8_t x_40761 = ((int8_t *) mem_30515.mem)[gtid_40760];
            
            for (int64_t i_40837 = 0; i_40837 < (int64_t) 16; i_40837++) {
                int8_t x_40839 = ((int8_t *) mem_30515.mem)[i_40837];
                
                for (int64_t i_40841 = 0; i_40841 < (int64_t) 2; i_40841++) {
                    bool x_40843 = ((bool *) mem_30513.mem)[i_40841];
                    
                    for (int64_t i_40845 = 0; i_40845 < (int64_t) 2; i_40845++) {
                        bool x_40847 = ((bool *) mem_30513.mem)[i_40845];
                        bool all_equal_40848;
                        bool redout_40850 = 1;
                        
                        for (int64_t i_40849 = 0; i_40849 < (int64_t) 16; i_40849++) {
                            int8_t x_40851 = ((int8_t *) mem_30515.mem)[i_40849];
                            int8_t y_40852 = ((int8_t *) mem_30517.mem)[i_40849];
                            int8_t comperator_res_40853;
                            
                            if (x_36099 == 1) {
                                bool cond_40854 = ult8(x_27583, x_40851);
                                int8_t comperator_res_t_res_40855;
                                
                                if (cond_40854 == 1) {
                                    int8_t comperator_res_t_res_t_res_40856 = sub8(x_40851, x_27583);
                                    
                                    comperator_res_t_res_40855 = comperator_res_t_res_t_res_40856;
                                } else {
                                    comperator_res_t_res_40855 = (int8_t) 0;
                                }
                                comperator_res_40853 = comperator_res_t_res_40855;
                            } else {
                                bool cond_40857 = ult8(x_27583, x_40851);
                                int8_t comperator_res_f_res_40858;
                                
                                if (cond_40857 == 1) {
                                    comperator_res_f_res_40858 = x_40851;
                                } else {
                                    comperator_res_f_res_40858 = (int8_t) 0;
                                }
                                comperator_res_40853 = comperator_res_f_res_40858;
                            }
                            
                            int8_t comperator_res_40859;
                            
                            if (x_37082 == 1) {
                                bool cond_40860 = ult8(x_40851, x_35007);
                                int8_t comperator_res_t_res_40861;
                                
                                if (cond_40860 == 1) {
                                    int8_t comperator_res_t_res_t_res_40862 = sub8(x_35007, x_40851);
                                    
                                    comperator_res_t_res_40861 = comperator_res_t_res_t_res_40862;
                                } else {
                                    comperator_res_t_res_40861 = (int8_t) 0;
                                }
                                comperator_res_40859 = comperator_res_t_res_40861;
                            } else {
                                bool cond_40863 = ult8(x_40851, x_35007);
                                int8_t comperator_res_f_res_40864;
                                
                                if (cond_40863 == 1) {
                                    comperator_res_f_res_40864 = x_35007;
                                } else {
                                    comperator_res_f_res_40864 = (int8_t) 0;
                                }
                                comperator_res_40859 = comperator_res_f_res_40864;
                            }
                            
                            bool cond_40865 = ult8(comperator_res_40859, comperator_res_40853);
                            int8_t layer_res_40866;
                            
                            if (cond_40865 == 1) {
                                layer_res_40866 = comperator_res_40853;
                            } else {
                                layer_res_40866 = comperator_res_40859;
                            }
                            
                            int8_t comperator_res_40867;
                            
                            if (x_39417 == 1) {
                                bool cond_40868 = ult8(x_37960, layer_res_40866);
                                int8_t comperator_res_t_res_40869;
                                
                                if (cond_40868 == 1) {
                                    int8_t comperator_res_t_res_t_res_40870 = sub8(layer_res_40866, x_37960);
                                    
                                    comperator_res_t_res_40869 = comperator_res_t_res_t_res_40870;
                                } else {
                                    comperator_res_t_res_40869 = (int8_t) 0;
                                }
                                comperator_res_40867 = comperator_res_t_res_40869;
                            } else {
                                bool cond_40871 = ult8(x_37960, layer_res_40866);
                                int8_t comperator_res_f_res_40872;
                                
                                if (cond_40871 == 1) {
                                    comperator_res_f_res_40872 = layer_res_40866;
                                } else {
                                    comperator_res_f_res_40872 = (int8_t) 0;
                                }
                                comperator_res_40867 = comperator_res_f_res_40872;
                            }
                            
                            int8_t comperator_res_40873;
                            
                            if (x_40004 == 1) {
                                bool cond_40874 = ult8(layer_res_40866, x_38737);
                                int8_t comperator_res_t_res_40875;
                                
                                if (cond_40874 == 1) {
                                    int8_t comperator_res_t_res_t_res_40876 = sub8(x_38737, layer_res_40866);
                                    
                                    comperator_res_t_res_40875 = comperator_res_t_res_t_res_40876;
                                } else {
                                    comperator_res_t_res_40875 = (int8_t) 0;
                                }
                                comperator_res_40873 = comperator_res_t_res_40875;
                            } else {
                                bool cond_40877 = ult8(layer_res_40866, x_38737);
                                int8_t comperator_res_f_res_40878;
                                
                                if (cond_40877 == 1) {
                                    comperator_res_f_res_40878 = x_38737;
                                } else {
                                    comperator_res_f_res_40878 = (int8_t) 0;
                                }
                                comperator_res_40873 = comperator_res_f_res_40878;
                            }
                            
                            bool cond_40879 = ult8(comperator_res_40873, comperator_res_40867);
                            int8_t layer_res_40880;
                            
                            if (cond_40879 == 1) {
                                layer_res_40880 = comperator_res_40867;
                            } else {
                                layer_res_40880 = comperator_res_40873;
                            }
                            
                            int8_t comperator_res_40881;
                            
                            if (x_40843 == 1) {
                                bool cond_40882 = ult8(x_40761, layer_res_40880);
                                int8_t comperator_res_t_res_40883;
                                
                                if (cond_40882 == 1) {
                                    int8_t comperator_res_t_res_t_res_40884 = sub8(layer_res_40880, x_40761);
                                    
                                    comperator_res_t_res_40883 = comperator_res_t_res_t_res_40884;
                                } else {
                                    comperator_res_t_res_40883 = (int8_t) 0;
                                }
                                comperator_res_40881 = comperator_res_t_res_40883;
                            } else {
                                bool cond_40885 = ult8(x_40761, layer_res_40880);
                                int8_t comperator_res_f_res_40886;
                                
                                if (cond_40885 == 1) {
                                    comperator_res_f_res_40886 = layer_res_40880;
                                } else {
                                    comperator_res_f_res_40886 = (int8_t) 0;
                                }
                                comperator_res_40881 = comperator_res_f_res_40886;
                            }
                            
                            int8_t comperator_res_40887;
                            
                            if (x_40847 == 1) {
                                bool cond_40888 = ult8(layer_res_40880, x_40839);
                                int8_t comperator_res_t_res_40889;
                                
                                if (cond_40888 == 1) {
                                    int8_t comperator_res_t_res_t_res_40890 = sub8(x_40839, layer_res_40880);
                                    
                                    comperator_res_t_res_40889 = comperator_res_t_res_t_res_40890;
                                } else {
                                    comperator_res_t_res_40889 = (int8_t) 0;
                                }
                                comperator_res_40887 = comperator_res_t_res_40889;
                            } else {
                                bool cond_40891 = ult8(layer_res_40880, x_40839);
                                int8_t comperator_res_f_res_40892;
                                
                                if (cond_40891 == 1) {
                                    comperator_res_f_res_40892 = x_40839;
                                } else {
                                    comperator_res_f_res_40892 = (int8_t) 0;
                                }
                                comperator_res_40887 = comperator_res_f_res_40892;
                            }
                            
                            bool cond_40893 = ult8(comperator_res_40887, comperator_res_40881);
                            bool eq_x_y_40894 = y_40852 == comperator_res_40881;
                            bool eq_x_zz_40895 = y_40852 == comperator_res_40887;
                            bool p_and_eq_x_y_40896 = cond_40893 && eq_x_y_40894;
                            bool not_p_40897 = !cond_40893;
                            bool p_and_eq_x_y_40898 = eq_x_zz_40895 && not_p_40897;
                            bool binlam_res_40899 = p_and_eq_x_y_40896 || p_and_eq_x_y_40898;
                            bool binlam_res_40900 = binlam_res_40899 && redout_40850;
                            bool redout_tmp_40911 = binlam_res_40900;
                            
                            redout_40850 = redout_tmp_40911;
                        }
                        all_equal_40848 = redout_40850;
                        ((bool *) mem_40762)[i_40837 * (int64_t) 4 + i_40841 * (int64_t) 2 + i_40845] = all_equal_40848;
                    }
                }
            }
            if ((int64_t) 64 > 0)
                memmove(mem_40005.mem + gtid_40760 * (int64_t) 64, mem_40762 + (int64_t) 0, (int64_t) 64);
        }
    }
    
  cleanup:
    {
        free(mem_40762);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42123_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42123_end - futhark_mc_segmap_parloop_42123_start;
        
        ctx->program->futhark_mc_segmap_parloop_42123_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42123_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42123_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42121(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42120 *futhark_mc_task_42120 = (struct futhark_mc_task_42120 *) args;
    struct futhark_context *ctx = futhark_mc_task_42120->ctx;
    uint64_t futhark_mc_segmap_task_42121_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42121_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42120->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42120->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42120->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42120->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42120->free_x_35007;
    bool x_36099 = futhark_mc_task_42120->free_x_36099;
    bool x_37082 = futhark_mc_task_42120->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42120->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42120->free_x_38737;
    bool x_39417 = futhark_mc_task_42120->free_x_39417;
    bool x_40004 = futhark_mc_task_42120->free_x_40004;
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_task_42120->free_mem_40005, .size =0, .references =NULL};
    int32_t nsubtasks_40836;
    
    nsubtasks_40836 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42122 futhark_mc_segmap_parloop_struct_42122_;
    
    futhark_mc_segmap_parloop_struct_42122_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42122_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42122_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42122_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42122_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42122_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42122_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42122_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42122_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42122_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42122_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42122_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42122_.free_mem_40005 = mem_40005.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42123_task;
    
    futhark_mc_segmap_parloop_42123_task.name = "futhark_mc_segmap_parloop_42123";
    futhark_mc_segmap_parloop_42123_task.fn = futhark_mc_segmap_parloop_42123;
    futhark_mc_segmap_parloop_42123_task.args = &futhark_mc_segmap_parloop_struct_42122_;
    futhark_mc_segmap_parloop_42123_task.iterations = iterations;
    futhark_mc_segmap_parloop_42123_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42123_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42123_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42123_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42123_task);
    
    if (futhark_mc_segmap_parloop_42123_err != 0) {
        err = futhark_mc_segmap_parloop_42123_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42123_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42123_total_end - futhark_mc_segmap_parloop_42123_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42123_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42123_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42123_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42121_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42121_end - futhark_mc_segmap_task_42121_start;
        
        ctx->program->futhark_mc_segmap_task_42121_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42121_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42121_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42126 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    unsigned char *free_mem_40005;
};
struct futhark_mc_task_42129 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    unsigned char *free_mem_40503;
};
struct futhark_mc_segmap_parloop_struct_42131 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    unsigned char *free_mem_40503;
};
static int futhark_mc_segmap_parloop_42132(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42131 *futhark_mc_segmap_parloop_struct_42131 = (struct futhark_mc_segmap_parloop_struct_42131 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42131->ctx;
    uint64_t futhark_mc_segmap_parloop_42132_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42132_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42131->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42131->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42131->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42131->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42131->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42131->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42131->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42131->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42131->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42131->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42131->free_x_40004;
    int8_t x_40502 = futhark_mc_segmap_parloop_struct_42131->free_x_40502;
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_segmap_parloop_struct_42131->free_mem_40503, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_41103_cached_sizze_42133 = 0;
    unsigned char *mem_41103 = NULL;
    int64_t flat_tid_41100;
    
    flat_tid_41100 = subtask_id;
    {
        int64_t start_41235;
        int64_t end_41236;
        
        start_41235 = start;
        end_41236 = end;
        
        int64_t n_41237 = end_41236 - start_41235;
        
        if (mem_41103_cached_sizze_42133 < (int64_t) 4) {
            err = lexical_realloc(ctx, &mem_41103, &mem_41103_cached_sizze_42133, (int64_t) 4);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_41238 = start_41235; SegMap_i_41238 < start_41235 + n_41237; SegMap_i_41238++) {
            int64_t slice_41239 = (int64_t) 16;
            int64_t gtid_41101 = SegMap_i_41238;
            int64_t remnant_41240 = SegMap_i_41238 - gtid_41101;
            int8_t x_41102 = ((int8_t *) mem_30515.mem)[gtid_41101];
            
            for (int64_t i_41174 = 0; i_41174 < (int64_t) 2; i_41174++) {
                bool x_41176 = ((bool *) mem_30513.mem)[i_41174];
                
                for (int64_t i_41178 = 0; i_41178 < (int64_t) 2; i_41178++) {
                    bool x_41180 = ((bool *) mem_30513.mem)[i_41178];
                    bool all_equal_41181;
                    bool redout_41183 = 1;
                    
                    for (int64_t i_41182 = 0; i_41182 < (int64_t) 16; i_41182++) {
                        int8_t x_41184 = ((int8_t *) mem_30515.mem)[i_41182];
                        int8_t y_41185 = ((int8_t *) mem_30517.mem)[i_41182];
                        int8_t comperator_res_41186;
                        
                        if (x_36099 == 1) {
                            bool cond_41187 = ult8(x_27583, x_41184);
                            int8_t comperator_res_t_res_41188;
                            
                            if (cond_41187 == 1) {
                                int8_t comperator_res_t_res_t_res_41189 = sub8(x_41184, x_27583);
                                
                                comperator_res_t_res_41188 = comperator_res_t_res_t_res_41189;
                            } else {
                                comperator_res_t_res_41188 = (int8_t) 0;
                            }
                            comperator_res_41186 = comperator_res_t_res_41188;
                        } else {
                            bool cond_41190 = ult8(x_27583, x_41184);
                            int8_t comperator_res_f_res_41191;
                            
                            if (cond_41190 == 1) {
                                comperator_res_f_res_41191 = x_41184;
                            } else {
                                comperator_res_f_res_41191 = (int8_t) 0;
                            }
                            comperator_res_41186 = comperator_res_f_res_41191;
                        }
                        
                        int8_t comperator_res_41192;
                        
                        if (x_37082 == 1) {
                            bool cond_41193 = ult8(x_41184, x_35007);
                            int8_t comperator_res_t_res_41194;
                            
                            if (cond_41193 == 1) {
                                int8_t comperator_res_t_res_t_res_41195 = sub8(x_35007, x_41184);
                                
                                comperator_res_t_res_41194 = comperator_res_t_res_t_res_41195;
                            } else {
                                comperator_res_t_res_41194 = (int8_t) 0;
                            }
                            comperator_res_41192 = comperator_res_t_res_41194;
                        } else {
                            bool cond_41196 = ult8(x_41184, x_35007);
                            int8_t comperator_res_f_res_41197;
                            
                            if (cond_41196 == 1) {
                                comperator_res_f_res_41197 = x_35007;
                            } else {
                                comperator_res_f_res_41197 = (int8_t) 0;
                            }
                            comperator_res_41192 = comperator_res_f_res_41197;
                        }
                        
                        bool cond_41198 = ult8(comperator_res_41192, comperator_res_41186);
                        int8_t layer_res_41199;
                        
                        if (cond_41198 == 1) {
                            layer_res_41199 = comperator_res_41186;
                        } else {
                            layer_res_41199 = comperator_res_41192;
                        }
                        
                        int8_t comperator_res_41200;
                        
                        if (x_39417 == 1) {
                            bool cond_41201 = ult8(x_37960, layer_res_41199);
                            int8_t comperator_res_t_res_41202;
                            
                            if (cond_41201 == 1) {
                                int8_t comperator_res_t_res_t_res_41203 = sub8(layer_res_41199, x_37960);
                                
                                comperator_res_t_res_41202 = comperator_res_t_res_t_res_41203;
                            } else {
                                comperator_res_t_res_41202 = (int8_t) 0;
                            }
                            comperator_res_41200 = comperator_res_t_res_41202;
                        } else {
                            bool cond_41204 = ult8(x_37960, layer_res_41199);
                            int8_t comperator_res_f_res_41205;
                            
                            if (cond_41204 == 1) {
                                comperator_res_f_res_41205 = layer_res_41199;
                            } else {
                                comperator_res_f_res_41205 = (int8_t) 0;
                            }
                            comperator_res_41200 = comperator_res_f_res_41205;
                        }
                        
                        int8_t comperator_res_41206;
                        
                        if (x_40004 == 1) {
                            bool cond_41207 = ult8(layer_res_41199, x_38737);
                            int8_t comperator_res_t_res_41208;
                            
                            if (cond_41207 == 1) {
                                int8_t comperator_res_t_res_t_res_41209 = sub8(x_38737, layer_res_41199);
                                
                                comperator_res_t_res_41208 = comperator_res_t_res_t_res_41209;
                            } else {
                                comperator_res_t_res_41208 = (int8_t) 0;
                            }
                            comperator_res_41206 = comperator_res_t_res_41208;
                        } else {
                            bool cond_41210 = ult8(layer_res_41199, x_38737);
                            int8_t comperator_res_f_res_41211;
                            
                            if (cond_41210 == 1) {
                                comperator_res_f_res_41211 = x_38737;
                            } else {
                                comperator_res_f_res_41211 = (int8_t) 0;
                            }
                            comperator_res_41206 = comperator_res_f_res_41211;
                        }
                        
                        bool cond_41212 = ult8(comperator_res_41206, comperator_res_41200);
                        int8_t layer_res_41213;
                        
                        if (cond_41212 == 1) {
                            layer_res_41213 = comperator_res_41200;
                        } else {
                            layer_res_41213 = comperator_res_41206;
                        }
                        
                        int8_t comperator_res_41214;
                        
                        if (x_41176 == 1) {
                            bool cond_41215 = ult8(x_40502, layer_res_41213);
                            int8_t comperator_res_t_res_41216;
                            
                            if (cond_41215 == 1) {
                                int8_t comperator_res_t_res_t_res_41217 = sub8(layer_res_41213, x_40502);
                                
                                comperator_res_t_res_41216 = comperator_res_t_res_t_res_41217;
                            } else {
                                comperator_res_t_res_41216 = (int8_t) 0;
                            }
                            comperator_res_41214 = comperator_res_t_res_41216;
                        } else {
                            bool cond_41218 = ult8(x_40502, layer_res_41213);
                            int8_t comperator_res_f_res_41219;
                            
                            if (cond_41218 == 1) {
                                comperator_res_f_res_41219 = layer_res_41213;
                            } else {
                                comperator_res_f_res_41219 = (int8_t) 0;
                            }
                            comperator_res_41214 = comperator_res_f_res_41219;
                        }
                        
                        int8_t comperator_res_41220;
                        
                        if (x_41180 == 1) {
                            bool cond_41221 = ult8(layer_res_41213, x_41102);
                            int8_t comperator_res_t_res_41222;
                            
                            if (cond_41221 == 1) {
                                int8_t comperator_res_t_res_t_res_41223 = sub8(x_41102, layer_res_41213);
                                
                                comperator_res_t_res_41222 = comperator_res_t_res_t_res_41223;
                            } else {
                                comperator_res_t_res_41222 = (int8_t) 0;
                            }
                            comperator_res_41220 = comperator_res_t_res_41222;
                        } else {
                            bool cond_41224 = ult8(layer_res_41213, x_41102);
                            int8_t comperator_res_f_res_41225;
                            
                            if (cond_41224 == 1) {
                                comperator_res_f_res_41225 = x_41102;
                            } else {
                                comperator_res_f_res_41225 = (int8_t) 0;
                            }
                            comperator_res_41220 = comperator_res_f_res_41225;
                        }
                        
                        bool cond_41226 = ult8(comperator_res_41220, comperator_res_41214);
                        bool eq_x_y_41227 = y_41185 == comperator_res_41214;
                        bool eq_x_zz_41228 = y_41185 == comperator_res_41220;
                        bool p_and_eq_x_y_41229 = cond_41226 && eq_x_y_41227;
                        bool not_p_41230 = !cond_41226;
                        bool p_and_eq_x_y_41231 = eq_x_zz_41228 && not_p_41230;
                        bool binlam_res_41232 = p_and_eq_x_y_41229 || p_and_eq_x_y_41231;
                        bool binlam_res_41233 = binlam_res_41232 && redout_41183;
                        bool redout_tmp_41243 = binlam_res_41233;
                        
                        redout_41183 = redout_tmp_41243;
                    }
                    all_equal_41181 = redout_41183;
                    ((bool *) mem_41103)[i_41174 * (int64_t) 2 + i_41178] = all_equal_41181;
                }
            }
            if ((int64_t) 4 > 0)
                memmove(mem_40503.mem + gtid_41101 * (int64_t) 4, mem_41103 + (int64_t) 0, (int64_t) 4);
        }
    }
    
  cleanup:
    {
        free(mem_41103);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42132_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42132_end - futhark_mc_segmap_parloop_42132_start;
        
        ctx->program->futhark_mc_segmap_parloop_42132_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42132_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42132_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42130(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42129 *futhark_mc_task_42129 = (struct futhark_mc_task_42129 *) args;
    struct futhark_context *ctx = futhark_mc_task_42129->ctx;
    uint64_t futhark_mc_segmap_task_42130_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42130_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42129->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42129->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42129->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42129->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42129->free_x_35007;
    bool x_36099 = futhark_mc_task_42129->free_x_36099;
    bool x_37082 = futhark_mc_task_42129->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42129->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42129->free_x_38737;
    bool x_39417 = futhark_mc_task_42129->free_x_39417;
    bool x_40004 = futhark_mc_task_42129->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42129->free_x_40502;
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_task_42129->free_mem_40503, .size =0, .references =NULL};
    int32_t nsubtasks_41173;
    
    nsubtasks_41173 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42131 futhark_mc_segmap_parloop_struct_42131_;
    
    futhark_mc_segmap_parloop_struct_42131_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42131_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42131_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42131_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42131_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42131_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42131_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42131_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42131_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42131_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42131_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42131_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42131_.free_x_40502 = x_40502;
    futhark_mc_segmap_parloop_struct_42131_.free_mem_40503 = mem_40503.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42132_task;
    
    futhark_mc_segmap_parloop_42132_task.name = "futhark_mc_segmap_parloop_42132";
    futhark_mc_segmap_parloop_42132_task.fn = futhark_mc_segmap_parloop_42132;
    futhark_mc_segmap_parloop_42132_task.args = &futhark_mc_segmap_parloop_struct_42131_;
    futhark_mc_segmap_parloop_42132_task.iterations = iterations;
    futhark_mc_segmap_parloop_42132_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42132_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42132_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42132_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42132_task);
    
    if (futhark_mc_segmap_parloop_42132_err != 0) {
        err = futhark_mc_segmap_parloop_42132_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42132_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42132_total_end - futhark_mc_segmap_parloop_42132_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42132_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42132_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42132_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42130_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42130_end - futhark_mc_segmap_task_42130_start;
        
        ctx->program->futhark_mc_segmap_task_42130_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42130_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42130_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42135 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    unsigned char *free_mem_40503;
};
struct futhark_mc_task_42138 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    unsigned char *free_mem_40916;
};
struct futhark_mc_segmap_parloop_struct_42140 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    unsigned char *free_mem_40916;
};
static int futhark_mc_segmap_parloop_42141(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42140 *futhark_mc_segmap_parloop_struct_42140 = (struct futhark_mc_segmap_parloop_struct_42140 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42140->ctx;
    uint64_t futhark_mc_segmap_parloop_42141_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42141_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42140->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42140->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42140->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42140->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42140->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42140->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42140->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42140->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42140->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42140->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42140->free_x_40004;
    int8_t x_40502 = futhark_mc_segmap_parloop_struct_42140->free_x_40502;
    int8_t x_40915 = futhark_mc_segmap_parloop_struct_42140->free_x_40915;
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_segmap_parloop_struct_42140->free_mem_40916, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_41367_cached_sizze_42142 = 0;
    unsigned char *mem_41367 = NULL;
    int64_t flat_tid_41364;
    
    flat_tid_41364 = subtask_id;
    {
        int64_t start_41491;
        int64_t end_41492;
        
        start_41491 = start;
        end_41492 = end;
        
        int64_t n_41493 = end_41492 - start_41491;
        
        if (mem_41367_cached_sizze_42142 < (int64_t) 2) {
            err = lexical_realloc(ctx, &mem_41367, &mem_41367_cached_sizze_42142, (int64_t) 2);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_41494 = start_41491; SegMap_i_41494 < start_41491 + n_41493; SegMap_i_41494++) {
            int64_t slice_41495 = (int64_t) 2;
            int64_t gtid_41365 = SegMap_i_41494;
            int64_t remnant_41496 = SegMap_i_41494 - gtid_41365;
            bool x_41366 = ((bool *) mem_30513.mem)[gtid_41365];
            
            for (int64_t i_41434 = 0; i_41434 < (int64_t) 2; i_41434++) {
                bool x_41436 = ((bool *) mem_30513.mem)[i_41434];
                bool all_equal_41437;
                bool redout_41439 = 1;
                
                for (int64_t i_41438 = 0; i_41438 < (int64_t) 16; i_41438++) {
                    int8_t x_41440 = ((int8_t *) mem_30515.mem)[i_41438];
                    int8_t y_41441 = ((int8_t *) mem_30517.mem)[i_41438];
                    int8_t comperator_res_41442;
                    
                    if (x_36099 == 1) {
                        bool cond_41443 = ult8(x_27583, x_41440);
                        int8_t comperator_res_t_res_41444;
                        
                        if (cond_41443 == 1) {
                            int8_t comperator_res_t_res_t_res_41445 = sub8(x_41440, x_27583);
                            
                            comperator_res_t_res_41444 = comperator_res_t_res_t_res_41445;
                        } else {
                            comperator_res_t_res_41444 = (int8_t) 0;
                        }
                        comperator_res_41442 = comperator_res_t_res_41444;
                    } else {
                        bool cond_41446 = ult8(x_27583, x_41440);
                        int8_t comperator_res_f_res_41447;
                        
                        if (cond_41446 == 1) {
                            comperator_res_f_res_41447 = x_41440;
                        } else {
                            comperator_res_f_res_41447 = (int8_t) 0;
                        }
                        comperator_res_41442 = comperator_res_f_res_41447;
                    }
                    
                    int8_t comperator_res_41448;
                    
                    if (x_37082 == 1) {
                        bool cond_41449 = ult8(x_41440, x_35007);
                        int8_t comperator_res_t_res_41450;
                        
                        if (cond_41449 == 1) {
                            int8_t comperator_res_t_res_t_res_41451 = sub8(x_35007, x_41440);
                            
                            comperator_res_t_res_41450 = comperator_res_t_res_t_res_41451;
                        } else {
                            comperator_res_t_res_41450 = (int8_t) 0;
                        }
                        comperator_res_41448 = comperator_res_t_res_41450;
                    } else {
                        bool cond_41452 = ult8(x_41440, x_35007);
                        int8_t comperator_res_f_res_41453;
                        
                        if (cond_41452 == 1) {
                            comperator_res_f_res_41453 = x_35007;
                        } else {
                            comperator_res_f_res_41453 = (int8_t) 0;
                        }
                        comperator_res_41448 = comperator_res_f_res_41453;
                    }
                    
                    bool cond_41454 = ult8(comperator_res_41448, comperator_res_41442);
                    int8_t layer_res_41455;
                    
                    if (cond_41454 == 1) {
                        layer_res_41455 = comperator_res_41442;
                    } else {
                        layer_res_41455 = comperator_res_41448;
                    }
                    
                    int8_t comperator_res_41456;
                    
                    if (x_39417 == 1) {
                        bool cond_41457 = ult8(x_37960, layer_res_41455);
                        int8_t comperator_res_t_res_41458;
                        
                        if (cond_41457 == 1) {
                            int8_t comperator_res_t_res_t_res_41459 = sub8(layer_res_41455, x_37960);
                            
                            comperator_res_t_res_41458 = comperator_res_t_res_t_res_41459;
                        } else {
                            comperator_res_t_res_41458 = (int8_t) 0;
                        }
                        comperator_res_41456 = comperator_res_t_res_41458;
                    } else {
                        bool cond_41460 = ult8(x_37960, layer_res_41455);
                        int8_t comperator_res_f_res_41461;
                        
                        if (cond_41460 == 1) {
                            comperator_res_f_res_41461 = layer_res_41455;
                        } else {
                            comperator_res_f_res_41461 = (int8_t) 0;
                        }
                        comperator_res_41456 = comperator_res_f_res_41461;
                    }
                    
                    int8_t comperator_res_41462;
                    
                    if (x_40004 == 1) {
                        bool cond_41463 = ult8(layer_res_41455, x_38737);
                        int8_t comperator_res_t_res_41464;
                        
                        if (cond_41463 == 1) {
                            int8_t comperator_res_t_res_t_res_41465 = sub8(x_38737, layer_res_41455);
                            
                            comperator_res_t_res_41464 = comperator_res_t_res_t_res_41465;
                        } else {
                            comperator_res_t_res_41464 = (int8_t) 0;
                        }
                        comperator_res_41462 = comperator_res_t_res_41464;
                    } else {
                        bool cond_41466 = ult8(layer_res_41455, x_38737);
                        int8_t comperator_res_f_res_41467;
                        
                        if (cond_41466 == 1) {
                            comperator_res_f_res_41467 = x_38737;
                        } else {
                            comperator_res_f_res_41467 = (int8_t) 0;
                        }
                        comperator_res_41462 = comperator_res_f_res_41467;
                    }
                    
                    bool cond_41468 = ult8(comperator_res_41462, comperator_res_41456);
                    int8_t layer_res_41469;
                    
                    if (cond_41468 == 1) {
                        layer_res_41469 = comperator_res_41456;
                    } else {
                        layer_res_41469 = comperator_res_41462;
                    }
                    
                    int8_t comperator_res_41470;
                    
                    if (x_41366 == 1) {
                        bool cond_41471 = ult8(x_40502, layer_res_41469);
                        int8_t comperator_res_t_res_41472;
                        
                        if (cond_41471 == 1) {
                            int8_t comperator_res_t_res_t_res_41473 = sub8(layer_res_41469, x_40502);
                            
                            comperator_res_t_res_41472 = comperator_res_t_res_t_res_41473;
                        } else {
                            comperator_res_t_res_41472 = (int8_t) 0;
                        }
                        comperator_res_41470 = comperator_res_t_res_41472;
                    } else {
                        bool cond_41474 = ult8(x_40502, layer_res_41469);
                        int8_t comperator_res_f_res_41475;
                        
                        if (cond_41474 == 1) {
                            comperator_res_f_res_41475 = layer_res_41469;
                        } else {
                            comperator_res_f_res_41475 = (int8_t) 0;
                        }
                        comperator_res_41470 = comperator_res_f_res_41475;
                    }
                    
                    int8_t comperator_res_41476;
                    
                    if (x_41436 == 1) {
                        bool cond_41477 = ult8(layer_res_41469, x_40915);
                        int8_t comperator_res_t_res_41478;
                        
                        if (cond_41477 == 1) {
                            int8_t comperator_res_t_res_t_res_41479 = sub8(x_40915, layer_res_41469);
                            
                            comperator_res_t_res_41478 = comperator_res_t_res_t_res_41479;
                        } else {
                            comperator_res_t_res_41478 = (int8_t) 0;
                        }
                        comperator_res_41476 = comperator_res_t_res_41478;
                    } else {
                        bool cond_41480 = ult8(layer_res_41469, x_40915);
                        int8_t comperator_res_f_res_41481;
                        
                        if (cond_41480 == 1) {
                            comperator_res_f_res_41481 = x_40915;
                        } else {
                            comperator_res_f_res_41481 = (int8_t) 0;
                        }
                        comperator_res_41476 = comperator_res_f_res_41481;
                    }
                    
                    bool cond_41482 = ult8(comperator_res_41476, comperator_res_41470);
                    bool eq_x_y_41483 = y_41441 == comperator_res_41470;
                    bool eq_x_zz_41484 = y_41441 == comperator_res_41476;
                    bool p_and_eq_x_y_41485 = cond_41482 && eq_x_y_41483;
                    bool not_p_41486 = !cond_41482;
                    bool p_and_eq_x_y_41487 = eq_x_zz_41484 && not_p_41486;
                    bool binlam_res_41488 = p_and_eq_x_y_41485 || p_and_eq_x_y_41487;
                    bool binlam_res_41489 = binlam_res_41488 && redout_41439;
                    bool redout_tmp_41498 = binlam_res_41489;
                    
                    redout_41439 = redout_tmp_41498;
                }
                all_equal_41437 = redout_41439;
                ((bool *) mem_41367)[i_41434] = all_equal_41437;
            }
            if ((int64_t) 2 > 0)
                memmove(mem_40916.mem + gtid_41365 * (int64_t) 2, mem_41367 + (int64_t) 0, (int64_t) 2);
        }
    }
    
  cleanup:
    {
        free(mem_41367);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42141_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42141_end - futhark_mc_segmap_parloop_42141_start;
        
        ctx->program->futhark_mc_segmap_parloop_42141_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42141_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42141_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42139(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42138 *futhark_mc_task_42138 = (struct futhark_mc_task_42138 *) args;
    struct futhark_context *ctx = futhark_mc_task_42138->ctx;
    uint64_t futhark_mc_segmap_task_42139_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42139_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42138->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42138->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42138->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42138->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42138->free_x_35007;
    bool x_36099 = futhark_mc_task_42138->free_x_36099;
    bool x_37082 = futhark_mc_task_42138->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42138->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42138->free_x_38737;
    bool x_39417 = futhark_mc_task_42138->free_x_39417;
    bool x_40004 = futhark_mc_task_42138->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42138->free_x_40502;
    int8_t x_40915 = futhark_mc_task_42138->free_x_40915;
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_task_42138->free_mem_40916, .size =0, .references =NULL};
    int32_t nsubtasks_41433;
    
    nsubtasks_41433 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42140 futhark_mc_segmap_parloop_struct_42140_;
    
    futhark_mc_segmap_parloop_struct_42140_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42140_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42140_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42140_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42140_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42140_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42140_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42140_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42140_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42140_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42140_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42140_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42140_.free_x_40502 = x_40502;
    futhark_mc_segmap_parloop_struct_42140_.free_x_40915 = x_40915;
    futhark_mc_segmap_parloop_struct_42140_.free_mem_40916 = mem_40916.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42141_task;
    
    futhark_mc_segmap_parloop_42141_task.name = "futhark_mc_segmap_parloop_42141";
    futhark_mc_segmap_parloop_42141_task.fn = futhark_mc_segmap_parloop_42141;
    futhark_mc_segmap_parloop_42141_task.args = &futhark_mc_segmap_parloop_struct_42140_;
    futhark_mc_segmap_parloop_42141_task.iterations = iterations;
    futhark_mc_segmap_parloop_42141_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42141_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42141_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42141_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42141_task);
    
    if (futhark_mc_segmap_parloop_42141_err != 0) {
        err = futhark_mc_segmap_parloop_42141_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42141_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42141_total_end - futhark_mc_segmap_parloop_42141_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42141_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42141_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42141_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42139_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42139_end - futhark_mc_segmap_task_42139_start;
        
        ctx->program->futhark_mc_segmap_task_42139_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42139_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42139_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42144 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    unsigned char *free_mem_40916;
};
struct futhark_mc_task_42147 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    bool free_x_41247;
    unsigned char *free_mem_41248;
};
struct futhark_mc_segmap_parloop_struct_42149 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    bool free_x_41247;
    unsigned char *free_mem_41248;
};
static int futhark_mc_segmap_parloop_42150(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42149 *futhark_mc_segmap_parloop_struct_42149 = (struct futhark_mc_segmap_parloop_struct_42149 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42149->ctx;
    uint64_t futhark_mc_segmap_parloop_42150_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42150_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42149->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42149->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42149->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42149->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42149->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42149->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42149->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42149->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42149->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42149->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42149->free_x_40004;
    int8_t x_40502 = futhark_mc_segmap_parloop_struct_42149->free_x_40502;
    int8_t x_40915 = futhark_mc_segmap_parloop_struct_42149->free_x_40915;
    bool x_41247 = futhark_mc_segmap_parloop_struct_42149->free_x_41247;
    struct memblock mem_41248 = {.desc ="mem_41248", .mem =futhark_mc_segmap_parloop_struct_42149->free_mem_41248, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t flat_tid_41558;
    
    flat_tid_41558 = subtask_id;
    {
        int64_t start_41673;
        int64_t end_41674;
        
        start_41673 = start;
        end_41674 = end;
        
        int64_t n_41675 = end_41674 - start_41673;
        
        for (int64_t SegMap_i_41676 = start_41673; SegMap_i_41676 < start_41673 + n_41675; SegMap_i_41676++) {
            int64_t slice_41677 = (int64_t) 2;
            int64_t gtid_41559 = SegMap_i_41676;
            int64_t remnant_41678 = SegMap_i_41676 - gtid_41559;
            bool x_41560 = ((bool *) mem_30513.mem)[gtid_41559];
            bool all_equal_41561;
            bool redout_41622 = 1;
            
            for (int64_t i_41621 = 0; i_41621 < (int64_t) 16; i_41621++) {
                int8_t x_41623 = ((int8_t *) mem_30515.mem)[i_41621];
                int8_t y_41624 = ((int8_t *) mem_30517.mem)[i_41621];
                int8_t comperator_res_41625;
                
                if (x_36099 == 1) {
                    bool cond_41626 = ult8(x_27583, x_41623);
                    int8_t comperator_res_t_res_41627;
                    
                    if (cond_41626 == 1) {
                        int8_t comperator_res_t_res_t_res_41628 = sub8(x_41623, x_27583);
                        
                        comperator_res_t_res_41627 = comperator_res_t_res_t_res_41628;
                    } else {
                        comperator_res_t_res_41627 = (int8_t) 0;
                    }
                    comperator_res_41625 = comperator_res_t_res_41627;
                } else {
                    bool cond_41629 = ult8(x_27583, x_41623);
                    int8_t comperator_res_f_res_41630;
                    
                    if (cond_41629 == 1) {
                        comperator_res_f_res_41630 = x_41623;
                    } else {
                        comperator_res_f_res_41630 = (int8_t) 0;
                    }
                    comperator_res_41625 = comperator_res_f_res_41630;
                }
                
                int8_t comperator_res_41631;
                
                if (x_37082 == 1) {
                    bool cond_41632 = ult8(x_41623, x_35007);
                    int8_t comperator_res_t_res_41633;
                    
                    if (cond_41632 == 1) {
                        int8_t comperator_res_t_res_t_res_41634 = sub8(x_35007, x_41623);
                        
                        comperator_res_t_res_41633 = comperator_res_t_res_t_res_41634;
                    } else {
                        comperator_res_t_res_41633 = (int8_t) 0;
                    }
                    comperator_res_41631 = comperator_res_t_res_41633;
                } else {
                    bool cond_41635 = ult8(x_41623, x_35007);
                    int8_t comperator_res_f_res_41636;
                    
                    if (cond_41635 == 1) {
                        comperator_res_f_res_41636 = x_35007;
                    } else {
                        comperator_res_f_res_41636 = (int8_t) 0;
                    }
                    comperator_res_41631 = comperator_res_f_res_41636;
                }
                
                bool cond_41637 = ult8(comperator_res_41631, comperator_res_41625);
                int8_t layer_res_41638;
                
                if (cond_41637 == 1) {
                    layer_res_41638 = comperator_res_41625;
                } else {
                    layer_res_41638 = comperator_res_41631;
                }
                
                int8_t comperator_res_41639;
                
                if (x_39417 == 1) {
                    bool cond_41640 = ult8(x_37960, layer_res_41638);
                    int8_t comperator_res_t_res_41641;
                    
                    if (cond_41640 == 1) {
                        int8_t comperator_res_t_res_t_res_41642 = sub8(layer_res_41638, x_37960);
                        
                        comperator_res_t_res_41641 = comperator_res_t_res_t_res_41642;
                    } else {
                        comperator_res_t_res_41641 = (int8_t) 0;
                    }
                    comperator_res_41639 = comperator_res_t_res_41641;
                } else {
                    bool cond_41643 = ult8(x_37960, layer_res_41638);
                    int8_t comperator_res_f_res_41644;
                    
                    if (cond_41643 == 1) {
                        comperator_res_f_res_41644 = layer_res_41638;
                    } else {
                        comperator_res_f_res_41644 = (int8_t) 0;
                    }
                    comperator_res_41639 = comperator_res_f_res_41644;
                }
                
                int8_t comperator_res_41645;
                
                if (x_40004 == 1) {
                    bool cond_41646 = ult8(layer_res_41638, x_38737);
                    int8_t comperator_res_t_res_41647;
                    
                    if (cond_41646 == 1) {
                        int8_t comperator_res_t_res_t_res_41648 = sub8(x_38737, layer_res_41638);
                        
                        comperator_res_t_res_41647 = comperator_res_t_res_t_res_41648;
                    } else {
                        comperator_res_t_res_41647 = (int8_t) 0;
                    }
                    comperator_res_41645 = comperator_res_t_res_41647;
                } else {
                    bool cond_41649 = ult8(layer_res_41638, x_38737);
                    int8_t comperator_res_f_res_41650;
                    
                    if (cond_41649 == 1) {
                        comperator_res_f_res_41650 = x_38737;
                    } else {
                        comperator_res_f_res_41650 = (int8_t) 0;
                    }
                    comperator_res_41645 = comperator_res_f_res_41650;
                }
                
                bool cond_41651 = ult8(comperator_res_41645, comperator_res_41639);
                int8_t layer_res_41652;
                
                if (cond_41651 == 1) {
                    layer_res_41652 = comperator_res_41639;
                } else {
                    layer_res_41652 = comperator_res_41645;
                }
                
                int8_t comperator_res_41653;
                
                if (x_41247 == 1) {
                    bool cond_41654 = ult8(x_40502, layer_res_41652);
                    int8_t comperator_res_t_res_41655;
                    
                    if (cond_41654 == 1) {
                        int8_t comperator_res_t_res_t_res_41656 = sub8(layer_res_41652, x_40502);
                        
                        comperator_res_t_res_41655 = comperator_res_t_res_t_res_41656;
                    } else {
                        comperator_res_t_res_41655 = (int8_t) 0;
                    }
                    comperator_res_41653 = comperator_res_t_res_41655;
                } else {
                    bool cond_41657 = ult8(x_40502, layer_res_41652);
                    int8_t comperator_res_f_res_41658;
                    
                    if (cond_41657 == 1) {
                        comperator_res_f_res_41658 = layer_res_41652;
                    } else {
                        comperator_res_f_res_41658 = (int8_t) 0;
                    }
                    comperator_res_41653 = comperator_res_f_res_41658;
                }
                
                int8_t comperator_res_41659;
                
                if (x_41560 == 1) {
                    bool cond_41660 = ult8(layer_res_41652, x_40915);
                    int8_t comperator_res_t_res_41661;
                    
                    if (cond_41660 == 1) {
                        int8_t comperator_res_t_res_t_res_41662 = sub8(x_40915, layer_res_41652);
                        
                        comperator_res_t_res_41661 = comperator_res_t_res_t_res_41662;
                    } else {
                        comperator_res_t_res_41661 = (int8_t) 0;
                    }
                    comperator_res_41659 = comperator_res_t_res_41661;
                } else {
                    bool cond_41663 = ult8(layer_res_41652, x_40915);
                    int8_t comperator_res_f_res_41664;
                    
                    if (cond_41663 == 1) {
                        comperator_res_f_res_41664 = x_40915;
                    } else {
                        comperator_res_f_res_41664 = (int8_t) 0;
                    }
                    comperator_res_41659 = comperator_res_f_res_41664;
                }
                
                bool cond_41665 = ult8(comperator_res_41659, comperator_res_41653);
                bool eq_x_y_41666 = y_41624 == comperator_res_41653;
                bool eq_x_zz_41667 = y_41624 == comperator_res_41659;
                bool p_and_eq_x_y_41668 = cond_41665 && eq_x_y_41666;
                bool not_p_41669 = !cond_41665;
                bool p_and_eq_x_y_41670 = eq_x_zz_41667 && not_p_41669;
                bool binlam_res_41671 = p_and_eq_x_y_41668 || p_and_eq_x_y_41670;
                bool binlam_res_41672 = binlam_res_41671 && redout_41622;
                bool redout_tmp_41679 = binlam_res_41672;
                
                redout_41622 = redout_tmp_41679;
            }
            all_equal_41561 = redout_41622;
            ((bool *) mem_41248.mem)[gtid_41559] = all_equal_41561;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42150_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42150_end - futhark_mc_segmap_parloop_42150_start;
        
        ctx->program->futhark_mc_segmap_parloop_42150_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42150_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42150_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_task_42148(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42147 *futhark_mc_task_42147 = (struct futhark_mc_task_42147 *) args;
    struct futhark_context *ctx = futhark_mc_task_42147->ctx;
    uint64_t futhark_mc_segmap_task_42148_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_task_42148_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42147->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42147->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42147->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42147->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42147->free_x_35007;
    bool x_36099 = futhark_mc_task_42147->free_x_36099;
    bool x_37082 = futhark_mc_task_42147->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42147->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42147->free_x_38737;
    bool x_39417 = futhark_mc_task_42147->free_x_39417;
    bool x_40004 = futhark_mc_task_42147->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42147->free_x_40502;
    int8_t x_40915 = futhark_mc_task_42147->free_x_40915;
    bool x_41247 = futhark_mc_task_42147->free_x_41247;
    struct memblock mem_41248 = {.desc ="mem_41248", .mem =futhark_mc_task_42147->free_mem_41248, .size =0, .references =NULL};
    int32_t nsubtasks_41620;
    
    nsubtasks_41620 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42149 futhark_mc_segmap_parloop_struct_42149_;
    
    futhark_mc_segmap_parloop_struct_42149_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42149_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42149_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42149_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42149_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42149_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42149_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42149_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42149_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42149_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42149_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42149_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42149_.free_x_40502 = x_40502;
    futhark_mc_segmap_parloop_struct_42149_.free_x_40915 = x_40915;
    futhark_mc_segmap_parloop_struct_42149_.free_x_41247 = x_41247;
    futhark_mc_segmap_parloop_struct_42149_.free_mem_41248 = mem_41248.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42150_task;
    
    futhark_mc_segmap_parloop_42150_task.name = "futhark_mc_segmap_parloop_42150";
    futhark_mc_segmap_parloop_42150_task.fn = futhark_mc_segmap_parloop_42150;
    futhark_mc_segmap_parloop_42150_task.args = &futhark_mc_segmap_parloop_struct_42149_;
    futhark_mc_segmap_parloop_42150_task.iterations = iterations;
    futhark_mc_segmap_parloop_42150_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42150_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42150_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42150_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42150_task);
    
    if (futhark_mc_segmap_parloop_42150_err != 0) {
        err = futhark_mc_segmap_parloop_42150_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42150_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42150_total_end - futhark_mc_segmap_parloop_42150_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42150_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42150_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42150_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_task_42148_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_task_42148_end - futhark_mc_segmap_task_42148_start;
        
        ctx->program->futhark_mc_segmap_task_42148_runs[tid]++;
        ctx->program->futhark_mc_segmap_task_42148_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_task_42148_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_segmap_parloop_struct_42152 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30513;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    bool free_x_41247;
    unsigned char *free_mem_41248;
};
struct futhark_mc_task_42154 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    bool free_x_41247;
    bool free_x_41502;
    int64_t free_flat_tid_41681;
    bool *retval_all_equal_41503;
};
struct futhark_mc_segred_stage_1_parloop_struct_42157 {
    struct futhark_context *ctx;
    int8_t free_x_27583;
    unsigned char *free_mem_30515;
    unsigned char *free_mem_30517;
    int8_t free_x_35007;
    bool free_x_36099;
    bool free_x_37082;
    int8_t free_x_37960;
    int8_t free_x_38737;
    bool free_x_39417;
    bool free_x_40004;
    int8_t free_x_40502;
    int8_t free_x_40915;
    bool free_x_41247;
    bool free_x_41502;
    unsigned char *free_reduce_stage_1_tid_res_arr_mem_41742;
};
static int futhark_mc_segred_stage_1_parloop_42158(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segred_stage_1_parloop_struct_42157 *futhark_mc_segred_stage_1_parloop_struct_42157 = (struct futhark_mc_segred_stage_1_parloop_struct_42157 *) args;
    struct futhark_context *ctx = futhark_mc_segred_stage_1_parloop_struct_42157->ctx;
    uint64_t futhark_mc_segred_stage_1_parloop_42158_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segred_stage_1_parloop_42158_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_27583;
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segred_stage_1_parloop_struct_42157->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segred_stage_1_parloop_struct_42157->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_35007;
    bool x_36099 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_36099;
    bool x_37082 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_37082;
    int8_t x_37960 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_37960;
    int8_t x_38737 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_38737;
    bool x_39417 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_39417;
    bool x_40004 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_40004;
    int8_t x_40502 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_40502;
    int8_t x_40915 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_40915;
    bool x_41247 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_41247;
    bool x_41502 = futhark_mc_segred_stage_1_parloop_struct_42157->free_x_41502;
    struct memblock reduce_stage_1_tid_res_arr_mem_41742 = {.desc ="reduce_stage_1_tid_res_arr_mem_41742", .mem =futhark_mc_segred_stage_1_parloop_struct_42157->free_reduce_stage_1_tid_res_arr_mem_41742, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t flat_tid_41681;
    
    flat_tid_41681 = subtask_id;
    {
        bool x_41744;
        bool y_41745;
        bool local_acc_41747 = 1;
        bool x_41683;
        bool y_41684;
        bool local_acc_41748 = 1;
        int64_t start_41749;
        int64_t end_41750;
        
        start_41749 = start;
        end_41750 = end;
        
        int64_t n_41751 = end_41750 - start_41749;
        
        for (int64_t SegRed_i_41752 = start_41749; SegRed_i_41752 < start_41749 + n_41751; SegRed_i_41752++) {
            int64_t gtid_41682 = SegRed_i_41752;
            int8_t x_41686 = ((int8_t *) mem_30515.mem)[gtid_41682];
            int8_t y_41687 = ((int8_t *) mem_30517.mem)[gtid_41682];
            int8_t comperator_res_41688;
            
            if (x_36099 == 1) {
                bool cond_41689 = ult8(x_27583, x_41686);
                int8_t comperator_res_t_res_41690;
                
                if (cond_41689 == 1) {
                    int8_t comperator_res_t_res_t_res_41691 = sub8(x_41686, x_27583);
                    
                    comperator_res_t_res_41690 = comperator_res_t_res_t_res_41691;
                } else {
                    comperator_res_t_res_41690 = (int8_t) 0;
                }
                comperator_res_41688 = comperator_res_t_res_41690;
            } else {
                bool cond_41692 = ult8(x_27583, x_41686);
                int8_t comperator_res_f_res_41693;
                
                if (cond_41692 == 1) {
                    comperator_res_f_res_41693 = x_41686;
                } else {
                    comperator_res_f_res_41693 = (int8_t) 0;
                }
                comperator_res_41688 = comperator_res_f_res_41693;
            }
            
            int8_t comperator_res_41694;
            
            if (x_37082 == 1) {
                bool cond_41695 = ult8(x_41686, x_35007);
                int8_t comperator_res_t_res_41696;
                
                if (cond_41695 == 1) {
                    int8_t comperator_res_t_res_t_res_41697 = sub8(x_35007, x_41686);
                    
                    comperator_res_t_res_41696 = comperator_res_t_res_t_res_41697;
                } else {
                    comperator_res_t_res_41696 = (int8_t) 0;
                }
                comperator_res_41694 = comperator_res_t_res_41696;
            } else {
                bool cond_41698 = ult8(x_41686, x_35007);
                int8_t comperator_res_f_res_41699;
                
                if (cond_41698 == 1) {
                    comperator_res_f_res_41699 = x_35007;
                } else {
                    comperator_res_f_res_41699 = (int8_t) 0;
                }
                comperator_res_41694 = comperator_res_f_res_41699;
            }
            
            bool cond_41700 = ult8(comperator_res_41694, comperator_res_41688);
            int8_t layer_res_41701;
            
            if (cond_41700 == 1) {
                layer_res_41701 = comperator_res_41688;
            } else {
                layer_res_41701 = comperator_res_41694;
            }
            
            int8_t comperator_res_41702;
            
            if (x_39417 == 1) {
                bool cond_41703 = ult8(x_37960, layer_res_41701);
                int8_t comperator_res_t_res_41704;
                
                if (cond_41703 == 1) {
                    int8_t comperator_res_t_res_t_res_41705 = sub8(layer_res_41701, x_37960);
                    
                    comperator_res_t_res_41704 = comperator_res_t_res_t_res_41705;
                } else {
                    comperator_res_t_res_41704 = (int8_t) 0;
                }
                comperator_res_41702 = comperator_res_t_res_41704;
            } else {
                bool cond_41706 = ult8(x_37960, layer_res_41701);
                int8_t comperator_res_f_res_41707;
                
                if (cond_41706 == 1) {
                    comperator_res_f_res_41707 = layer_res_41701;
                } else {
                    comperator_res_f_res_41707 = (int8_t) 0;
                }
                comperator_res_41702 = comperator_res_f_res_41707;
            }
            
            int8_t comperator_res_41708;
            
            if (x_40004 == 1) {
                bool cond_41709 = ult8(layer_res_41701, x_38737);
                int8_t comperator_res_t_res_41710;
                
                if (cond_41709 == 1) {
                    int8_t comperator_res_t_res_t_res_41711 = sub8(x_38737, layer_res_41701);
                    
                    comperator_res_t_res_41710 = comperator_res_t_res_t_res_41711;
                } else {
                    comperator_res_t_res_41710 = (int8_t) 0;
                }
                comperator_res_41708 = comperator_res_t_res_41710;
            } else {
                bool cond_41712 = ult8(layer_res_41701, x_38737);
                int8_t comperator_res_f_res_41713;
                
                if (cond_41712 == 1) {
                    comperator_res_f_res_41713 = x_38737;
                } else {
                    comperator_res_f_res_41713 = (int8_t) 0;
                }
                comperator_res_41708 = comperator_res_f_res_41713;
            }
            
            bool cond_41714 = ult8(comperator_res_41708, comperator_res_41702);
            int8_t layer_res_41715;
            
            if (cond_41714 == 1) {
                layer_res_41715 = comperator_res_41702;
            } else {
                layer_res_41715 = comperator_res_41708;
            }
            
            int8_t comperator_res_41716;
            
            if (x_41247 == 1) {
                bool cond_41717 = ult8(x_40502, layer_res_41715);
                int8_t comperator_res_t_res_41718;
                
                if (cond_41717 == 1) {
                    int8_t comperator_res_t_res_t_res_41719 = sub8(layer_res_41715, x_40502);
                    
                    comperator_res_t_res_41718 = comperator_res_t_res_t_res_41719;
                } else {
                    comperator_res_t_res_41718 = (int8_t) 0;
                }
                comperator_res_41716 = comperator_res_t_res_41718;
            } else {
                bool cond_41720 = ult8(x_40502, layer_res_41715);
                int8_t comperator_res_f_res_41721;
                
                if (cond_41720 == 1) {
                    comperator_res_f_res_41721 = layer_res_41715;
                } else {
                    comperator_res_f_res_41721 = (int8_t) 0;
                }
                comperator_res_41716 = comperator_res_f_res_41721;
            }
            
            int8_t comperator_res_41722;
            
            if (x_41502 == 1) {
                bool cond_41723 = ult8(layer_res_41715, x_40915);
                int8_t comperator_res_t_res_41724;
                
                if (cond_41723 == 1) {
                    int8_t comperator_res_t_res_t_res_41725 = sub8(x_40915, layer_res_41715);
                    
                    comperator_res_t_res_41724 = comperator_res_t_res_t_res_41725;
                } else {
                    comperator_res_t_res_41724 = (int8_t) 0;
                }
                comperator_res_41722 = comperator_res_t_res_41724;
            } else {
                bool cond_41726 = ult8(layer_res_41715, x_40915);
                int8_t comperator_res_f_res_41727;
                
                if (cond_41726 == 1) {
                    comperator_res_f_res_41727 = x_40915;
                } else {
                    comperator_res_f_res_41727 = (int8_t) 0;
                }
                comperator_res_41722 = comperator_res_f_res_41727;
            }
            
            bool cond_41728 = ult8(comperator_res_41722, comperator_res_41716);
            bool eq_x_y_41729 = y_41687 == comperator_res_41716;
            bool eq_x_zz_41730 = y_41687 == comperator_res_41722;
            bool p_and_eq_x_y_41731 = cond_41728 && eq_x_y_41729;
            bool not_p_41732 = !cond_41728;
            bool p_and_eq_x_y_41733 = eq_x_zz_41730 && not_p_41732;
            bool binlam_res_41734 = p_and_eq_x_y_41731 || p_and_eq_x_y_41733;
            
            // save map-out results
            { }
            // Load accum params
            {
                x_41683 = local_acc_41748;
            }
            // Load next params
            {
                y_41684 = binlam_res_41734;
            }
            // SegRed body
            {
                bool binlam_res_41685 = x_41683 && y_41684;
                
                local_acc_41748 = binlam_res_41685;
            }
        }
        
        int64_t uni_i_41753 = 0;
        
        {
            int64_t gtid_41682 = uni_i_41753;
            
            // Load accum params
            {
                x_41744 = local_acc_41747;
            }
            // Load next params
            {
                y_41745 = local_acc_41748;
            }
            // SegRed body
            {
                bool binlam_res_41746 = x_41744 && y_41745;
                
                local_acc_41747 = binlam_res_41746;
            }
        }
        ((bool *) reduce_stage_1_tid_res_arr_mem_41742.mem)[flat_tid_41681] = local_acc_41747;
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segred_stage_1_parloop_42158_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segred_stage_1_parloop_42158_end - futhark_mc_segred_stage_1_parloop_42158_start;
        
        ctx->program->futhark_mc_segred_stage_1_parloop_42158_runs[tid]++;
        ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segred_stage_1_parloop_42158_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segred_task_42155(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42154 *futhark_mc_task_42154 = (struct futhark_mc_task_42154 *) args;
    struct futhark_context *ctx = futhark_mc_task_42154->ctx;
    uint64_t futhark_mc_segred_task_42155_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segred_task_42155_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42154->free_x_27583;
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42154->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42154->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42154->free_x_35007;
    bool x_36099 = futhark_mc_task_42154->free_x_36099;
    bool x_37082 = futhark_mc_task_42154->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42154->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42154->free_x_38737;
    bool x_39417 = futhark_mc_task_42154->free_x_39417;
    bool x_40004 = futhark_mc_task_42154->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42154->free_x_40502;
    int8_t x_40915 = futhark_mc_task_42154->free_x_40915;
    bool x_41247 = futhark_mc_task_42154->free_x_41247;
    bool x_41502 = futhark_mc_task_42154->free_x_41502;
    int64_t flat_tid_41681 = futhark_mc_task_42154->free_flat_tid_41681;
    bool all_equal_41503 = *futhark_mc_task_42154->retval_all_equal_41503;
    int64_t reduce_stage_1_tid_res_arr_mem_41742_cached_sizze_42156 = 0;
    unsigned char *reduce_stage_1_tid_res_arr_mem_41742 = NULL;
    int32_t nsubtasks_41741;
    
    nsubtasks_41741 = info.nsubtasks;
    if (reduce_stage_1_tid_res_arr_mem_41742_cached_sizze_42156 < nsubtasks_41741) {
        err = lexical_realloc(ctx, &reduce_stage_1_tid_res_arr_mem_41742, &reduce_stage_1_tid_res_arr_mem_41742_cached_sizze_42156, nsubtasks_41741);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    struct futhark_mc_segred_stage_1_parloop_struct_42157 futhark_mc_segred_stage_1_parloop_struct_42157_;
    
    futhark_mc_segred_stage_1_parloop_struct_42157_.ctx = ctx;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_27583 = x_27583;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_35007 = x_35007;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_36099 = x_36099;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_37082 = x_37082;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_37960 = x_37960;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_38737 = x_38737;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_39417 = x_39417;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_40004 = x_40004;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_40502 = x_40502;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_40915 = x_40915;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_41247 = x_41247;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_x_41502 = x_41502;
    futhark_mc_segred_stage_1_parloop_struct_42157_.free_reduce_stage_1_tid_res_arr_mem_41742 = reduce_stage_1_tid_res_arr_mem_41742;
    
    struct scheduler_parloop futhark_mc_segred_stage_1_parloop_42158_task;
    
    futhark_mc_segred_stage_1_parloop_42158_task.name = "futhark_mc_segred_stage_1_parloop_42158";
    futhark_mc_segred_stage_1_parloop_42158_task.fn = futhark_mc_segred_stage_1_parloop_42158;
    futhark_mc_segred_stage_1_parloop_42158_task.args = &futhark_mc_segred_stage_1_parloop_struct_42157_;
    futhark_mc_segred_stage_1_parloop_42158_task.iterations = iterations;
    futhark_mc_segred_stage_1_parloop_42158_task.info = info;
    
    uint64_t futhark_mc_segred_stage_1_parloop_42158_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segred_stage_1_parloop_42158_total_start = get_wall_time();
    
    int futhark_mc_segred_stage_1_parloop_42158_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segred_stage_1_parloop_42158_task);
    
    if (futhark_mc_segred_stage_1_parloop_42158_err != 0) {
        err = futhark_mc_segred_stage_1_parloop_42158_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segred_stage_1_parloop_42158_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segred_stage_1_parloop_42158_total_end - futhark_mc_segred_stage_1_parloop_42158_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segred_stage_1_parloop_42158_total_iter, iterations, __ATOMIC_RELAXED);
    }
    // neutral-initialise the output
    {
        all_equal_41503 = 1;
    }
    
    bool x_41754;
    bool y_41755;
    
    for (int32_t i_41757 = 0; i_41757 < nsubtasks_41741; i_41757++) {
        flat_tid_41681 = i_41757;
        // Apply main thread reduction
        {
            // load acc params
            {
                x_41754 = all_equal_41503;
            }
            // load next params
            {
                y_41755 = ((bool *) reduce_stage_1_tid_res_arr_mem_41742)[flat_tid_41681];
            }
            // red body
            {
                bool binlam_res_41756 = x_41754 && y_41755;
                
                all_equal_41503 = binlam_res_41756;
            }
        }
    }
    
  cleanup:
    {
        free(reduce_stage_1_tid_res_arr_mem_41742);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segred_task_42155_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segred_task_42155_end - futhark_mc_segred_task_42155_start;
        
        ctx->program->futhark_mc_segred_task_42155_runs[tid]++;
        ctx->program->futhark_mc_segred_task_42155_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segred_task_42155_iter[tid] += iterations;
    }
    if (err == 0) {
        *futhark_mc_task_42154->retval_all_equal_41503 = all_equal_41503;
    }
    return err;
}
static int futhark_mc_segmap_parloop_42153(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42152 *futhark_mc_segmap_parloop_struct_42152 = (struct futhark_mc_segmap_parloop_struct_42152 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42152->ctx;
    uint64_t futhark_mc_segmap_parloop_42153_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42153_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42152->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42152->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42152->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42152->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42152->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42152->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42152->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42152->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42152->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42152->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42152->free_x_40004;
    int8_t x_40502 = futhark_mc_segmap_parloop_struct_42152->free_x_40502;
    int8_t x_40915 = futhark_mc_segmap_parloop_struct_42152->free_x_40915;
    bool x_41247 = futhark_mc_segmap_parloop_struct_42152->free_x_41247;
    struct memblock mem_41248 = {.desc ="mem_41248", .mem =futhark_mc_segmap_parloop_struct_42152->free_mem_41248, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t flat_tid_41500;
    
    flat_tid_41500 = subtask_id;
    {
        int64_t start_41735;
        int64_t end_41736;
        
        start_41735 = start;
        end_41736 = end;
        
        int64_t n_41737 = end_41736 - start_41735;
        
        for (int64_t SegMap_i_41738 = start_41735; SegMap_i_41738 < start_41735 + n_41737; SegMap_i_41738++) {
            int64_t slice_41739 = (int64_t) 2;
            int64_t gtid_41501 = SegMap_i_41738;
            int64_t remnant_41740 = SegMap_i_41738 - gtid_41501;
            bool x_41502 = ((bool *) mem_30513.mem)[gtid_41501];
            bool all_equal_41503;
            int64_t flat_tid_41681 = (int64_t) 0;
            
            all_equal_41503 = 0;
            
            struct futhark_mc_task_42154 futhark_mc_task_42154_;
            
            futhark_mc_task_42154_.ctx = ctx;
            futhark_mc_task_42154_.free_x_27583 = x_27583;
            futhark_mc_task_42154_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42154_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42154_.free_x_35007 = x_35007;
            futhark_mc_task_42154_.free_x_36099 = x_36099;
            futhark_mc_task_42154_.free_x_37082 = x_37082;
            futhark_mc_task_42154_.free_x_37960 = x_37960;
            futhark_mc_task_42154_.free_x_38737 = x_38737;
            futhark_mc_task_42154_.free_x_39417 = x_39417;
            futhark_mc_task_42154_.free_x_40004 = x_40004;
            futhark_mc_task_42154_.free_x_40502 = x_40502;
            futhark_mc_task_42154_.free_x_40915 = x_40915;
            futhark_mc_task_42154_.free_x_41247 = x_41247;
            futhark_mc_task_42154_.free_x_41502 = x_41502;
            futhark_mc_task_42154_.free_flat_tid_41681 = flat_tid_41681;
            futhark_mc_task_42154_.retval_all_equal_41503 = (bool *) &all_equal_41503;
            #if ISPC
            futhark_mc_task_42154_.retval_all_equal_41503 += programIndex;
            #endif
            
            struct scheduler_segop futhark_mc_task_42154_task;
            
            futhark_mc_task_42154_task.args = &futhark_mc_task_42154_;
            futhark_mc_task_42154_task.top_level_fn = futhark_mc_segred_task_42155;
            futhark_mc_task_42154_task.name = "futhark_mc_segred_task_42155";
            futhark_mc_task_42154_task.iterations = (int64_t) 16;
            futhark_mc_task_42154_task.task_time = &ctx->program->futhark_mc_segred_task_42155_total_time;
            futhark_mc_task_42154_task.task_iter = &ctx->program->futhark_mc_segred_task_42155_total_iter;
            futhark_mc_task_42154_task.sched = STATIC;
            futhark_mc_task_42154_task.nested_fn = NULL;
            
            int futhark_mc_segred_task_42155_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42154_task);
            
            if (futhark_mc_segred_task_42155_err != 0) {
                ;
                err = futhark_mc_segred_task_42155_err;
                goto cleanup;
            }
            ((bool *) mem_41248.mem)[gtid_41501] = all_equal_41503;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42153_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42153_end - futhark_mc_segmap_parloop_42153_start;
        
        ctx->program->futhark_mc_segmap_parloop_42153_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42153_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42153_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42151(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42147 *futhark_mc_task_42147 = (struct futhark_mc_task_42147 *) args;
    struct futhark_context *ctx = futhark_mc_task_42147->ctx;
    uint64_t futhark_mc_segmap_nested_task_42151_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42151_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42147->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42147->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42147->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42147->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42147->free_x_35007;
    bool x_36099 = futhark_mc_task_42147->free_x_36099;
    bool x_37082 = futhark_mc_task_42147->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42147->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42147->free_x_38737;
    bool x_39417 = futhark_mc_task_42147->free_x_39417;
    bool x_40004 = futhark_mc_task_42147->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42147->free_x_40502;
    int8_t x_40915 = futhark_mc_task_42147->free_x_40915;
    bool x_41247 = futhark_mc_task_42147->free_x_41247;
    struct memblock mem_41248 = {.desc ="mem_41248", .mem =futhark_mc_task_42147->free_mem_41248, .size =0, .references =NULL};
    int32_t nsubtasks_41680;
    
    nsubtasks_41680 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42152 futhark_mc_segmap_parloop_struct_42152_;
    
    futhark_mc_segmap_parloop_struct_42152_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42152_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42152_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42152_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42152_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42152_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42152_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42152_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42152_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42152_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42152_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42152_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42152_.free_x_40502 = x_40502;
    futhark_mc_segmap_parloop_struct_42152_.free_x_40915 = x_40915;
    futhark_mc_segmap_parloop_struct_42152_.free_x_41247 = x_41247;
    futhark_mc_segmap_parloop_struct_42152_.free_mem_41248 = mem_41248.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42153_task;
    
    futhark_mc_segmap_parloop_42153_task.name = "futhark_mc_segmap_parloop_42153";
    futhark_mc_segmap_parloop_42153_task.fn = futhark_mc_segmap_parloop_42153;
    futhark_mc_segmap_parloop_42153_task.args = &futhark_mc_segmap_parloop_struct_42152_;
    futhark_mc_segmap_parloop_42153_task.iterations = iterations;
    futhark_mc_segmap_parloop_42153_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42153_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42153_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42153_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42153_task);
    
    if (futhark_mc_segmap_parloop_42153_err != 0) {
        err = futhark_mc_segmap_parloop_42153_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42153_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42153_total_end - futhark_mc_segmap_parloop_42153_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42153_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42153_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42153_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42151_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42151_end - futhark_mc_segmap_nested_task_42151_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42151_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42151_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42151_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42159 {
    struct futhark_context *ctx;
    unsigned char *free_mem_40916;
    int64_t free_gtid_41246;
    unsigned char *free_mem_41248;
};
struct futhark_mc_copy_parloop_struct_42161 {
    struct futhark_context *ctx;
    unsigned char *free_mem_40916;
    int64_t free_gtid_41246;
    unsigned char *free_mem_41248;
};
static int futhark_mc_copy_parloop_42162(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42161 *futhark_mc_copy_parloop_struct_42161 = (struct futhark_mc_copy_parloop_struct_42161 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42161->ctx;
    uint64_t futhark_mc_copy_parloop_42162_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42162_start = get_wall_time();
    
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_copy_parloop_struct_42161->free_mem_40916, .size =0, .references =NULL};
    int64_t gtid_41246 = futhark_mc_copy_parloop_struct_42161->free_gtid_41246;
    struct memblock mem_41248 = {.desc ="mem_41248", .mem =futhark_mc_copy_parloop_struct_42161->free_mem_41248, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41758;
        int64_t end_41759;
        
        start_41758 = start;
        end_41759 = end;
        
        int64_t n_41760 = end_41759 - start_41758;
        
        for (int64_t copy_i_41761 = start_41758; copy_i_41761 < start_41758 + n_41760; copy_i_41761++) {
            int64_t slice_41763 = (int64_t) 2;
            int64_t i_41762 = copy_i_41761;
            int64_t remnant_41764 = copy_i_41761 - i_41762;
            bool tmp_41765 = ((bool *) mem_41248.mem)[i_41762];
            
            ((bool *) mem_40916.mem)[gtid_41246 * (int64_t) 2 + i_41762] = tmp_41765;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42162_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42162_end - futhark_mc_copy_parloop_42162_start;
        
        ctx->program->futhark_mc_copy_parloop_42162_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42162_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42162_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41766_task_42160(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42159 *futhark_mc_task_42159 = (struct futhark_mc_task_42159 *) args;
    struct futhark_context *ctx = futhark_mc_task_42159->ctx;
    uint64_t futhark_mc_copy_41766_task_42160_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41766_task_42160_start = get_wall_time();
    
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_task_42159->free_mem_40916, .size =0, .references =NULL};
    int64_t gtid_41246 = futhark_mc_task_42159->free_gtid_41246;
    struct memblock mem_41248 = {.desc ="mem_41248", .mem =futhark_mc_task_42159->free_mem_41248, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42161 futhark_mc_copy_parloop_struct_42161_;
    
    futhark_mc_copy_parloop_struct_42161_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42161_.free_mem_40916 = mem_40916.mem;
    futhark_mc_copy_parloop_struct_42161_.free_gtid_41246 = gtid_41246;
    futhark_mc_copy_parloop_struct_42161_.free_mem_41248 = mem_41248.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42162_task;
    
    futhark_mc_copy_parloop_42162_task.name = "futhark_mc_copy_parloop_42162";
    futhark_mc_copy_parloop_42162_task.fn = futhark_mc_copy_parloop_42162;
    futhark_mc_copy_parloop_42162_task.args = &futhark_mc_copy_parloop_struct_42161_;
    futhark_mc_copy_parloop_42162_task.iterations = iterations;
    futhark_mc_copy_parloop_42162_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42162_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42162_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42162_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42162_task);
    
    if (futhark_mc_copy_parloop_42162_err != 0) {
        err = futhark_mc_copy_parloop_42162_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42162_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42162_total_end - futhark_mc_copy_parloop_42162_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42162_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42162_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42162_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41766_task_42160_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41766_task_42160_end - futhark_mc_copy_41766_task_42160_start;
        
        ctx->program->futhark_mc_copy_41766_task_42160_runs[tid]++;
        ctx->program->futhark_mc_copy_41766_task_42160_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41766_task_42160_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42145(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42144 *futhark_mc_segmap_parloop_struct_42144 = (struct futhark_mc_segmap_parloop_struct_42144 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42144->ctx;
    uint64_t futhark_mc_segmap_parloop_42145_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42145_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42144->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42144->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42144->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42144->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42144->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42144->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42144->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42144->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42144->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42144->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42144->free_x_40004;
    int8_t x_40502 = futhark_mc_segmap_parloop_struct_42144->free_x_40502;
    int8_t x_40915 = futhark_mc_segmap_parloop_struct_42144->free_x_40915;
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_segmap_parloop_struct_42144->free_mem_40916, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_41248_cached_sizze_42146 = 0;
    unsigned char *mem_41248 = NULL;
    int64_t flat_tid_41245;
    
    flat_tid_41245 = subtask_id;
    {
        int64_t start_41614;
        int64_t end_41615;
        
        start_41614 = start;
        end_41615 = end;
        
        int64_t n_41616 = end_41615 - start_41614;
        
        if (mem_41248_cached_sizze_42146 < (int64_t) 2) {
            err = lexical_realloc(ctx, &mem_41248, &mem_41248_cached_sizze_42146, (int64_t) 2);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_41617 = start_41614; SegMap_i_41617 < start_41614 + n_41616; SegMap_i_41617++) {
            int64_t slice_41618 = (int64_t) 2;
            int64_t gtid_41246 = SegMap_i_41617;
            int64_t remnant_41619 = SegMap_i_41617 - gtid_41246;
            bool x_41247 = ((bool *) mem_30513.mem)[gtid_41246];
            int64_t flat_tid_41558 = (int64_t) 0;
            int64_t flat_tid_41500 = (int64_t) 0;
            struct futhark_mc_task_42147 futhark_mc_task_42147_;
            
            futhark_mc_task_42147_.ctx = ctx;
            futhark_mc_task_42147_.free_x_27583 = x_27583;
            futhark_mc_task_42147_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42147_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42147_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42147_.free_x_35007 = x_35007;
            futhark_mc_task_42147_.free_x_36099 = x_36099;
            futhark_mc_task_42147_.free_x_37082 = x_37082;
            futhark_mc_task_42147_.free_x_37960 = x_37960;
            futhark_mc_task_42147_.free_x_38737 = x_38737;
            futhark_mc_task_42147_.free_x_39417 = x_39417;
            futhark_mc_task_42147_.free_x_40004 = x_40004;
            futhark_mc_task_42147_.free_x_40502 = x_40502;
            futhark_mc_task_42147_.free_x_40915 = x_40915;
            futhark_mc_task_42147_.free_x_41247 = x_41247;
            futhark_mc_task_42147_.free_mem_41248 = mem_41248;
            
            struct scheduler_segop futhark_mc_task_42147_task;
            
            futhark_mc_task_42147_task.args = &futhark_mc_task_42147_;
            futhark_mc_task_42147_task.top_level_fn = futhark_mc_segmap_task_42148;
            futhark_mc_task_42147_task.name = "futhark_mc_segmap_task_42148";
            futhark_mc_task_42147_task.iterations = (int64_t) 2;
            futhark_mc_task_42147_task.task_time = &ctx->program->futhark_mc_segmap_task_42148_total_time;
            futhark_mc_task_42147_task.task_iter = &ctx->program->futhark_mc_segmap_task_42148_total_iter;
            futhark_mc_task_42147_task.sched = STATIC;
            futhark_mc_task_42147_task.nested_fn = futhark_mc_segmap_nested_task_42151;
            
            int futhark_mc_segmap_task_42148_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42147_task);
            
            if (futhark_mc_segmap_task_42148_err != 0) {
                ;
                err = futhark_mc_segmap_task_42148_err;
                goto cleanup;
            }
            
            int64_t iterations_41767 = (int64_t) 2;
            struct futhark_mc_task_42159 futhark_mc_task_42159_;
            
            futhark_mc_task_42159_.ctx = ctx;
            futhark_mc_task_42159_.free_mem_40916 = mem_40916.mem;
            futhark_mc_task_42159_.free_gtid_41246 = gtid_41246;
            futhark_mc_task_42159_.free_mem_41248 = mem_41248;
            
            struct scheduler_segop futhark_mc_task_42159_task;
            
            futhark_mc_task_42159_task.args = &futhark_mc_task_42159_;
            futhark_mc_task_42159_task.top_level_fn = futhark_mc_copy_41766_task_42160;
            futhark_mc_task_42159_task.name = "futhark_mc_copy_41766_task_42160";
            futhark_mc_task_42159_task.iterations = iterations_41767;
            futhark_mc_task_42159_task.task_time = &ctx->program->futhark_mc_copy_41766_task_42160_total_time;
            futhark_mc_task_42159_task.task_iter = &ctx->program->futhark_mc_copy_41766_task_42160_total_iter;
            futhark_mc_task_42159_task.sched = STATIC;
            futhark_mc_task_42159_task.nested_fn = NULL;
            
            int futhark_mc_copy_41766_task_42160_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42159_task);
            
            if (futhark_mc_copy_41766_task_42160_err != 0) {
                ;
                err = futhark_mc_copy_41766_task_42160_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_41248);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42145_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42145_end - futhark_mc_segmap_parloop_42145_start;
        
        ctx->program->futhark_mc_segmap_parloop_42145_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42145_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42145_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42143(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42138 *futhark_mc_task_42138 = (struct futhark_mc_task_42138 *) args;
    struct futhark_context *ctx = futhark_mc_task_42138->ctx;
    uint64_t futhark_mc_segmap_nested_task_42143_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42143_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42138->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42138->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42138->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42138->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42138->free_x_35007;
    bool x_36099 = futhark_mc_task_42138->free_x_36099;
    bool x_37082 = futhark_mc_task_42138->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42138->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42138->free_x_38737;
    bool x_39417 = futhark_mc_task_42138->free_x_39417;
    bool x_40004 = futhark_mc_task_42138->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42138->free_x_40502;
    int8_t x_40915 = futhark_mc_task_42138->free_x_40915;
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_task_42138->free_mem_40916, .size =0, .references =NULL};
    int32_t nsubtasks_41499;
    
    nsubtasks_41499 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42144 futhark_mc_segmap_parloop_struct_42144_;
    
    futhark_mc_segmap_parloop_struct_42144_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42144_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42144_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42144_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42144_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42144_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42144_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42144_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42144_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42144_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42144_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42144_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42144_.free_x_40502 = x_40502;
    futhark_mc_segmap_parloop_struct_42144_.free_x_40915 = x_40915;
    futhark_mc_segmap_parloop_struct_42144_.free_mem_40916 = mem_40916.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42145_task;
    
    futhark_mc_segmap_parloop_42145_task.name = "futhark_mc_segmap_parloop_42145";
    futhark_mc_segmap_parloop_42145_task.fn = futhark_mc_segmap_parloop_42145;
    futhark_mc_segmap_parloop_42145_task.args = &futhark_mc_segmap_parloop_struct_42144_;
    futhark_mc_segmap_parloop_42145_task.iterations = iterations;
    futhark_mc_segmap_parloop_42145_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42145_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42145_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42145_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42145_task);
    
    if (futhark_mc_segmap_parloop_42145_err != 0) {
        err = futhark_mc_segmap_parloop_42145_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42145_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42145_total_end - futhark_mc_segmap_parloop_42145_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42145_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42145_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42145_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42143_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42143_end - futhark_mc_segmap_nested_task_42143_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42143_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42143_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42143_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42163 {
    struct futhark_context *ctx;
    unsigned char *free_mem_40503;
    int64_t free_gtid_40914;
    unsigned char *free_mem_40916;
};
struct futhark_mc_copy_parloop_struct_42165 {
    struct futhark_context *ctx;
    unsigned char *free_mem_40503;
    int64_t free_gtid_40914;
    unsigned char *free_mem_40916;
};
static int futhark_mc_copy_parloop_42166(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42165 *futhark_mc_copy_parloop_struct_42165 = (struct futhark_mc_copy_parloop_struct_42165 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42165->ctx;
    uint64_t futhark_mc_copy_parloop_42166_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42166_start = get_wall_time();
    
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_copy_parloop_struct_42165->free_mem_40503, .size =0, .references =NULL};
    int64_t gtid_40914 = futhark_mc_copy_parloop_struct_42165->free_gtid_40914;
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_copy_parloop_struct_42165->free_mem_40916, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41768;
        int64_t end_41769;
        
        start_41768 = start;
        end_41769 = end;
        
        int64_t n_41770 = end_41769 - start_41768;
        
        for (int64_t copy_i_41771 = start_41768; copy_i_41771 < start_41768 + n_41770; copy_i_41771++) {
            int64_t slice_41774 = (int64_t) 2;
            int64_t slice_41775 = (int64_t) 2 * slice_41774;
            int64_t i_41772 = squot64(copy_i_41771, slice_41774);
            int64_t remnant_41776 = copy_i_41771 - i_41772 * slice_41774;
            int64_t i_41773 = remnant_41776;
            int64_t remnant_41777 = remnant_41776 - i_41773;
            bool tmp_41778 = ((bool *) mem_40916.mem)[i_41772 * (int64_t) 2 + i_41773];
            
            ((bool *) mem_40503.mem)[gtid_40914 * (int64_t) 4 + (i_41772 * (int64_t) 2 + i_41773)] = tmp_41778;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42166_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42166_end - futhark_mc_copy_parloop_42166_start;
        
        ctx->program->futhark_mc_copy_parloop_42166_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42166_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42166_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41779_task_42164(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42163 *futhark_mc_task_42163 = (struct futhark_mc_task_42163 *) args;
    struct futhark_context *ctx = futhark_mc_task_42163->ctx;
    uint64_t futhark_mc_copy_41779_task_42164_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41779_task_42164_start = get_wall_time();
    
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_task_42163->free_mem_40503, .size =0, .references =NULL};
    int64_t gtid_40914 = futhark_mc_task_42163->free_gtid_40914;
    struct memblock mem_40916 = {.desc ="mem_40916", .mem =futhark_mc_task_42163->free_mem_40916, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42165 futhark_mc_copy_parloop_struct_42165_;
    
    futhark_mc_copy_parloop_struct_42165_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42165_.free_mem_40503 = mem_40503.mem;
    futhark_mc_copy_parloop_struct_42165_.free_gtid_40914 = gtid_40914;
    futhark_mc_copy_parloop_struct_42165_.free_mem_40916 = mem_40916.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42166_task;
    
    futhark_mc_copy_parloop_42166_task.name = "futhark_mc_copy_parloop_42166";
    futhark_mc_copy_parloop_42166_task.fn = futhark_mc_copy_parloop_42166;
    futhark_mc_copy_parloop_42166_task.args = &futhark_mc_copy_parloop_struct_42165_;
    futhark_mc_copy_parloop_42166_task.iterations = iterations;
    futhark_mc_copy_parloop_42166_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42166_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42166_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42166_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42166_task);
    
    if (futhark_mc_copy_parloop_42166_err != 0) {
        err = futhark_mc_copy_parloop_42166_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42166_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42166_total_end - futhark_mc_copy_parloop_42166_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42166_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42166_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42166_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41779_task_42164_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41779_task_42164_end - futhark_mc_copy_41779_task_42164_start;
        
        ctx->program->futhark_mc_copy_41779_task_42164_runs[tid]++;
        ctx->program->futhark_mc_copy_41779_task_42164_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41779_task_42164_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42136(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42135 *futhark_mc_segmap_parloop_struct_42135 = (struct futhark_mc_segmap_parloop_struct_42135 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42135->ctx;
    uint64_t futhark_mc_segmap_parloop_42136_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42136_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42135->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42135->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42135->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42135->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42135->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42135->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42135->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42135->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42135->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42135->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42135->free_x_40004;
    int8_t x_40502 = futhark_mc_segmap_parloop_struct_42135->free_x_40502;
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_segmap_parloop_struct_42135->free_mem_40503, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_40916_cached_sizze_42137 = 0;
    unsigned char *mem_40916 = NULL;
    int64_t flat_tid_40913;
    
    flat_tid_40913 = subtask_id;
    {
        int64_t start_41427;
        int64_t end_41428;
        
        start_41427 = start;
        end_41428 = end;
        
        int64_t n_41429 = end_41428 - start_41427;
        
        if (mem_40916_cached_sizze_42137 < (int64_t) 4) {
            err = lexical_realloc(ctx, &mem_40916, &mem_40916_cached_sizze_42137, (int64_t) 4);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_41430 = start_41427; SegMap_i_41430 < start_41427 + n_41429; SegMap_i_41430++) {
            int64_t slice_41431 = (int64_t) 16;
            int64_t gtid_40914 = SegMap_i_41430;
            int64_t remnant_41432 = SegMap_i_41430 - gtid_40914;
            int8_t x_40915 = ((int8_t *) mem_30515.mem)[gtid_40914];
            int64_t flat_tid_41364 = (int64_t) 0;
            int64_t flat_tid_41245 = (int64_t) 0;
            struct futhark_mc_task_42138 futhark_mc_task_42138_;
            
            futhark_mc_task_42138_.ctx = ctx;
            futhark_mc_task_42138_.free_x_27583 = x_27583;
            futhark_mc_task_42138_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42138_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42138_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42138_.free_x_35007 = x_35007;
            futhark_mc_task_42138_.free_x_36099 = x_36099;
            futhark_mc_task_42138_.free_x_37082 = x_37082;
            futhark_mc_task_42138_.free_x_37960 = x_37960;
            futhark_mc_task_42138_.free_x_38737 = x_38737;
            futhark_mc_task_42138_.free_x_39417 = x_39417;
            futhark_mc_task_42138_.free_x_40004 = x_40004;
            futhark_mc_task_42138_.free_x_40502 = x_40502;
            futhark_mc_task_42138_.free_x_40915 = x_40915;
            futhark_mc_task_42138_.free_mem_40916 = mem_40916;
            
            struct scheduler_segop futhark_mc_task_42138_task;
            
            futhark_mc_task_42138_task.args = &futhark_mc_task_42138_;
            futhark_mc_task_42138_task.top_level_fn = futhark_mc_segmap_task_42139;
            futhark_mc_task_42138_task.name = "futhark_mc_segmap_task_42139";
            futhark_mc_task_42138_task.iterations = (int64_t) 2;
            futhark_mc_task_42138_task.task_time = &ctx->program->futhark_mc_segmap_task_42139_total_time;
            futhark_mc_task_42138_task.task_iter = &ctx->program->futhark_mc_segmap_task_42139_total_iter;
            futhark_mc_task_42138_task.sched = STATIC;
            futhark_mc_task_42138_task.nested_fn = futhark_mc_segmap_nested_task_42143;
            
            int futhark_mc_segmap_task_42139_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42138_task);
            
            if (futhark_mc_segmap_task_42139_err != 0) {
                ;
                err = futhark_mc_segmap_task_42139_err;
                goto cleanup;
            }
            
            int64_t iterations_41780 = (int64_t) 4;
            struct futhark_mc_task_42163 futhark_mc_task_42163_;
            
            futhark_mc_task_42163_.ctx = ctx;
            futhark_mc_task_42163_.free_mem_40503 = mem_40503.mem;
            futhark_mc_task_42163_.free_gtid_40914 = gtid_40914;
            futhark_mc_task_42163_.free_mem_40916 = mem_40916;
            
            struct scheduler_segop futhark_mc_task_42163_task;
            
            futhark_mc_task_42163_task.args = &futhark_mc_task_42163_;
            futhark_mc_task_42163_task.top_level_fn = futhark_mc_copy_41779_task_42164;
            futhark_mc_task_42163_task.name = "futhark_mc_copy_41779_task_42164";
            futhark_mc_task_42163_task.iterations = iterations_41780;
            futhark_mc_task_42163_task.task_time = &ctx->program->futhark_mc_copy_41779_task_42164_total_time;
            futhark_mc_task_42163_task.task_iter = &ctx->program->futhark_mc_copy_41779_task_42164_total_iter;
            futhark_mc_task_42163_task.sched = STATIC;
            futhark_mc_task_42163_task.nested_fn = NULL;
            
            int futhark_mc_copy_41779_task_42164_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42163_task);
            
            if (futhark_mc_copy_41779_task_42164_err != 0) {
                ;
                err = futhark_mc_copy_41779_task_42164_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_40916);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42136_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42136_end - futhark_mc_segmap_parloop_42136_start;
        
        ctx->program->futhark_mc_segmap_parloop_42136_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42136_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42136_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42134(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42129 *futhark_mc_task_42129 = (struct futhark_mc_task_42129 *) args;
    struct futhark_context *ctx = futhark_mc_task_42129->ctx;
    uint64_t futhark_mc_segmap_nested_task_42134_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42134_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42129->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42129->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42129->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42129->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42129->free_x_35007;
    bool x_36099 = futhark_mc_task_42129->free_x_36099;
    bool x_37082 = futhark_mc_task_42129->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42129->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42129->free_x_38737;
    bool x_39417 = futhark_mc_task_42129->free_x_39417;
    bool x_40004 = futhark_mc_task_42129->free_x_40004;
    int8_t x_40502 = futhark_mc_task_42129->free_x_40502;
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_task_42129->free_mem_40503, .size =0, .references =NULL};
    int32_t nsubtasks_41244;
    
    nsubtasks_41244 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42135 futhark_mc_segmap_parloop_struct_42135_;
    
    futhark_mc_segmap_parloop_struct_42135_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42135_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42135_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42135_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42135_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42135_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42135_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42135_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42135_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42135_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42135_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42135_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42135_.free_x_40502 = x_40502;
    futhark_mc_segmap_parloop_struct_42135_.free_mem_40503 = mem_40503.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42136_task;
    
    futhark_mc_segmap_parloop_42136_task.name = "futhark_mc_segmap_parloop_42136";
    futhark_mc_segmap_parloop_42136_task.fn = futhark_mc_segmap_parloop_42136;
    futhark_mc_segmap_parloop_42136_task.args = &futhark_mc_segmap_parloop_struct_42135_;
    futhark_mc_segmap_parloop_42136_task.iterations = iterations;
    futhark_mc_segmap_parloop_42136_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42136_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42136_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42136_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42136_task);
    
    if (futhark_mc_segmap_parloop_42136_err != 0) {
        err = futhark_mc_segmap_parloop_42136_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42136_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42136_total_end - futhark_mc_segmap_parloop_42136_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42136_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42136_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42136_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42134_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42134_end - futhark_mc_segmap_nested_task_42134_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42134_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42134_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42134_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42167 {
    struct futhark_context *ctx;
    unsigned char *free_mem_40005;
    int64_t free_gtid_40501;
    unsigned char *free_mem_40503;
};
struct futhark_mc_copy_parloop_struct_42169 {
    struct futhark_context *ctx;
    unsigned char *free_mem_40005;
    int64_t free_gtid_40501;
    unsigned char *free_mem_40503;
};
static int futhark_mc_copy_parloop_42170(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42169 *futhark_mc_copy_parloop_struct_42169 = (struct futhark_mc_copy_parloop_struct_42169 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42169->ctx;
    uint64_t futhark_mc_copy_parloop_42170_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42170_start = get_wall_time();
    
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_copy_parloop_struct_42169->free_mem_40005, .size =0, .references =NULL};
    int64_t gtid_40501 = futhark_mc_copy_parloop_struct_42169->free_gtid_40501;
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_copy_parloop_struct_42169->free_mem_40503, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41781;
        int64_t end_41782;
        
        start_41781 = start;
        end_41782 = end;
        
        int64_t n_41783 = end_41782 - start_41781;
        
        for (int64_t copy_i_41784 = start_41781; copy_i_41784 < start_41781 + n_41783; copy_i_41784++) {
            int64_t slice_41788 = (int64_t) 2;
            int64_t slice_41789 = (int64_t) 2 * slice_41788;
            int64_t slice_41790 = (int64_t) 16 * slice_41789;
            int64_t i_41785 = squot64(copy_i_41784, slice_41789);
            int64_t remnant_41791 = copy_i_41784 - i_41785 * slice_41789;
            int64_t i_41786 = squot64(remnant_41791, slice_41788);
            int64_t remnant_41792 = remnant_41791 - i_41786 * slice_41788;
            int64_t i_41787 = remnant_41792;
            int64_t remnant_41793 = remnant_41792 - i_41787;
            bool tmp_41794 = ((bool *) mem_40503.mem)[i_41785 * (int64_t) 4 + i_41786 * (int64_t) 2 + i_41787];
            
            ((bool *) mem_40005.mem)[gtid_40501 * (int64_t) 64 + (i_41785 * (int64_t) 4 + i_41786 * (int64_t) 2 + i_41787)] = tmp_41794;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42170_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42170_end - futhark_mc_copy_parloop_42170_start;
        
        ctx->program->futhark_mc_copy_parloop_42170_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42170_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42170_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41795_task_42168(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42167 *futhark_mc_task_42167 = (struct futhark_mc_task_42167 *) args;
    struct futhark_context *ctx = futhark_mc_task_42167->ctx;
    uint64_t futhark_mc_copy_41795_task_42168_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41795_task_42168_start = get_wall_time();
    
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_task_42167->free_mem_40005, .size =0, .references =NULL};
    int64_t gtid_40501 = futhark_mc_task_42167->free_gtid_40501;
    struct memblock mem_40503 = {.desc ="mem_40503", .mem =futhark_mc_task_42167->free_mem_40503, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42169 futhark_mc_copy_parloop_struct_42169_;
    
    futhark_mc_copy_parloop_struct_42169_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42169_.free_mem_40005 = mem_40005.mem;
    futhark_mc_copy_parloop_struct_42169_.free_gtid_40501 = gtid_40501;
    futhark_mc_copy_parloop_struct_42169_.free_mem_40503 = mem_40503.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42170_task;
    
    futhark_mc_copy_parloop_42170_task.name = "futhark_mc_copy_parloop_42170";
    futhark_mc_copy_parloop_42170_task.fn = futhark_mc_copy_parloop_42170;
    futhark_mc_copy_parloop_42170_task.args = &futhark_mc_copy_parloop_struct_42169_;
    futhark_mc_copy_parloop_42170_task.iterations = iterations;
    futhark_mc_copy_parloop_42170_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42170_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42170_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42170_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42170_task);
    
    if (futhark_mc_copy_parloop_42170_err != 0) {
        err = futhark_mc_copy_parloop_42170_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42170_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42170_total_end - futhark_mc_copy_parloop_42170_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42170_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42170_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42170_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41795_task_42168_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41795_task_42168_end - futhark_mc_copy_41795_task_42168_start;
        
        ctx->program->futhark_mc_copy_41795_task_42168_runs[tid]++;
        ctx->program->futhark_mc_copy_41795_task_42168_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41795_task_42168_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42127(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42126 *futhark_mc_segmap_parloop_struct_42126 = (struct futhark_mc_segmap_parloop_struct_42126 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42126->ctx;
    uint64_t futhark_mc_segmap_parloop_42127_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42127_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42126->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42126->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42126->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42126->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42126->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42126->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42126->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42126->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42126->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42126->free_x_39417;
    bool x_40004 = futhark_mc_segmap_parloop_struct_42126->free_x_40004;
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_segmap_parloop_struct_42126->free_mem_40005, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_40503_cached_sizze_42128 = 0;
    unsigned char *mem_40503 = NULL;
    int64_t flat_tid_40500;
    
    flat_tid_40500 = subtask_id;
    {
        int64_t start_41167;
        int64_t end_41168;
        
        start_41167 = start;
        end_41168 = end;
        
        int64_t n_41169 = end_41168 - start_41167;
        
        if (mem_40503_cached_sizze_42128 < (int64_t) 64) {
            err = lexical_realloc(ctx, &mem_40503, &mem_40503_cached_sizze_42128, (int64_t) 64);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_41170 = start_41167; SegMap_i_41170 < start_41167 + n_41169; SegMap_i_41170++) {
            int64_t slice_41171 = (int64_t) 16;
            int64_t gtid_40501 = SegMap_i_41170;
            int64_t remnant_41172 = SegMap_i_41170 - gtid_40501;
            int8_t x_40502 = ((int8_t *) mem_30515.mem)[gtid_40501];
            int64_t flat_tid_41100 = (int64_t) 0;
            int64_t flat_tid_40913 = (int64_t) 0;
            struct futhark_mc_task_42129 futhark_mc_task_42129_;
            
            futhark_mc_task_42129_.ctx = ctx;
            futhark_mc_task_42129_.free_x_27583 = x_27583;
            futhark_mc_task_42129_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42129_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42129_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42129_.free_x_35007 = x_35007;
            futhark_mc_task_42129_.free_x_36099 = x_36099;
            futhark_mc_task_42129_.free_x_37082 = x_37082;
            futhark_mc_task_42129_.free_x_37960 = x_37960;
            futhark_mc_task_42129_.free_x_38737 = x_38737;
            futhark_mc_task_42129_.free_x_39417 = x_39417;
            futhark_mc_task_42129_.free_x_40004 = x_40004;
            futhark_mc_task_42129_.free_x_40502 = x_40502;
            futhark_mc_task_42129_.free_mem_40503 = mem_40503;
            
            struct scheduler_segop futhark_mc_task_42129_task;
            
            futhark_mc_task_42129_task.args = &futhark_mc_task_42129_;
            futhark_mc_task_42129_task.top_level_fn = futhark_mc_segmap_task_42130;
            futhark_mc_task_42129_task.name = "futhark_mc_segmap_task_42130";
            futhark_mc_task_42129_task.iterations = (int64_t) 16;
            futhark_mc_task_42129_task.task_time = &ctx->program->futhark_mc_segmap_task_42130_total_time;
            futhark_mc_task_42129_task.task_iter = &ctx->program->futhark_mc_segmap_task_42130_total_iter;
            futhark_mc_task_42129_task.sched = STATIC;
            futhark_mc_task_42129_task.nested_fn = futhark_mc_segmap_nested_task_42134;
            
            int futhark_mc_segmap_task_42130_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42129_task);
            
            if (futhark_mc_segmap_task_42130_err != 0) {
                ;
                err = futhark_mc_segmap_task_42130_err;
                goto cleanup;
            }
            
            int64_t iterations_41796 = (int64_t) 64;
            struct futhark_mc_task_42167 futhark_mc_task_42167_;
            
            futhark_mc_task_42167_.ctx = ctx;
            futhark_mc_task_42167_.free_mem_40005 = mem_40005.mem;
            futhark_mc_task_42167_.free_gtid_40501 = gtid_40501;
            futhark_mc_task_42167_.free_mem_40503 = mem_40503;
            
            struct scheduler_segop futhark_mc_task_42167_task;
            
            futhark_mc_task_42167_task.args = &futhark_mc_task_42167_;
            futhark_mc_task_42167_task.top_level_fn = futhark_mc_copy_41795_task_42168;
            futhark_mc_task_42167_task.name = "futhark_mc_copy_41795_task_42168";
            futhark_mc_task_42167_task.iterations = iterations_41796;
            futhark_mc_task_42167_task.task_time = &ctx->program->futhark_mc_copy_41795_task_42168_total_time;
            futhark_mc_task_42167_task.task_iter = &ctx->program->futhark_mc_copy_41795_task_42168_total_iter;
            futhark_mc_task_42167_task.sched = STATIC;
            futhark_mc_task_42167_task.nested_fn = NULL;
            
            int futhark_mc_copy_41795_task_42168_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42167_task);
            
            if (futhark_mc_copy_41795_task_42168_err != 0) {
                ;
                err = futhark_mc_copy_41795_task_42168_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_40503);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42127_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42127_end - futhark_mc_segmap_parloop_42127_start;
        
        ctx->program->futhark_mc_segmap_parloop_42127_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42127_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42127_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42125(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42120 *futhark_mc_task_42120 = (struct futhark_mc_task_42120 *) args;
    struct futhark_context *ctx = futhark_mc_task_42120->ctx;
    uint64_t futhark_mc_segmap_nested_task_42125_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42125_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42120->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42120->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42120->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42120->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42120->free_x_35007;
    bool x_36099 = futhark_mc_task_42120->free_x_36099;
    bool x_37082 = futhark_mc_task_42120->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42120->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42120->free_x_38737;
    bool x_39417 = futhark_mc_task_42120->free_x_39417;
    bool x_40004 = futhark_mc_task_42120->free_x_40004;
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_task_42120->free_mem_40005, .size =0, .references =NULL};
    int32_t nsubtasks_40912;
    
    nsubtasks_40912 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42126 futhark_mc_segmap_parloop_struct_42126_;
    
    futhark_mc_segmap_parloop_struct_42126_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42126_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42126_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42126_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42126_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42126_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42126_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42126_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42126_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42126_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42126_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42126_.free_x_40004 = x_40004;
    futhark_mc_segmap_parloop_struct_42126_.free_mem_40005 = mem_40005.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42127_task;
    
    futhark_mc_segmap_parloop_42127_task.name = "futhark_mc_segmap_parloop_42127";
    futhark_mc_segmap_parloop_42127_task.fn = futhark_mc_segmap_parloop_42127;
    futhark_mc_segmap_parloop_42127_task.args = &futhark_mc_segmap_parloop_struct_42126_;
    futhark_mc_segmap_parloop_42127_task.iterations = iterations;
    futhark_mc_segmap_parloop_42127_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42127_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42127_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42127_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42127_task);
    
    if (futhark_mc_segmap_parloop_42127_err != 0) {
        err = futhark_mc_segmap_parloop_42127_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42127_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42127_total_end - futhark_mc_segmap_parloop_42127_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42127_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42127_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42127_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42125_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42125_end - futhark_mc_segmap_nested_task_42125_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42125_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42125_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42125_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42171 {
    struct futhark_context *ctx;
    unsigned char *free_mem_39418;
    int64_t free_gtid_40003;
    unsigned char *free_mem_40005;
};
struct futhark_mc_copy_parloop_struct_42173 {
    struct futhark_context *ctx;
    unsigned char *free_mem_39418;
    int64_t free_gtid_40003;
    unsigned char *free_mem_40005;
};
static int futhark_mc_copy_parloop_42174(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42173 *futhark_mc_copy_parloop_struct_42173 = (struct futhark_mc_copy_parloop_struct_42173 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42173->ctx;
    uint64_t futhark_mc_copy_parloop_42174_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42174_start = get_wall_time();
    
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_copy_parloop_struct_42173->free_mem_39418, .size =0, .references =NULL};
    int64_t gtid_40003 = futhark_mc_copy_parloop_struct_42173->free_gtid_40003;
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_copy_parloop_struct_42173->free_mem_40005, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41797;
        int64_t end_41798;
        
        start_41797 = start;
        end_41798 = end;
        
        int64_t n_41799 = end_41798 - start_41797;
        
        for (int64_t copy_i_41800 = start_41797; copy_i_41800 < start_41797 + n_41799; copy_i_41800++) {
            int64_t slice_41805 = (int64_t) 2;
            int64_t slice_41806 = (int64_t) 2 * slice_41805;
            int64_t slice_41807 = (int64_t) 16 * slice_41806;
            int64_t slice_41808 = (int64_t) 16 * slice_41807;
            int64_t i_41801 = squot64(copy_i_41800, slice_41807);
            int64_t remnant_41809 = copy_i_41800 - i_41801 * slice_41807;
            int64_t i_41802 = squot64(remnant_41809, slice_41806);
            int64_t remnant_41810 = remnant_41809 - i_41802 * slice_41806;
            int64_t i_41803 = squot64(remnant_41810, slice_41805);
            int64_t remnant_41811 = remnant_41810 - i_41803 * slice_41805;
            int64_t i_41804 = remnant_41811;
            int64_t remnant_41812 = remnant_41811 - i_41804;
            bool tmp_41813 = ((bool *) mem_40005.mem)[i_41801 * (int64_t) 64 + i_41802 * (int64_t) 4 + i_41803 * (int64_t) 2 + i_41804];
            
            ((bool *) mem_39418.mem)[gtid_40003 * (int64_t) 1024 + (i_41801 * (int64_t) 64 + i_41802 * (int64_t) 4 + i_41803 * (int64_t) 2 + i_41804)] = tmp_41813;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42174_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42174_end - futhark_mc_copy_parloop_42174_start;
        
        ctx->program->futhark_mc_copy_parloop_42174_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42174_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42174_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41814_task_42172(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42171 *futhark_mc_task_42171 = (struct futhark_mc_task_42171 *) args;
    struct futhark_context *ctx = futhark_mc_task_42171->ctx;
    uint64_t futhark_mc_copy_41814_task_42172_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41814_task_42172_start = get_wall_time();
    
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_task_42171->free_mem_39418, .size =0, .references =NULL};
    int64_t gtid_40003 = futhark_mc_task_42171->free_gtid_40003;
    struct memblock mem_40005 = {.desc ="mem_40005", .mem =futhark_mc_task_42171->free_mem_40005, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42173 futhark_mc_copy_parloop_struct_42173_;
    
    futhark_mc_copy_parloop_struct_42173_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42173_.free_mem_39418 = mem_39418.mem;
    futhark_mc_copy_parloop_struct_42173_.free_gtid_40003 = gtid_40003;
    futhark_mc_copy_parloop_struct_42173_.free_mem_40005 = mem_40005.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42174_task;
    
    futhark_mc_copy_parloop_42174_task.name = "futhark_mc_copy_parloop_42174";
    futhark_mc_copy_parloop_42174_task.fn = futhark_mc_copy_parloop_42174;
    futhark_mc_copy_parloop_42174_task.args = &futhark_mc_copy_parloop_struct_42173_;
    futhark_mc_copy_parloop_42174_task.iterations = iterations;
    futhark_mc_copy_parloop_42174_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42174_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42174_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42174_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42174_task);
    
    if (futhark_mc_copy_parloop_42174_err != 0) {
        err = futhark_mc_copy_parloop_42174_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42174_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42174_total_end - futhark_mc_copy_parloop_42174_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42174_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42174_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42174_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41814_task_42172_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41814_task_42172_end - futhark_mc_copy_41814_task_42172_start;
        
        ctx->program->futhark_mc_copy_41814_task_42172_runs[tid]++;
        ctx->program->futhark_mc_copy_41814_task_42172_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41814_task_42172_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42118(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42117 *futhark_mc_segmap_parloop_struct_42117 = (struct futhark_mc_segmap_parloop_struct_42117 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42117->ctx;
    uint64_t futhark_mc_segmap_parloop_42118_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42118_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42117->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42117->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42117->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42117->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42117->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42117->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42117->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42117->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42117->free_x_38737;
    bool x_39417 = futhark_mc_segmap_parloop_struct_42117->free_x_39417;
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_segmap_parloop_struct_42117->free_mem_39418, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_40005_cached_sizze_42119 = 0;
    unsigned char *mem_40005 = NULL;
    int64_t flat_tid_40002;
    
    flat_tid_40002 = subtask_id;
    {
        int64_t start_40830;
        int64_t end_40831;
        
        start_40830 = start;
        end_40831 = end;
        
        int64_t n_40832 = end_40831 - start_40830;
        
        if (mem_40005_cached_sizze_42119 < (int64_t) 1024) {
            err = lexical_realloc(ctx, &mem_40005, &mem_40005_cached_sizze_42119, (int64_t) 1024);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_40833 = start_40830; SegMap_i_40833 < start_40830 + n_40832; SegMap_i_40833++) {
            int64_t slice_40834 = (int64_t) 2;
            int64_t gtid_40003 = SegMap_i_40833;
            int64_t remnant_40835 = SegMap_i_40833 - gtid_40003;
            bool x_40004 = ((bool *) mem_30513.mem)[gtid_40003];
            int64_t flat_tid_40759 = (int64_t) 0;
            int64_t flat_tid_40500 = (int64_t) 0;
            struct futhark_mc_task_42120 futhark_mc_task_42120_;
            
            futhark_mc_task_42120_.ctx = ctx;
            futhark_mc_task_42120_.free_x_27583 = x_27583;
            futhark_mc_task_42120_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42120_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42120_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42120_.free_x_35007 = x_35007;
            futhark_mc_task_42120_.free_x_36099 = x_36099;
            futhark_mc_task_42120_.free_x_37082 = x_37082;
            futhark_mc_task_42120_.free_x_37960 = x_37960;
            futhark_mc_task_42120_.free_x_38737 = x_38737;
            futhark_mc_task_42120_.free_x_39417 = x_39417;
            futhark_mc_task_42120_.free_x_40004 = x_40004;
            futhark_mc_task_42120_.free_mem_40005 = mem_40005;
            
            struct scheduler_segop futhark_mc_task_42120_task;
            
            futhark_mc_task_42120_task.args = &futhark_mc_task_42120_;
            futhark_mc_task_42120_task.top_level_fn = futhark_mc_segmap_task_42121;
            futhark_mc_task_42120_task.name = "futhark_mc_segmap_task_42121";
            futhark_mc_task_42120_task.iterations = (int64_t) 16;
            futhark_mc_task_42120_task.task_time = &ctx->program->futhark_mc_segmap_task_42121_total_time;
            futhark_mc_task_42120_task.task_iter = &ctx->program->futhark_mc_segmap_task_42121_total_iter;
            futhark_mc_task_42120_task.sched = STATIC;
            futhark_mc_task_42120_task.nested_fn = futhark_mc_segmap_nested_task_42125;
            
            int futhark_mc_segmap_task_42121_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42120_task);
            
            if (futhark_mc_segmap_task_42121_err != 0) {
                ;
                err = futhark_mc_segmap_task_42121_err;
                goto cleanup;
            }
            
            int64_t iterations_41815 = (int64_t) 1024;
            struct futhark_mc_task_42171 futhark_mc_task_42171_;
            
            futhark_mc_task_42171_.ctx = ctx;
            futhark_mc_task_42171_.free_mem_39418 = mem_39418.mem;
            futhark_mc_task_42171_.free_gtid_40003 = gtid_40003;
            futhark_mc_task_42171_.free_mem_40005 = mem_40005;
            
            struct scheduler_segop futhark_mc_task_42171_task;
            
            futhark_mc_task_42171_task.args = &futhark_mc_task_42171_;
            futhark_mc_task_42171_task.top_level_fn = futhark_mc_copy_41814_task_42172;
            futhark_mc_task_42171_task.name = "futhark_mc_copy_41814_task_42172";
            futhark_mc_task_42171_task.iterations = iterations_41815;
            futhark_mc_task_42171_task.task_time = &ctx->program->futhark_mc_copy_41814_task_42172_total_time;
            futhark_mc_task_42171_task.task_iter = &ctx->program->futhark_mc_copy_41814_task_42172_total_iter;
            futhark_mc_task_42171_task.sched = STATIC;
            futhark_mc_task_42171_task.nested_fn = NULL;
            
            int futhark_mc_copy_41814_task_42172_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42171_task);
            
            if (futhark_mc_copy_41814_task_42172_err != 0) {
                ;
                err = futhark_mc_copy_41814_task_42172_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_40005);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42118_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42118_end - futhark_mc_segmap_parloop_42118_start;
        
        ctx->program->futhark_mc_segmap_parloop_42118_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42118_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42118_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42116(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42111 *futhark_mc_task_42111 = (struct futhark_mc_task_42111 *) args;
    struct futhark_context *ctx = futhark_mc_task_42111->ctx;
    uint64_t futhark_mc_segmap_nested_task_42116_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42116_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42111->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42111->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42111->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42111->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42111->free_x_35007;
    bool x_36099 = futhark_mc_task_42111->free_x_36099;
    bool x_37082 = futhark_mc_task_42111->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42111->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42111->free_x_38737;
    bool x_39417 = futhark_mc_task_42111->free_x_39417;
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_task_42111->free_mem_39418, .size =0, .references =NULL};
    int32_t nsubtasks_40499;
    
    nsubtasks_40499 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42117 futhark_mc_segmap_parloop_struct_42117_;
    
    futhark_mc_segmap_parloop_struct_42117_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42117_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42117_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42117_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42117_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42117_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42117_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42117_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42117_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42117_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42117_.free_x_39417 = x_39417;
    futhark_mc_segmap_parloop_struct_42117_.free_mem_39418 = mem_39418.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42118_task;
    
    futhark_mc_segmap_parloop_42118_task.name = "futhark_mc_segmap_parloop_42118";
    futhark_mc_segmap_parloop_42118_task.fn = futhark_mc_segmap_parloop_42118;
    futhark_mc_segmap_parloop_42118_task.args = &futhark_mc_segmap_parloop_struct_42117_;
    futhark_mc_segmap_parloop_42118_task.iterations = iterations;
    futhark_mc_segmap_parloop_42118_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42118_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42118_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42118_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42118_task);
    
    if (futhark_mc_segmap_parloop_42118_err != 0) {
        err = futhark_mc_segmap_parloop_42118_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42118_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42118_total_end - futhark_mc_segmap_parloop_42118_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42118_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42118_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42118_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42116_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42116_end - futhark_mc_segmap_nested_task_42116_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42116_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42116_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42116_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42175 {
    struct futhark_context *ctx;
    unsigned char *free_mem_38738;
    int64_t free_gtid_39416;
    unsigned char *free_mem_39418;
};
struct futhark_mc_copy_parloop_struct_42177 {
    struct futhark_context *ctx;
    unsigned char *free_mem_38738;
    int64_t free_gtid_39416;
    unsigned char *free_mem_39418;
};
static int futhark_mc_copy_parloop_42178(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42177 *futhark_mc_copy_parloop_struct_42177 = (struct futhark_mc_copy_parloop_struct_42177 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42177->ctx;
    uint64_t futhark_mc_copy_parloop_42178_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42178_start = get_wall_time();
    
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_copy_parloop_struct_42177->free_mem_38738, .size =0, .references =NULL};
    int64_t gtid_39416 = futhark_mc_copy_parloop_struct_42177->free_gtid_39416;
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_copy_parloop_struct_42177->free_mem_39418, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41816;
        int64_t end_41817;
        
        start_41816 = start;
        end_41817 = end;
        
        int64_t n_41818 = end_41817 - start_41816;
        
        for (int64_t copy_i_41819 = start_41816; copy_i_41819 < start_41816 + n_41818; copy_i_41819++) {
            int64_t slice_41825 = (int64_t) 2;
            int64_t slice_41826 = (int64_t) 2 * slice_41825;
            int64_t slice_41827 = (int64_t) 16 * slice_41826;
            int64_t slice_41828 = (int64_t) 16 * slice_41827;
            int64_t slice_41829 = (int64_t) 2 * slice_41828;
            int64_t i_41820 = squot64(copy_i_41819, slice_41828);
            int64_t remnant_41830 = copy_i_41819 - i_41820 * slice_41828;
            int64_t i_41821 = squot64(remnant_41830, slice_41827);
            int64_t remnant_41831 = remnant_41830 - i_41821 * slice_41827;
            int64_t i_41822 = squot64(remnant_41831, slice_41826);
            int64_t remnant_41832 = remnant_41831 - i_41822 * slice_41826;
            int64_t i_41823 = squot64(remnant_41832, slice_41825);
            int64_t remnant_41833 = remnant_41832 - i_41823 * slice_41825;
            int64_t i_41824 = remnant_41833;
            int64_t remnant_41834 = remnant_41833 - i_41824;
            bool tmp_41835 = ((bool *) mem_39418.mem)[i_41820 * (int64_t) 1024 + i_41821 * (int64_t) 64 + i_41822 * (int64_t) 4 + i_41823 * (int64_t) 2 + i_41824];
            
            ((bool *) mem_38738.mem)[gtid_39416 * (int64_t) 2048 + (i_41820 * (int64_t) 1024 + i_41821 * (int64_t) 64 + i_41822 * (int64_t) 4 + i_41823 * (int64_t) 2 + i_41824)] = tmp_41835;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42178_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42178_end - futhark_mc_copy_parloop_42178_start;
        
        ctx->program->futhark_mc_copy_parloop_42178_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42178_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42178_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41836_task_42176(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42175 *futhark_mc_task_42175 = (struct futhark_mc_task_42175 *) args;
    struct futhark_context *ctx = futhark_mc_task_42175->ctx;
    uint64_t futhark_mc_copy_41836_task_42176_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41836_task_42176_start = get_wall_time();
    
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_task_42175->free_mem_38738, .size =0, .references =NULL};
    int64_t gtid_39416 = futhark_mc_task_42175->free_gtid_39416;
    struct memblock mem_39418 = {.desc ="mem_39418", .mem =futhark_mc_task_42175->free_mem_39418, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42177 futhark_mc_copy_parloop_struct_42177_;
    
    futhark_mc_copy_parloop_struct_42177_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42177_.free_mem_38738 = mem_38738.mem;
    futhark_mc_copy_parloop_struct_42177_.free_gtid_39416 = gtid_39416;
    futhark_mc_copy_parloop_struct_42177_.free_mem_39418 = mem_39418.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42178_task;
    
    futhark_mc_copy_parloop_42178_task.name = "futhark_mc_copy_parloop_42178";
    futhark_mc_copy_parloop_42178_task.fn = futhark_mc_copy_parloop_42178;
    futhark_mc_copy_parloop_42178_task.args = &futhark_mc_copy_parloop_struct_42177_;
    futhark_mc_copy_parloop_42178_task.iterations = iterations;
    futhark_mc_copy_parloop_42178_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42178_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42178_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42178_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42178_task);
    
    if (futhark_mc_copy_parloop_42178_err != 0) {
        err = futhark_mc_copy_parloop_42178_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42178_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42178_total_end - futhark_mc_copy_parloop_42178_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42178_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42178_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42178_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41836_task_42176_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41836_task_42176_end - futhark_mc_copy_41836_task_42176_start;
        
        ctx->program->futhark_mc_copy_41836_task_42176_runs[tid]++;
        ctx->program->futhark_mc_copy_41836_task_42176_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41836_task_42176_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42109(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42108 *futhark_mc_segmap_parloop_struct_42108 = (struct futhark_mc_segmap_parloop_struct_42108 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42108->ctx;
    uint64_t futhark_mc_segmap_parloop_42109_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42109_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42108->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42108->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42108->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42108->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42108->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42108->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42108->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42108->free_x_37960;
    int8_t x_38737 = futhark_mc_segmap_parloop_struct_42108->free_x_38737;
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_segmap_parloop_struct_42108->free_mem_38738, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_39418_cached_sizze_42110 = 0;
    unsigned char *mem_39418 = NULL;
    int64_t flat_tid_39415;
    
    flat_tid_39415 = subtask_id;
    {
        int64_t start_40412;
        int64_t end_40413;
        
        start_40412 = start;
        end_40413 = end;
        
        int64_t n_40414 = end_40413 - start_40412;
        
        if (mem_39418_cached_sizze_42110 < (int64_t) 2048) {
            err = lexical_realloc(ctx, &mem_39418, &mem_39418_cached_sizze_42110, (int64_t) 2048);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_40415 = start_40412; SegMap_i_40415 < start_40412 + n_40414; SegMap_i_40415++) {
            int64_t slice_40416 = (int64_t) 2;
            int64_t gtid_39416 = SegMap_i_40415;
            int64_t remnant_40417 = SegMap_i_40415 - gtid_39416;
            bool x_39417 = ((bool *) mem_30513.mem)[gtid_39416];
            int64_t flat_tid_40337 = (int64_t) 0;
            int64_t flat_tid_40002 = (int64_t) 0;
            struct futhark_mc_task_42111 futhark_mc_task_42111_;
            
            futhark_mc_task_42111_.ctx = ctx;
            futhark_mc_task_42111_.free_x_27583 = x_27583;
            futhark_mc_task_42111_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42111_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42111_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42111_.free_x_35007 = x_35007;
            futhark_mc_task_42111_.free_x_36099 = x_36099;
            futhark_mc_task_42111_.free_x_37082 = x_37082;
            futhark_mc_task_42111_.free_x_37960 = x_37960;
            futhark_mc_task_42111_.free_x_38737 = x_38737;
            futhark_mc_task_42111_.free_x_39417 = x_39417;
            futhark_mc_task_42111_.free_mem_39418 = mem_39418;
            
            struct scheduler_segop futhark_mc_task_42111_task;
            
            futhark_mc_task_42111_task.args = &futhark_mc_task_42111_;
            futhark_mc_task_42111_task.top_level_fn = futhark_mc_segmap_task_42112;
            futhark_mc_task_42111_task.name = "futhark_mc_segmap_task_42112";
            futhark_mc_task_42111_task.iterations = (int64_t) 2;
            futhark_mc_task_42111_task.task_time = &ctx->program->futhark_mc_segmap_task_42112_total_time;
            futhark_mc_task_42111_task.task_iter = &ctx->program->futhark_mc_segmap_task_42112_total_iter;
            futhark_mc_task_42111_task.sched = STATIC;
            futhark_mc_task_42111_task.nested_fn = futhark_mc_segmap_nested_task_42116;
            
            int futhark_mc_segmap_task_42112_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42111_task);
            
            if (futhark_mc_segmap_task_42112_err != 0) {
                ;
                err = futhark_mc_segmap_task_42112_err;
                goto cleanup;
            }
            
            int64_t iterations_41837 = (int64_t) 2048;
            struct futhark_mc_task_42175 futhark_mc_task_42175_;
            
            futhark_mc_task_42175_.ctx = ctx;
            futhark_mc_task_42175_.free_mem_38738 = mem_38738.mem;
            futhark_mc_task_42175_.free_gtid_39416 = gtid_39416;
            futhark_mc_task_42175_.free_mem_39418 = mem_39418;
            
            struct scheduler_segop futhark_mc_task_42175_task;
            
            futhark_mc_task_42175_task.args = &futhark_mc_task_42175_;
            futhark_mc_task_42175_task.top_level_fn = futhark_mc_copy_41836_task_42176;
            futhark_mc_task_42175_task.name = "futhark_mc_copy_41836_task_42176";
            futhark_mc_task_42175_task.iterations = iterations_41837;
            futhark_mc_task_42175_task.task_time = &ctx->program->futhark_mc_copy_41836_task_42176_total_time;
            futhark_mc_task_42175_task.task_iter = &ctx->program->futhark_mc_copy_41836_task_42176_total_iter;
            futhark_mc_task_42175_task.sched = STATIC;
            futhark_mc_task_42175_task.nested_fn = NULL;
            
            int futhark_mc_copy_41836_task_42176_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42175_task);
            
            if (futhark_mc_copy_41836_task_42176_err != 0) {
                ;
                err = futhark_mc_copy_41836_task_42176_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_39418);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42109_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42109_end - futhark_mc_segmap_parloop_42109_start;
        
        ctx->program->futhark_mc_segmap_parloop_42109_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42109_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42109_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42107(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42102 *futhark_mc_task_42102 = (struct futhark_mc_task_42102 *) args;
    struct futhark_context *ctx = futhark_mc_task_42102->ctx;
    uint64_t futhark_mc_segmap_nested_task_42107_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42107_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42102->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42102->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42102->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42102->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42102->free_x_35007;
    bool x_36099 = futhark_mc_task_42102->free_x_36099;
    bool x_37082 = futhark_mc_task_42102->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42102->free_x_37960;
    int8_t x_38737 = futhark_mc_task_42102->free_x_38737;
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_task_42102->free_mem_38738, .size =0, .references =NULL};
    int32_t nsubtasks_40001;
    
    nsubtasks_40001 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42108 futhark_mc_segmap_parloop_struct_42108_;
    
    futhark_mc_segmap_parloop_struct_42108_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42108_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42108_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42108_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42108_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42108_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42108_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42108_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42108_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42108_.free_x_38737 = x_38737;
    futhark_mc_segmap_parloop_struct_42108_.free_mem_38738 = mem_38738.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42109_task;
    
    futhark_mc_segmap_parloop_42109_task.name = "futhark_mc_segmap_parloop_42109";
    futhark_mc_segmap_parloop_42109_task.fn = futhark_mc_segmap_parloop_42109;
    futhark_mc_segmap_parloop_42109_task.args = &futhark_mc_segmap_parloop_struct_42108_;
    futhark_mc_segmap_parloop_42109_task.iterations = iterations;
    futhark_mc_segmap_parloop_42109_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42109_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42109_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42109_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42109_task);
    
    if (futhark_mc_segmap_parloop_42109_err != 0) {
        err = futhark_mc_segmap_parloop_42109_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42109_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42109_total_end - futhark_mc_segmap_parloop_42109_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42109_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42109_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42109_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42107_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42107_end - futhark_mc_segmap_nested_task_42107_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42107_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42107_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42107_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42179 {
    struct futhark_context *ctx;
    unsigned char *free_mem_37961;
    int64_t free_gtid_38736;
    unsigned char *free_mem_38738;
};
struct futhark_mc_copy_parloop_struct_42181 {
    struct futhark_context *ctx;
    unsigned char *free_mem_37961;
    int64_t free_gtid_38736;
    unsigned char *free_mem_38738;
};
static int futhark_mc_copy_parloop_42182(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42181 *futhark_mc_copy_parloop_struct_42181 = (struct futhark_mc_copy_parloop_struct_42181 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42181->ctx;
    uint64_t futhark_mc_copy_parloop_42182_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42182_start = get_wall_time();
    
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_copy_parloop_struct_42181->free_mem_37961, .size =0, .references =NULL};
    int64_t gtid_38736 = futhark_mc_copy_parloop_struct_42181->free_gtid_38736;
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_copy_parloop_struct_42181->free_mem_38738, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41838;
        int64_t end_41839;
        
        start_41838 = start;
        end_41839 = end;
        
        int64_t n_41840 = end_41839 - start_41838;
        
        for (int64_t copy_i_41841 = start_41838; copy_i_41841 < start_41838 + n_41840; copy_i_41841++) {
            int64_t slice_41848 = (int64_t) 2;
            int64_t slice_41849 = (int64_t) 2 * slice_41848;
            int64_t slice_41850 = (int64_t) 16 * slice_41849;
            int64_t slice_41851 = (int64_t) 16 * slice_41850;
            int64_t slice_41852 = (int64_t) 2 * slice_41851;
            int64_t slice_41853 = (int64_t) 2 * slice_41852;
            int64_t i_41842 = squot64(copy_i_41841, slice_41852);
            int64_t remnant_41854 = copy_i_41841 - i_41842 * slice_41852;
            int64_t i_41843 = squot64(remnant_41854, slice_41851);
            int64_t remnant_41855 = remnant_41854 - i_41843 * slice_41851;
            int64_t i_41844 = squot64(remnant_41855, slice_41850);
            int64_t remnant_41856 = remnant_41855 - i_41844 * slice_41850;
            int64_t i_41845 = squot64(remnant_41856, slice_41849);
            int64_t remnant_41857 = remnant_41856 - i_41845 * slice_41849;
            int64_t i_41846 = squot64(remnant_41857, slice_41848);
            int64_t remnant_41858 = remnant_41857 - i_41846 * slice_41848;
            int64_t i_41847 = remnant_41858;
            int64_t remnant_41859 = remnant_41858 - i_41847;
            bool tmp_41860 = ((bool *) mem_38738.mem)[i_41842 * (int64_t) 2048 + i_41843 * (int64_t) 1024 + i_41844 * (int64_t) 64 + i_41845 * (int64_t) 4 + i_41846 * (int64_t) 2 + i_41847];
            
            ((bool *) mem_37961.mem)[gtid_38736 * (int64_t) 4096 + (i_41842 * (int64_t) 2048 + i_41843 * (int64_t) 1024 + i_41844 * (int64_t) 64 + i_41845 * (int64_t) 4 + i_41846 * (int64_t) 2 + i_41847)] = tmp_41860;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42182_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42182_end - futhark_mc_copy_parloop_42182_start;
        
        ctx->program->futhark_mc_copy_parloop_42182_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42182_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42182_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41861_task_42180(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42179 *futhark_mc_task_42179 = (struct futhark_mc_task_42179 *) args;
    struct futhark_context *ctx = futhark_mc_task_42179->ctx;
    uint64_t futhark_mc_copy_41861_task_42180_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41861_task_42180_start = get_wall_time();
    
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_task_42179->free_mem_37961, .size =0, .references =NULL};
    int64_t gtid_38736 = futhark_mc_task_42179->free_gtid_38736;
    struct memblock mem_38738 = {.desc ="mem_38738", .mem =futhark_mc_task_42179->free_mem_38738, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42181 futhark_mc_copy_parloop_struct_42181_;
    
    futhark_mc_copy_parloop_struct_42181_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42181_.free_mem_37961 = mem_37961.mem;
    futhark_mc_copy_parloop_struct_42181_.free_gtid_38736 = gtid_38736;
    futhark_mc_copy_parloop_struct_42181_.free_mem_38738 = mem_38738.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42182_task;
    
    futhark_mc_copy_parloop_42182_task.name = "futhark_mc_copy_parloop_42182";
    futhark_mc_copy_parloop_42182_task.fn = futhark_mc_copy_parloop_42182;
    futhark_mc_copy_parloop_42182_task.args = &futhark_mc_copy_parloop_struct_42181_;
    futhark_mc_copy_parloop_42182_task.iterations = iterations;
    futhark_mc_copy_parloop_42182_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42182_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42182_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42182_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42182_task);
    
    if (futhark_mc_copy_parloop_42182_err != 0) {
        err = futhark_mc_copy_parloop_42182_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42182_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42182_total_end - futhark_mc_copy_parloop_42182_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42182_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42182_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42182_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41861_task_42180_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41861_task_42180_end - futhark_mc_copy_41861_task_42180_start;
        
        ctx->program->futhark_mc_copy_41861_task_42180_runs[tid]++;
        ctx->program->futhark_mc_copy_41861_task_42180_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41861_task_42180_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42100(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42099 *futhark_mc_segmap_parloop_struct_42099 = (struct futhark_mc_segmap_parloop_struct_42099 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42099->ctx;
    uint64_t futhark_mc_segmap_parloop_42100_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42100_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42099->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42099->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42099->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42099->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42099->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42099->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42099->free_x_37082;
    int8_t x_37960 = futhark_mc_segmap_parloop_struct_42099->free_x_37960;
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_segmap_parloop_struct_42099->free_mem_37961, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_38738_cached_sizze_42101 = 0;
    unsigned char *mem_38738 = NULL;
    int64_t flat_tid_38735;
    
    flat_tid_38735 = subtask_id;
    {
        int64_t start_39909;
        int64_t end_39910;
        
        start_39909 = start;
        end_39910 = end;
        
        int64_t n_39911 = end_39910 - start_39909;
        
        if (mem_38738_cached_sizze_42101 < (int64_t) 4096) {
            err = lexical_realloc(ctx, &mem_38738, &mem_38738_cached_sizze_42101, (int64_t) 4096);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_39912 = start_39909; SegMap_i_39912 < start_39909 + n_39911; SegMap_i_39912++) {
            int64_t slice_39913 = (int64_t) 16;
            int64_t gtid_38736 = SegMap_i_39912;
            int64_t remnant_39914 = SegMap_i_39912 - gtid_38736;
            int8_t x_38737 = ((int8_t *) mem_30515.mem)[gtid_38736];
            int64_t flat_tid_39830 = (int64_t) 0;
            int64_t flat_tid_39415 = (int64_t) 0;
            struct futhark_mc_task_42102 futhark_mc_task_42102_;
            
            futhark_mc_task_42102_.ctx = ctx;
            futhark_mc_task_42102_.free_x_27583 = x_27583;
            futhark_mc_task_42102_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42102_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42102_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42102_.free_x_35007 = x_35007;
            futhark_mc_task_42102_.free_x_36099 = x_36099;
            futhark_mc_task_42102_.free_x_37082 = x_37082;
            futhark_mc_task_42102_.free_x_37960 = x_37960;
            futhark_mc_task_42102_.free_x_38737 = x_38737;
            futhark_mc_task_42102_.free_mem_38738 = mem_38738;
            
            struct scheduler_segop futhark_mc_task_42102_task;
            
            futhark_mc_task_42102_task.args = &futhark_mc_task_42102_;
            futhark_mc_task_42102_task.top_level_fn = futhark_mc_segmap_task_42103;
            futhark_mc_task_42102_task.name = "futhark_mc_segmap_task_42103";
            futhark_mc_task_42102_task.iterations = (int64_t) 2;
            futhark_mc_task_42102_task.task_time = &ctx->program->futhark_mc_segmap_task_42103_total_time;
            futhark_mc_task_42102_task.task_iter = &ctx->program->futhark_mc_segmap_task_42103_total_iter;
            futhark_mc_task_42102_task.sched = STATIC;
            futhark_mc_task_42102_task.nested_fn = futhark_mc_segmap_nested_task_42107;
            
            int futhark_mc_segmap_task_42103_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42102_task);
            
            if (futhark_mc_segmap_task_42103_err != 0) {
                ;
                err = futhark_mc_segmap_task_42103_err;
                goto cleanup;
            }
            
            int64_t iterations_41862 = (int64_t) 4096;
            struct futhark_mc_task_42179 futhark_mc_task_42179_;
            
            futhark_mc_task_42179_.ctx = ctx;
            futhark_mc_task_42179_.free_mem_37961 = mem_37961.mem;
            futhark_mc_task_42179_.free_gtid_38736 = gtid_38736;
            futhark_mc_task_42179_.free_mem_38738 = mem_38738;
            
            struct scheduler_segop futhark_mc_task_42179_task;
            
            futhark_mc_task_42179_task.args = &futhark_mc_task_42179_;
            futhark_mc_task_42179_task.top_level_fn = futhark_mc_copy_41861_task_42180;
            futhark_mc_task_42179_task.name = "futhark_mc_copy_41861_task_42180";
            futhark_mc_task_42179_task.iterations = iterations_41862;
            futhark_mc_task_42179_task.task_time = &ctx->program->futhark_mc_copy_41861_task_42180_total_time;
            futhark_mc_task_42179_task.task_iter = &ctx->program->futhark_mc_copy_41861_task_42180_total_iter;
            futhark_mc_task_42179_task.sched = STATIC;
            futhark_mc_task_42179_task.nested_fn = NULL;
            
            int futhark_mc_copy_41861_task_42180_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42179_task);
            
            if (futhark_mc_copy_41861_task_42180_err != 0) {
                ;
                err = futhark_mc_copy_41861_task_42180_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_38738);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42100_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42100_end - futhark_mc_segmap_parloop_42100_start;
        
        ctx->program->futhark_mc_segmap_parloop_42100_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42100_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42100_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42098(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42093 *futhark_mc_task_42093 = (struct futhark_mc_task_42093 *) args;
    struct futhark_context *ctx = futhark_mc_task_42093->ctx;
    uint64_t futhark_mc_segmap_nested_task_42098_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42098_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42093->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42093->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42093->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42093->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42093->free_x_35007;
    bool x_36099 = futhark_mc_task_42093->free_x_36099;
    bool x_37082 = futhark_mc_task_42093->free_x_37082;
    int8_t x_37960 = futhark_mc_task_42093->free_x_37960;
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_task_42093->free_mem_37961, .size =0, .references =NULL};
    int32_t nsubtasks_39414;
    
    nsubtasks_39414 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42099 futhark_mc_segmap_parloop_struct_42099_;
    
    futhark_mc_segmap_parloop_struct_42099_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42099_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42099_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42099_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42099_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42099_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42099_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42099_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42099_.free_x_37960 = x_37960;
    futhark_mc_segmap_parloop_struct_42099_.free_mem_37961 = mem_37961.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42100_task;
    
    futhark_mc_segmap_parloop_42100_task.name = "futhark_mc_segmap_parloop_42100";
    futhark_mc_segmap_parloop_42100_task.fn = futhark_mc_segmap_parloop_42100;
    futhark_mc_segmap_parloop_42100_task.args = &futhark_mc_segmap_parloop_struct_42099_;
    futhark_mc_segmap_parloop_42100_task.iterations = iterations;
    futhark_mc_segmap_parloop_42100_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42100_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42100_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42100_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42100_task);
    
    if (futhark_mc_segmap_parloop_42100_err != 0) {
        err = futhark_mc_segmap_parloop_42100_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42100_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42100_total_end - futhark_mc_segmap_parloop_42100_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42100_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42100_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42100_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42098_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42098_end - futhark_mc_segmap_nested_task_42098_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42098_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42098_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42098_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42183 {
    struct futhark_context *ctx;
    unsigned char *free_mem_37083;
    int64_t free_gtid_37959;
    unsigned char *free_mem_37961;
};
struct futhark_mc_copy_parloop_struct_42185 {
    struct futhark_context *ctx;
    unsigned char *free_mem_37083;
    int64_t free_gtid_37959;
    unsigned char *free_mem_37961;
};
static int futhark_mc_copy_parloop_42186(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42185 *futhark_mc_copy_parloop_struct_42185 = (struct futhark_mc_copy_parloop_struct_42185 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42185->ctx;
    uint64_t futhark_mc_copy_parloop_42186_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42186_start = get_wall_time();
    
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_copy_parloop_struct_42185->free_mem_37083, .size =0, .references =NULL};
    int64_t gtid_37959 = futhark_mc_copy_parloop_struct_42185->free_gtid_37959;
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_copy_parloop_struct_42185->free_mem_37961, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41863;
        int64_t end_41864;
        
        start_41863 = start;
        end_41864 = end;
        
        int64_t n_41865 = end_41864 - start_41863;
        
        for (int64_t copy_i_41866 = start_41863; copy_i_41866 < start_41863 + n_41865; copy_i_41866++) {
            int64_t slice_41874 = (int64_t) 2;
            int64_t slice_41875 = (int64_t) 2 * slice_41874;
            int64_t slice_41876 = (int64_t) 16 * slice_41875;
            int64_t slice_41877 = (int64_t) 16 * slice_41876;
            int64_t slice_41878 = (int64_t) 2 * slice_41877;
            int64_t slice_41879 = (int64_t) 2 * slice_41878;
            int64_t slice_41880 = (int64_t) 16 * slice_41879;
            int64_t i_41867 = squot64(copy_i_41866, slice_41879);
            int64_t remnant_41881 = copy_i_41866 - i_41867 * slice_41879;
            int64_t i_41868 = squot64(remnant_41881, slice_41878);
            int64_t remnant_41882 = remnant_41881 - i_41868 * slice_41878;
            int64_t i_41869 = squot64(remnant_41882, slice_41877);
            int64_t remnant_41883 = remnant_41882 - i_41869 * slice_41877;
            int64_t i_41870 = squot64(remnant_41883, slice_41876);
            int64_t remnant_41884 = remnant_41883 - i_41870 * slice_41876;
            int64_t i_41871 = squot64(remnant_41884, slice_41875);
            int64_t remnant_41885 = remnant_41884 - i_41871 * slice_41875;
            int64_t i_41872 = squot64(remnant_41885, slice_41874);
            int64_t remnant_41886 = remnant_41885 - i_41872 * slice_41874;
            int64_t i_41873 = remnant_41886;
            int64_t remnant_41887 = remnant_41886 - i_41873;
            bool tmp_41888 = ((bool *) mem_37961.mem)[i_41867 * (int64_t) 4096 + i_41868 * (int64_t) 2048 + i_41869 * (int64_t) 1024 + i_41870 * (int64_t) 64 + i_41871 * (int64_t) 4 + i_41872 * (int64_t) 2 + i_41873];
            
            ((bool *) mem_37083.mem)[gtid_37959 * (int64_t) 65536 + (i_41867 * (int64_t) 4096 + i_41868 * (int64_t) 2048 + i_41869 * (int64_t) 1024 + i_41870 * (int64_t) 64 + i_41871 * (int64_t) 4 + i_41872 * (int64_t) 2 + i_41873)] = tmp_41888;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42186_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42186_end - futhark_mc_copy_parloop_42186_start;
        
        ctx->program->futhark_mc_copy_parloop_42186_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42186_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42186_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41889_task_42184(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42183 *futhark_mc_task_42183 = (struct futhark_mc_task_42183 *) args;
    struct futhark_context *ctx = futhark_mc_task_42183->ctx;
    uint64_t futhark_mc_copy_41889_task_42184_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41889_task_42184_start = get_wall_time();
    
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_task_42183->free_mem_37083, .size =0, .references =NULL};
    int64_t gtid_37959 = futhark_mc_task_42183->free_gtid_37959;
    struct memblock mem_37961 = {.desc ="mem_37961", .mem =futhark_mc_task_42183->free_mem_37961, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42185 futhark_mc_copy_parloop_struct_42185_;
    
    futhark_mc_copy_parloop_struct_42185_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42185_.free_mem_37083 = mem_37083.mem;
    futhark_mc_copy_parloop_struct_42185_.free_gtid_37959 = gtid_37959;
    futhark_mc_copy_parloop_struct_42185_.free_mem_37961 = mem_37961.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42186_task;
    
    futhark_mc_copy_parloop_42186_task.name = "futhark_mc_copy_parloop_42186";
    futhark_mc_copy_parloop_42186_task.fn = futhark_mc_copy_parloop_42186;
    futhark_mc_copy_parloop_42186_task.args = &futhark_mc_copy_parloop_struct_42185_;
    futhark_mc_copy_parloop_42186_task.iterations = iterations;
    futhark_mc_copy_parloop_42186_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42186_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42186_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42186_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42186_task);
    
    if (futhark_mc_copy_parloop_42186_err != 0) {
        err = futhark_mc_copy_parloop_42186_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42186_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42186_total_end - futhark_mc_copy_parloop_42186_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42186_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42186_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42186_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41889_task_42184_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41889_task_42184_end - futhark_mc_copy_41889_task_42184_start;
        
        ctx->program->futhark_mc_copy_41889_task_42184_runs[tid]++;
        ctx->program->futhark_mc_copy_41889_task_42184_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41889_task_42184_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42091(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42090 *futhark_mc_segmap_parloop_struct_42090 = (struct futhark_mc_segmap_parloop_struct_42090 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42090->ctx;
    uint64_t futhark_mc_segmap_parloop_42091_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42091_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42090->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42090->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42090->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42090->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42090->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42090->free_x_36099;
    bool x_37082 = futhark_mc_segmap_parloop_struct_42090->free_x_37082;
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_segmap_parloop_struct_42090->free_mem_37083, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_37961_cached_sizze_42092 = 0;
    unsigned char *mem_37961 = NULL;
    int64_t flat_tid_37958;
    
    flat_tid_37958 = subtask_id;
    {
        int64_t start_39317;
        int64_t end_39318;
        
        start_39317 = start;
        end_39318 = end;
        
        int64_t n_39319 = end_39318 - start_39317;
        
        if (mem_37961_cached_sizze_42092 < (int64_t) 65536) {
            err = lexical_realloc(ctx, &mem_37961, &mem_37961_cached_sizze_42092, (int64_t) 65536);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_39320 = start_39317; SegMap_i_39320 < start_39317 + n_39319; SegMap_i_39320++) {
            int64_t slice_39321 = (int64_t) 16;
            int64_t gtid_37959 = SegMap_i_39320;
            int64_t remnant_39322 = SegMap_i_39320 - gtid_37959;
            int8_t x_37960 = ((int8_t *) mem_30515.mem)[gtid_37959];
            int64_t flat_tid_39234 = (int64_t) 0;
            int64_t flat_tid_38735 = (int64_t) 0;
            struct futhark_mc_task_42093 futhark_mc_task_42093_;
            
            futhark_mc_task_42093_.ctx = ctx;
            futhark_mc_task_42093_.free_x_27583 = x_27583;
            futhark_mc_task_42093_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42093_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42093_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42093_.free_x_35007 = x_35007;
            futhark_mc_task_42093_.free_x_36099 = x_36099;
            futhark_mc_task_42093_.free_x_37082 = x_37082;
            futhark_mc_task_42093_.free_x_37960 = x_37960;
            futhark_mc_task_42093_.free_mem_37961 = mem_37961;
            
            struct scheduler_segop futhark_mc_task_42093_task;
            
            futhark_mc_task_42093_task.args = &futhark_mc_task_42093_;
            futhark_mc_task_42093_task.top_level_fn = futhark_mc_segmap_task_42094;
            futhark_mc_task_42093_task.name = "futhark_mc_segmap_task_42094";
            futhark_mc_task_42093_task.iterations = (int64_t) 16;
            futhark_mc_task_42093_task.task_time = &ctx->program->futhark_mc_segmap_task_42094_total_time;
            futhark_mc_task_42093_task.task_iter = &ctx->program->futhark_mc_segmap_task_42094_total_iter;
            futhark_mc_task_42093_task.sched = STATIC;
            futhark_mc_task_42093_task.nested_fn = futhark_mc_segmap_nested_task_42098;
            
            int futhark_mc_segmap_task_42094_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42093_task);
            
            if (futhark_mc_segmap_task_42094_err != 0) {
                ;
                err = futhark_mc_segmap_task_42094_err;
                goto cleanup;
            }
            
            int64_t iterations_41890 = (int64_t) 65536;
            struct futhark_mc_task_42183 futhark_mc_task_42183_;
            
            futhark_mc_task_42183_.ctx = ctx;
            futhark_mc_task_42183_.free_mem_37083 = mem_37083.mem;
            futhark_mc_task_42183_.free_gtid_37959 = gtid_37959;
            futhark_mc_task_42183_.free_mem_37961 = mem_37961;
            
            struct scheduler_segop futhark_mc_task_42183_task;
            
            futhark_mc_task_42183_task.args = &futhark_mc_task_42183_;
            futhark_mc_task_42183_task.top_level_fn = futhark_mc_copy_41889_task_42184;
            futhark_mc_task_42183_task.name = "futhark_mc_copy_41889_task_42184";
            futhark_mc_task_42183_task.iterations = iterations_41890;
            futhark_mc_task_42183_task.task_time = &ctx->program->futhark_mc_copy_41889_task_42184_total_time;
            futhark_mc_task_42183_task.task_iter = &ctx->program->futhark_mc_copy_41889_task_42184_total_iter;
            futhark_mc_task_42183_task.sched = STATIC;
            futhark_mc_task_42183_task.nested_fn = NULL;
            
            int futhark_mc_copy_41889_task_42184_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42183_task);
            
            if (futhark_mc_copy_41889_task_42184_err != 0) {
                ;
                err = futhark_mc_copy_41889_task_42184_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_37961);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42091_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42091_end - futhark_mc_segmap_parloop_42091_start;
        
        ctx->program->futhark_mc_segmap_parloop_42091_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42091_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42091_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42089(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42084 *futhark_mc_task_42084 = (struct futhark_mc_task_42084 *) args;
    struct futhark_context *ctx = futhark_mc_task_42084->ctx;
    uint64_t futhark_mc_segmap_nested_task_42089_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42089_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42084->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42084->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42084->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42084->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42084->free_x_35007;
    bool x_36099 = futhark_mc_task_42084->free_x_36099;
    bool x_37082 = futhark_mc_task_42084->free_x_37082;
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_task_42084->free_mem_37083, .size =0, .references =NULL};
    int32_t nsubtasks_38734;
    
    nsubtasks_38734 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42090 futhark_mc_segmap_parloop_struct_42090_;
    
    futhark_mc_segmap_parloop_struct_42090_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42090_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42090_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42090_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42090_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42090_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42090_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42090_.free_x_37082 = x_37082;
    futhark_mc_segmap_parloop_struct_42090_.free_mem_37083 = mem_37083.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42091_task;
    
    futhark_mc_segmap_parloop_42091_task.name = "futhark_mc_segmap_parloop_42091";
    futhark_mc_segmap_parloop_42091_task.fn = futhark_mc_segmap_parloop_42091;
    futhark_mc_segmap_parloop_42091_task.args = &futhark_mc_segmap_parloop_struct_42090_;
    futhark_mc_segmap_parloop_42091_task.iterations = iterations;
    futhark_mc_segmap_parloop_42091_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42091_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42091_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42091_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42091_task);
    
    if (futhark_mc_segmap_parloop_42091_err != 0) {
        err = futhark_mc_segmap_parloop_42091_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42091_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42091_total_end - futhark_mc_segmap_parloop_42091_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42091_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42091_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42091_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42089_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42089_end - futhark_mc_segmap_nested_task_42089_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42089_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42089_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42089_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42187 {
    struct futhark_context *ctx;
    unsigned char *free_mem_36100;
    int64_t free_gtid_37081;
    unsigned char *free_mem_37083;
};
struct futhark_mc_copy_parloop_struct_42189 {
    struct futhark_context *ctx;
    unsigned char *free_mem_36100;
    int64_t free_gtid_37081;
    unsigned char *free_mem_37083;
};
static int futhark_mc_copy_parloop_42190(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42189 *futhark_mc_copy_parloop_struct_42189 = (struct futhark_mc_copy_parloop_struct_42189 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42189->ctx;
    uint64_t futhark_mc_copy_parloop_42190_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42190_start = get_wall_time();
    
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_copy_parloop_struct_42189->free_mem_36100, .size =0, .references =NULL};
    int64_t gtid_37081 = futhark_mc_copy_parloop_struct_42189->free_gtid_37081;
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_copy_parloop_struct_42189->free_mem_37083, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41891;
        int64_t end_41892;
        
        start_41891 = start;
        end_41892 = end;
        
        int64_t n_41893 = end_41892 - start_41891;
        
        for (int64_t copy_i_41894 = start_41891; copy_i_41894 < start_41891 + n_41893; copy_i_41894++) {
            int64_t slice_41903 = (int64_t) 2;
            int64_t slice_41904 = (int64_t) 2 * slice_41903;
            int64_t slice_41905 = (int64_t) 16 * slice_41904;
            int64_t slice_41906 = (int64_t) 16 * slice_41905;
            int64_t slice_41907 = (int64_t) 2 * slice_41906;
            int64_t slice_41908 = (int64_t) 2 * slice_41907;
            int64_t slice_41909 = (int64_t) 16 * slice_41908;
            int64_t slice_41910 = (int64_t) 16 * slice_41909;
            int64_t i_41895 = squot64(copy_i_41894, slice_41909);
            int64_t remnant_41911 = copy_i_41894 - i_41895 * slice_41909;
            int64_t i_41896 = squot64(remnant_41911, slice_41908);
            int64_t remnant_41912 = remnant_41911 - i_41896 * slice_41908;
            int64_t i_41897 = squot64(remnant_41912, slice_41907);
            int64_t remnant_41913 = remnant_41912 - i_41897 * slice_41907;
            int64_t i_41898 = squot64(remnant_41913, slice_41906);
            int64_t remnant_41914 = remnant_41913 - i_41898 * slice_41906;
            int64_t i_41899 = squot64(remnant_41914, slice_41905);
            int64_t remnant_41915 = remnant_41914 - i_41899 * slice_41905;
            int64_t i_41900 = squot64(remnant_41915, slice_41904);
            int64_t remnant_41916 = remnant_41915 - i_41900 * slice_41904;
            int64_t i_41901 = squot64(remnant_41916, slice_41903);
            int64_t remnant_41917 = remnant_41916 - i_41901 * slice_41903;
            int64_t i_41902 = remnant_41917;
            int64_t remnant_41918 = remnant_41917 - i_41902;
            bool tmp_41919 = ((bool *) mem_37083.mem)[i_41895 * (int64_t) 65536 + i_41896 * (int64_t) 4096 + i_41897 * (int64_t) 2048 + i_41898 * (int64_t) 1024 + i_41899 * (int64_t) 64 + i_41900 * (int64_t) 4 + i_41901 * (int64_t) 2 + i_41902];
            
            ((bool *) mem_36100.mem)[gtid_37081 * (int64_t) 1048576 + (i_41895 * (int64_t) 65536 + i_41896 * (int64_t) 4096 + i_41897 * (int64_t) 2048 + i_41898 * (int64_t) 1024 + i_41899 * (int64_t) 64 + i_41900 * (int64_t) 4 + i_41901 * (int64_t) 2 + i_41902)] = tmp_41919;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42190_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42190_end - futhark_mc_copy_parloop_42190_start;
        
        ctx->program->futhark_mc_copy_parloop_42190_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42190_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42190_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41920_task_42188(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42187 *futhark_mc_task_42187 = (struct futhark_mc_task_42187 *) args;
    struct futhark_context *ctx = futhark_mc_task_42187->ctx;
    uint64_t futhark_mc_copy_41920_task_42188_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41920_task_42188_start = get_wall_time();
    
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_task_42187->free_mem_36100, .size =0, .references =NULL};
    int64_t gtid_37081 = futhark_mc_task_42187->free_gtid_37081;
    struct memblock mem_37083 = {.desc ="mem_37083", .mem =futhark_mc_task_42187->free_mem_37083, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42189 futhark_mc_copy_parloop_struct_42189_;
    
    futhark_mc_copy_parloop_struct_42189_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42189_.free_mem_36100 = mem_36100.mem;
    futhark_mc_copy_parloop_struct_42189_.free_gtid_37081 = gtid_37081;
    futhark_mc_copy_parloop_struct_42189_.free_mem_37083 = mem_37083.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42190_task;
    
    futhark_mc_copy_parloop_42190_task.name = "futhark_mc_copy_parloop_42190";
    futhark_mc_copy_parloop_42190_task.fn = futhark_mc_copy_parloop_42190;
    futhark_mc_copy_parloop_42190_task.args = &futhark_mc_copy_parloop_struct_42189_;
    futhark_mc_copy_parloop_42190_task.iterations = iterations;
    futhark_mc_copy_parloop_42190_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42190_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42190_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42190_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42190_task);
    
    if (futhark_mc_copy_parloop_42190_err != 0) {
        err = futhark_mc_copy_parloop_42190_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42190_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42190_total_end - futhark_mc_copy_parloop_42190_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42190_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42190_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42190_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41920_task_42188_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41920_task_42188_end - futhark_mc_copy_41920_task_42188_start;
        
        ctx->program->futhark_mc_copy_41920_task_42188_runs[tid]++;
        ctx->program->futhark_mc_copy_41920_task_42188_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41920_task_42188_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42082(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42081 *futhark_mc_segmap_parloop_struct_42081 = (struct futhark_mc_segmap_parloop_struct_42081 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42081->ctx;
    uint64_t futhark_mc_segmap_parloop_42082_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42082_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42081->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42081->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42081->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42081->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42081->free_x_35007;
    bool x_36099 = futhark_mc_segmap_parloop_struct_42081->free_x_36099;
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_segmap_parloop_struct_42081->free_mem_36100, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_37083_cached_sizze_42083 = 0;
    unsigned char *mem_37083 = NULL;
    int64_t flat_tid_37080;
    
    flat_tid_37080 = subtask_id;
    {
        int64_t start_38632;
        int64_t end_38633;
        
        start_38632 = start;
        end_38633 = end;
        
        int64_t n_38634 = end_38633 - start_38632;
        
        if (mem_37083_cached_sizze_42083 < (int64_t) 1048576) {
            err = lexical_realloc(ctx, &mem_37083, &mem_37083_cached_sizze_42083, (int64_t) 1048576);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_38635 = start_38632; SegMap_i_38635 < start_38632 + n_38634; SegMap_i_38635++) {
            int64_t slice_38636 = (int64_t) 2;
            int64_t gtid_37081 = SegMap_i_38635;
            int64_t remnant_38637 = SegMap_i_38635 - gtid_37081;
            bool x_37082 = ((bool *) mem_30513.mem)[gtid_37081];
            int64_t flat_tid_38545 = (int64_t) 0;
            int64_t flat_tid_37958 = (int64_t) 0;
            struct futhark_mc_task_42084 futhark_mc_task_42084_;
            
            futhark_mc_task_42084_.ctx = ctx;
            futhark_mc_task_42084_.free_x_27583 = x_27583;
            futhark_mc_task_42084_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42084_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42084_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42084_.free_x_35007 = x_35007;
            futhark_mc_task_42084_.free_x_36099 = x_36099;
            futhark_mc_task_42084_.free_x_37082 = x_37082;
            futhark_mc_task_42084_.free_mem_37083 = mem_37083;
            
            struct scheduler_segop futhark_mc_task_42084_task;
            
            futhark_mc_task_42084_task.args = &futhark_mc_task_42084_;
            futhark_mc_task_42084_task.top_level_fn = futhark_mc_segmap_task_42085;
            futhark_mc_task_42084_task.name = "futhark_mc_segmap_task_42085";
            futhark_mc_task_42084_task.iterations = (int64_t) 16;
            futhark_mc_task_42084_task.task_time = &ctx->program->futhark_mc_segmap_task_42085_total_time;
            futhark_mc_task_42084_task.task_iter = &ctx->program->futhark_mc_segmap_task_42085_total_iter;
            futhark_mc_task_42084_task.sched = STATIC;
            futhark_mc_task_42084_task.nested_fn = futhark_mc_segmap_nested_task_42089;
            
            int futhark_mc_segmap_task_42085_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42084_task);
            
            if (futhark_mc_segmap_task_42085_err != 0) {
                ;
                err = futhark_mc_segmap_task_42085_err;
                goto cleanup;
            }
            
            int64_t iterations_41921 = (int64_t) 1048576;
            struct futhark_mc_task_42187 futhark_mc_task_42187_;
            
            futhark_mc_task_42187_.ctx = ctx;
            futhark_mc_task_42187_.free_mem_36100 = mem_36100.mem;
            futhark_mc_task_42187_.free_gtid_37081 = gtid_37081;
            futhark_mc_task_42187_.free_mem_37083 = mem_37083;
            
            struct scheduler_segop futhark_mc_task_42187_task;
            
            futhark_mc_task_42187_task.args = &futhark_mc_task_42187_;
            futhark_mc_task_42187_task.top_level_fn = futhark_mc_copy_41920_task_42188;
            futhark_mc_task_42187_task.name = "futhark_mc_copy_41920_task_42188";
            futhark_mc_task_42187_task.iterations = iterations_41921;
            futhark_mc_task_42187_task.task_time = &ctx->program->futhark_mc_copy_41920_task_42188_total_time;
            futhark_mc_task_42187_task.task_iter = &ctx->program->futhark_mc_copy_41920_task_42188_total_iter;
            futhark_mc_task_42187_task.sched = STATIC;
            futhark_mc_task_42187_task.nested_fn = NULL;
            
            int futhark_mc_copy_41920_task_42188_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42187_task);
            
            if (futhark_mc_copy_41920_task_42188_err != 0) {
                ;
                err = futhark_mc_copy_41920_task_42188_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_37083);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42082_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42082_end - futhark_mc_segmap_parloop_42082_start;
        
        ctx->program->futhark_mc_segmap_parloop_42082_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42082_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42082_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42080(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42075 *futhark_mc_task_42075 = (struct futhark_mc_task_42075 *) args;
    struct futhark_context *ctx = futhark_mc_task_42075->ctx;
    uint64_t futhark_mc_segmap_nested_task_42080_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42080_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42075->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42075->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42075->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42075->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42075->free_x_35007;
    bool x_36099 = futhark_mc_task_42075->free_x_36099;
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_task_42075->free_mem_36100, .size =0, .references =NULL};
    int32_t nsubtasks_37957;
    
    nsubtasks_37957 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42081 futhark_mc_segmap_parloop_struct_42081_;
    
    futhark_mc_segmap_parloop_struct_42081_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42081_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42081_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42081_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42081_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42081_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42081_.free_x_36099 = x_36099;
    futhark_mc_segmap_parloop_struct_42081_.free_mem_36100 = mem_36100.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42082_task;
    
    futhark_mc_segmap_parloop_42082_task.name = "futhark_mc_segmap_parloop_42082";
    futhark_mc_segmap_parloop_42082_task.fn = futhark_mc_segmap_parloop_42082;
    futhark_mc_segmap_parloop_42082_task.args = &futhark_mc_segmap_parloop_struct_42081_;
    futhark_mc_segmap_parloop_42082_task.iterations = iterations;
    futhark_mc_segmap_parloop_42082_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42082_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42082_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42082_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42082_task);
    
    if (futhark_mc_segmap_parloop_42082_err != 0) {
        err = futhark_mc_segmap_parloop_42082_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42082_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42082_total_end - futhark_mc_segmap_parloop_42082_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42082_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42082_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42082_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42080_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42080_end - futhark_mc_segmap_nested_task_42080_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42080_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42080_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42080_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42191 {
    struct futhark_context *ctx;
    unsigned char *free_mem_35008;
    int64_t free_gtid_36098;
    unsigned char *free_mem_36100;
};
struct futhark_mc_copy_parloop_struct_42193 {
    struct futhark_context *ctx;
    unsigned char *free_mem_35008;
    int64_t free_gtid_36098;
    unsigned char *free_mem_36100;
};
static int futhark_mc_copy_parloop_42194(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42193 *futhark_mc_copy_parloop_struct_42193 = (struct futhark_mc_copy_parloop_struct_42193 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42193->ctx;
    uint64_t futhark_mc_copy_parloop_42194_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42194_start = get_wall_time();
    
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_copy_parloop_struct_42193->free_mem_35008, .size =0, .references =NULL};
    int64_t gtid_36098 = futhark_mc_copy_parloop_struct_42193->free_gtid_36098;
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_copy_parloop_struct_42193->free_mem_36100, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41922;
        int64_t end_41923;
        
        start_41922 = start;
        end_41923 = end;
        
        int64_t n_41924 = end_41923 - start_41922;
        
        for (int64_t copy_i_41925 = start_41922; copy_i_41925 < start_41922 + n_41924; copy_i_41925++) {
            int64_t slice_41935 = (int64_t) 2;
            int64_t slice_41936 = (int64_t) 2 * slice_41935;
            int64_t slice_41937 = (int64_t) 16 * slice_41936;
            int64_t slice_41938 = (int64_t) 16 * slice_41937;
            int64_t slice_41939 = (int64_t) 2 * slice_41938;
            int64_t slice_41940 = (int64_t) 2 * slice_41939;
            int64_t slice_41941 = (int64_t) 16 * slice_41940;
            int64_t slice_41942 = (int64_t) 16 * slice_41941;
            int64_t slice_41943 = (int64_t) 2 * slice_41942;
            int64_t i_41926 = squot64(copy_i_41925, slice_41942);
            int64_t remnant_41944 = copy_i_41925 - i_41926 * slice_41942;
            int64_t i_41927 = squot64(remnant_41944, slice_41941);
            int64_t remnant_41945 = remnant_41944 - i_41927 * slice_41941;
            int64_t i_41928 = squot64(remnant_41945, slice_41940);
            int64_t remnant_41946 = remnant_41945 - i_41928 * slice_41940;
            int64_t i_41929 = squot64(remnant_41946, slice_41939);
            int64_t remnant_41947 = remnant_41946 - i_41929 * slice_41939;
            int64_t i_41930 = squot64(remnant_41947, slice_41938);
            int64_t remnant_41948 = remnant_41947 - i_41930 * slice_41938;
            int64_t i_41931 = squot64(remnant_41948, slice_41937);
            int64_t remnant_41949 = remnant_41948 - i_41931 * slice_41937;
            int64_t i_41932 = squot64(remnant_41949, slice_41936);
            int64_t remnant_41950 = remnant_41949 - i_41932 * slice_41936;
            int64_t i_41933 = squot64(remnant_41950, slice_41935);
            int64_t remnant_41951 = remnant_41950 - i_41933 * slice_41935;
            int64_t i_41934 = remnant_41951;
            int64_t remnant_41952 = remnant_41951 - i_41934;
            bool tmp_41953 = ((bool *) mem_36100.mem)[i_41926 * (int64_t) 1048576 + i_41927 * (int64_t) 65536 + i_41928 * (int64_t) 4096 + i_41929 * (int64_t) 2048 + i_41930 * (int64_t) 1024 + i_41931 * (int64_t) 64 + i_41932 * (int64_t) 4 + i_41933 * (int64_t) 2 + i_41934];
            
            ((bool *) mem_35008.mem)[gtid_36098 * (int64_t) 2097152 + (i_41926 * (int64_t) 1048576 + i_41927 * (int64_t) 65536 + i_41928 * (int64_t) 4096 + i_41929 * (int64_t) 2048 + i_41930 * (int64_t) 1024 + i_41931 * (int64_t) 64 + i_41932 * (int64_t) 4 + i_41933 * (int64_t) 2 + i_41934)] = tmp_41953;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42194_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42194_end - futhark_mc_copy_parloop_42194_start;
        
        ctx->program->futhark_mc_copy_parloop_42194_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42194_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42194_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41954_task_42192(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42191 *futhark_mc_task_42191 = (struct futhark_mc_task_42191 *) args;
    struct futhark_context *ctx = futhark_mc_task_42191->ctx;
    uint64_t futhark_mc_copy_41954_task_42192_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41954_task_42192_start = get_wall_time();
    
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_task_42191->free_mem_35008, .size =0, .references =NULL};
    int64_t gtid_36098 = futhark_mc_task_42191->free_gtid_36098;
    struct memblock mem_36100 = {.desc ="mem_36100", .mem =futhark_mc_task_42191->free_mem_36100, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42193 futhark_mc_copy_parloop_struct_42193_;
    
    futhark_mc_copy_parloop_struct_42193_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42193_.free_mem_35008 = mem_35008.mem;
    futhark_mc_copy_parloop_struct_42193_.free_gtid_36098 = gtid_36098;
    futhark_mc_copy_parloop_struct_42193_.free_mem_36100 = mem_36100.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42194_task;
    
    futhark_mc_copy_parloop_42194_task.name = "futhark_mc_copy_parloop_42194";
    futhark_mc_copy_parloop_42194_task.fn = futhark_mc_copy_parloop_42194;
    futhark_mc_copy_parloop_42194_task.args = &futhark_mc_copy_parloop_struct_42193_;
    futhark_mc_copy_parloop_42194_task.iterations = iterations;
    futhark_mc_copy_parloop_42194_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42194_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42194_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42194_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42194_task);
    
    if (futhark_mc_copy_parloop_42194_err != 0) {
        err = futhark_mc_copy_parloop_42194_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42194_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42194_total_end - futhark_mc_copy_parloop_42194_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42194_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42194_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42194_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41954_task_42192_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41954_task_42192_end - futhark_mc_copy_41954_task_42192_start;
        
        ctx->program->futhark_mc_copy_41954_task_42192_runs[tid]++;
        ctx->program->futhark_mc_copy_41954_task_42192_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41954_task_42192_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42073(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42072 *futhark_mc_segmap_parloop_struct_42072 = (struct futhark_mc_segmap_parloop_struct_42072 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42072->ctx;
    uint64_t futhark_mc_segmap_parloop_42073_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42073_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42072->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42072->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42072->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42072->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_segmap_parloop_struct_42072->free_x_35007;
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_segmap_parloop_struct_42072->free_mem_35008, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_36100_cached_sizze_42074 = 0;
    unsigned char *mem_36100 = NULL;
    int64_t flat_tid_36097;
    
    flat_tid_36097 = subtask_id;
    {
        int64_t start_37850;
        int64_t end_37851;
        
        start_37850 = start;
        end_37851 = end;
        
        int64_t n_37852 = end_37851 - start_37850;
        
        if (mem_36100_cached_sizze_42074 < (int64_t) 2097152) {
            err = lexical_realloc(ctx, &mem_36100, &mem_36100_cached_sizze_42074, (int64_t) 2097152);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_37853 = start_37850; SegMap_i_37853 < start_37850 + n_37852; SegMap_i_37853++) {
            int64_t slice_37854 = (int64_t) 2;
            int64_t gtid_36098 = SegMap_i_37853;
            int64_t remnant_37855 = SegMap_i_37853 - gtid_36098;
            bool x_36099 = ((bool *) mem_30513.mem)[gtid_36098];
            int64_t flat_tid_37759 = (int64_t) 0;
            int64_t flat_tid_37080 = (int64_t) 0;
            struct futhark_mc_task_42075 futhark_mc_task_42075_;
            
            futhark_mc_task_42075_.ctx = ctx;
            futhark_mc_task_42075_.free_x_27583 = x_27583;
            futhark_mc_task_42075_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42075_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42075_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42075_.free_x_35007 = x_35007;
            futhark_mc_task_42075_.free_x_36099 = x_36099;
            futhark_mc_task_42075_.free_mem_36100 = mem_36100;
            
            struct scheduler_segop futhark_mc_task_42075_task;
            
            futhark_mc_task_42075_task.args = &futhark_mc_task_42075_;
            futhark_mc_task_42075_task.top_level_fn = futhark_mc_segmap_task_42076;
            futhark_mc_task_42075_task.name = "futhark_mc_segmap_task_42076";
            futhark_mc_task_42075_task.iterations = (int64_t) 2;
            futhark_mc_task_42075_task.task_time = &ctx->program->futhark_mc_segmap_task_42076_total_time;
            futhark_mc_task_42075_task.task_iter = &ctx->program->futhark_mc_segmap_task_42076_total_iter;
            futhark_mc_task_42075_task.sched = STATIC;
            futhark_mc_task_42075_task.nested_fn = futhark_mc_segmap_nested_task_42080;
            
            int futhark_mc_segmap_task_42076_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42075_task);
            
            if (futhark_mc_segmap_task_42076_err != 0) {
                ;
                err = futhark_mc_segmap_task_42076_err;
                goto cleanup;
            }
            
            int64_t iterations_41955 = (int64_t) 2097152;
            struct futhark_mc_task_42191 futhark_mc_task_42191_;
            
            futhark_mc_task_42191_.ctx = ctx;
            futhark_mc_task_42191_.free_mem_35008 = mem_35008.mem;
            futhark_mc_task_42191_.free_gtid_36098 = gtid_36098;
            futhark_mc_task_42191_.free_mem_36100 = mem_36100;
            
            struct scheduler_segop futhark_mc_task_42191_task;
            
            futhark_mc_task_42191_task.args = &futhark_mc_task_42191_;
            futhark_mc_task_42191_task.top_level_fn = futhark_mc_copy_41954_task_42192;
            futhark_mc_task_42191_task.name = "futhark_mc_copy_41954_task_42192";
            futhark_mc_task_42191_task.iterations = iterations_41955;
            futhark_mc_task_42191_task.task_time = &ctx->program->futhark_mc_copy_41954_task_42192_total_time;
            futhark_mc_task_42191_task.task_iter = &ctx->program->futhark_mc_copy_41954_task_42192_total_iter;
            futhark_mc_task_42191_task.sched = STATIC;
            futhark_mc_task_42191_task.nested_fn = NULL;
            
            int futhark_mc_copy_41954_task_42192_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42191_task);
            
            if (futhark_mc_copy_41954_task_42192_err != 0) {
                ;
                err = futhark_mc_copy_41954_task_42192_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_36100);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42073_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42073_end - futhark_mc_segmap_parloop_42073_start;
        
        ctx->program->futhark_mc_segmap_parloop_42073_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42073_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42073_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42071(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42066 *futhark_mc_task_42066 = (struct futhark_mc_task_42066 *) args;
    struct futhark_context *ctx = futhark_mc_task_42066->ctx;
    uint64_t futhark_mc_segmap_nested_task_42071_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42071_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42066->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42066->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42066->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42066->free_mem_30517, .size =0, .references =NULL};
    int8_t x_35007 = futhark_mc_task_42066->free_x_35007;
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_task_42066->free_mem_35008, .size =0, .references =NULL};
    int32_t nsubtasks_37079;
    
    nsubtasks_37079 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42072 futhark_mc_segmap_parloop_struct_42072_;
    
    futhark_mc_segmap_parloop_struct_42072_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42072_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42072_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42072_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42072_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42072_.free_x_35007 = x_35007;
    futhark_mc_segmap_parloop_struct_42072_.free_mem_35008 = mem_35008.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42073_task;
    
    futhark_mc_segmap_parloop_42073_task.name = "futhark_mc_segmap_parloop_42073";
    futhark_mc_segmap_parloop_42073_task.fn = futhark_mc_segmap_parloop_42073;
    futhark_mc_segmap_parloop_42073_task.args = &futhark_mc_segmap_parloop_struct_42072_;
    futhark_mc_segmap_parloop_42073_task.iterations = iterations;
    futhark_mc_segmap_parloop_42073_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42073_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42073_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42073_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42073_task);
    
    if (futhark_mc_segmap_parloop_42073_err != 0) {
        err = futhark_mc_segmap_parloop_42073_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42073_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42073_total_end - futhark_mc_segmap_parloop_42073_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42073_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42073_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42073_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42071_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42071_end - futhark_mc_segmap_nested_task_42071_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42071_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42071_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42071_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42195 {
    struct futhark_context *ctx;
    unsigned char *free_mem_33839;
    int64_t free_gtid_35006;
    unsigned char *free_mem_35008;
};
struct futhark_mc_copy_parloop_struct_42197 {
    struct futhark_context *ctx;
    unsigned char *free_mem_33839;
    int64_t free_gtid_35006;
    unsigned char *free_mem_35008;
};
static int futhark_mc_copy_parloop_42198(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42197 *futhark_mc_copy_parloop_struct_42197 = (struct futhark_mc_copy_parloop_struct_42197 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42197->ctx;
    uint64_t futhark_mc_copy_parloop_42198_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42198_start = get_wall_time();
    
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_copy_parloop_struct_42197->free_mem_33839, .size =0, .references =NULL};
    int64_t gtid_35006 = futhark_mc_copy_parloop_struct_42197->free_gtid_35006;
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_copy_parloop_struct_42197->free_mem_35008, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41956;
        int64_t end_41957;
        
        start_41956 = start;
        end_41957 = end;
        
        int64_t n_41958 = end_41957 - start_41956;
        
        for (int64_t copy_i_41959 = start_41956; copy_i_41959 < start_41956 + n_41958; copy_i_41959++) {
            int64_t slice_41970 = (int64_t) 2;
            int64_t slice_41971 = (int64_t) 2 * slice_41970;
            int64_t slice_41972 = (int64_t) 16 * slice_41971;
            int64_t slice_41973 = (int64_t) 16 * slice_41972;
            int64_t slice_41974 = (int64_t) 2 * slice_41973;
            int64_t slice_41975 = (int64_t) 2 * slice_41974;
            int64_t slice_41976 = (int64_t) 16 * slice_41975;
            int64_t slice_41977 = (int64_t) 16 * slice_41976;
            int64_t slice_41978 = (int64_t) 2 * slice_41977;
            int64_t slice_41979 = (int64_t) 2 * slice_41978;
            int64_t i_41960 = squot64(copy_i_41959, slice_41978);
            int64_t remnant_41980 = copy_i_41959 - i_41960 * slice_41978;
            int64_t i_41961 = squot64(remnant_41980, slice_41977);
            int64_t remnant_41981 = remnant_41980 - i_41961 * slice_41977;
            int64_t i_41962 = squot64(remnant_41981, slice_41976);
            int64_t remnant_41982 = remnant_41981 - i_41962 * slice_41976;
            int64_t i_41963 = squot64(remnant_41982, slice_41975);
            int64_t remnant_41983 = remnant_41982 - i_41963 * slice_41975;
            int64_t i_41964 = squot64(remnant_41983, slice_41974);
            int64_t remnant_41984 = remnant_41983 - i_41964 * slice_41974;
            int64_t i_41965 = squot64(remnant_41984, slice_41973);
            int64_t remnant_41985 = remnant_41984 - i_41965 * slice_41973;
            int64_t i_41966 = squot64(remnant_41985, slice_41972);
            int64_t remnant_41986 = remnant_41985 - i_41966 * slice_41972;
            int64_t i_41967 = squot64(remnant_41986, slice_41971);
            int64_t remnant_41987 = remnant_41986 - i_41967 * slice_41971;
            int64_t i_41968 = squot64(remnant_41987, slice_41970);
            int64_t remnant_41988 = remnant_41987 - i_41968 * slice_41970;
            int64_t i_41969 = remnant_41988;
            int64_t remnant_41989 = remnant_41988 - i_41969;
            bool tmp_41990 = ((bool *) mem_35008.mem)[i_41960 * (int64_t) 2097152 + i_41961 * (int64_t) 1048576 + i_41962 * (int64_t) 65536 + i_41963 * (int64_t) 4096 + i_41964 * (int64_t) 2048 + i_41965 * (int64_t) 1024 + i_41966 * (int64_t) 64 + i_41967 * (int64_t) 4 + i_41968 * (int64_t) 2 + i_41969];
            
            ((bool *) mem_33839.mem)[gtid_35006 * (int64_t) 4194304 + (i_41960 * (int64_t) 2097152 + i_41961 * (int64_t) 1048576 + i_41962 * (int64_t) 65536 + i_41963 * (int64_t) 4096 + i_41964 * (int64_t) 2048 + i_41965 * (int64_t) 1024 + i_41966 * (int64_t) 64 + i_41967 * (int64_t) 4 + i_41968 * (int64_t) 2 + i_41969)] = tmp_41990;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42198_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42198_end - futhark_mc_copy_parloop_42198_start;
        
        ctx->program->futhark_mc_copy_parloop_42198_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42198_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42198_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_41991_task_42196(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42195 *futhark_mc_task_42195 = (struct futhark_mc_task_42195 *) args;
    struct futhark_context *ctx = futhark_mc_task_42195->ctx;
    uint64_t futhark_mc_copy_41991_task_42196_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_41991_task_42196_start = get_wall_time();
    
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_task_42195->free_mem_33839, .size =0, .references =NULL};
    int64_t gtid_35006 = futhark_mc_task_42195->free_gtid_35006;
    struct memblock mem_35008 = {.desc ="mem_35008", .mem =futhark_mc_task_42195->free_mem_35008, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42197 futhark_mc_copy_parloop_struct_42197_;
    
    futhark_mc_copy_parloop_struct_42197_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42197_.free_mem_33839 = mem_33839.mem;
    futhark_mc_copy_parloop_struct_42197_.free_gtid_35006 = gtid_35006;
    futhark_mc_copy_parloop_struct_42197_.free_mem_35008 = mem_35008.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42198_task;
    
    futhark_mc_copy_parloop_42198_task.name = "futhark_mc_copy_parloop_42198";
    futhark_mc_copy_parloop_42198_task.fn = futhark_mc_copy_parloop_42198;
    futhark_mc_copy_parloop_42198_task.args = &futhark_mc_copy_parloop_struct_42197_;
    futhark_mc_copy_parloop_42198_task.iterations = iterations;
    futhark_mc_copy_parloop_42198_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42198_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42198_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42198_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42198_task);
    
    if (futhark_mc_copy_parloop_42198_err != 0) {
        err = futhark_mc_copy_parloop_42198_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42198_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42198_total_end - futhark_mc_copy_parloop_42198_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42198_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42198_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42198_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_41991_task_42196_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_41991_task_42196_end - futhark_mc_copy_41991_task_42196_start;
        
        ctx->program->futhark_mc_copy_41991_task_42196_runs[tid]++;
        ctx->program->futhark_mc_copy_41991_task_42196_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_41991_task_42196_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42064(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42063 *futhark_mc_segmap_parloop_struct_42063 = (struct futhark_mc_segmap_parloop_struct_42063 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42063->ctx;
    uint64_t futhark_mc_segmap_parloop_42064_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42064_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_segmap_parloop_struct_42063->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42063->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42063->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42063->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_segmap_parloop_struct_42063->free_mem_33839, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_35008_cached_sizze_42065 = 0;
    unsigned char *mem_35008 = NULL;
    int64_t flat_tid_35005;
    
    flat_tid_35005 = subtask_id;
    {
        int64_t start_36967;
        int64_t end_36968;
        
        start_36967 = start;
        end_36968 = end;
        
        int64_t n_36969 = end_36968 - start_36967;
        
        if (mem_35008_cached_sizze_42065 < (int64_t) 4194304) {
            err = lexical_realloc(ctx, &mem_35008, &mem_35008_cached_sizze_42065, (int64_t) 4194304);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_36970 = start_36967; SegMap_i_36970 < start_36967 + n_36969; SegMap_i_36970++) {
            int64_t slice_36971 = (int64_t) 16;
            int64_t gtid_35006 = SegMap_i_36970;
            int64_t remnant_36972 = SegMap_i_36970 - gtid_35006;
            int8_t x_35007 = ((int8_t *) mem_30515.mem)[gtid_35006];
            int64_t flat_tid_36872 = (int64_t) 0;
            int64_t flat_tid_36097 = (int64_t) 0;
            struct futhark_mc_task_42066 futhark_mc_task_42066_;
            
            futhark_mc_task_42066_.ctx = ctx;
            futhark_mc_task_42066_.free_x_27583 = x_27583;
            futhark_mc_task_42066_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42066_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42066_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42066_.free_x_35007 = x_35007;
            futhark_mc_task_42066_.free_mem_35008 = mem_35008;
            
            struct scheduler_segop futhark_mc_task_42066_task;
            
            futhark_mc_task_42066_task.args = &futhark_mc_task_42066_;
            futhark_mc_task_42066_task.top_level_fn = futhark_mc_segmap_task_42067;
            futhark_mc_task_42066_task.name = "futhark_mc_segmap_task_42067";
            futhark_mc_task_42066_task.iterations = (int64_t) 2;
            futhark_mc_task_42066_task.task_time = &ctx->program->futhark_mc_segmap_task_42067_total_time;
            futhark_mc_task_42066_task.task_iter = &ctx->program->futhark_mc_segmap_task_42067_total_iter;
            futhark_mc_task_42066_task.sched = STATIC;
            futhark_mc_task_42066_task.nested_fn = futhark_mc_segmap_nested_task_42071;
            
            int futhark_mc_segmap_task_42067_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42066_task);
            
            if (futhark_mc_segmap_task_42067_err != 0) {
                ;
                err = futhark_mc_segmap_task_42067_err;
                goto cleanup;
            }
            
            int64_t iterations_41992 = (int64_t) 4194304;
            struct futhark_mc_task_42195 futhark_mc_task_42195_;
            
            futhark_mc_task_42195_.ctx = ctx;
            futhark_mc_task_42195_.free_mem_33839 = mem_33839.mem;
            futhark_mc_task_42195_.free_gtid_35006 = gtid_35006;
            futhark_mc_task_42195_.free_mem_35008 = mem_35008;
            
            struct scheduler_segop futhark_mc_task_42195_task;
            
            futhark_mc_task_42195_task.args = &futhark_mc_task_42195_;
            futhark_mc_task_42195_task.top_level_fn = futhark_mc_copy_41991_task_42196;
            futhark_mc_task_42195_task.name = "futhark_mc_copy_41991_task_42196";
            futhark_mc_task_42195_task.iterations = iterations_41992;
            futhark_mc_task_42195_task.task_time = &ctx->program->futhark_mc_copy_41991_task_42196_total_time;
            futhark_mc_task_42195_task.task_iter = &ctx->program->futhark_mc_copy_41991_task_42196_total_iter;
            futhark_mc_task_42195_task.sched = STATIC;
            futhark_mc_task_42195_task.nested_fn = NULL;
            
            int futhark_mc_copy_41991_task_42196_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42195_task);
            
            if (futhark_mc_copy_41991_task_42196_err != 0) {
                ;
                err = futhark_mc_copy_41991_task_42196_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_35008);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42064_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42064_end - futhark_mc_segmap_parloop_42064_start;
        
        ctx->program->futhark_mc_segmap_parloop_42064_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42064_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42064_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42062(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42057 *futhark_mc_task_42057 = (struct futhark_mc_task_42057 *) args;
    struct futhark_context *ctx = futhark_mc_task_42057->ctx;
    uint64_t futhark_mc_segmap_nested_task_42062_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42062_start = get_wall_time();
    
    int8_t x_27583 = futhark_mc_task_42057->free_x_27583;
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42057->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42057->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42057->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_task_42057->free_mem_33839, .size =0, .references =NULL};
    int32_t nsubtasks_36096;
    
    nsubtasks_36096 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42063 futhark_mc_segmap_parloop_struct_42063_;
    
    futhark_mc_segmap_parloop_struct_42063_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42063_.free_x_27583 = x_27583;
    futhark_mc_segmap_parloop_struct_42063_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42063_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42063_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42063_.free_mem_33839 = mem_33839.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42064_task;
    
    futhark_mc_segmap_parloop_42064_task.name = "futhark_mc_segmap_parloop_42064";
    futhark_mc_segmap_parloop_42064_task.fn = futhark_mc_segmap_parloop_42064;
    futhark_mc_segmap_parloop_42064_task.args = &futhark_mc_segmap_parloop_struct_42063_;
    futhark_mc_segmap_parloop_42064_task.iterations = iterations;
    futhark_mc_segmap_parloop_42064_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42064_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42064_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42064_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42064_task);
    
    if (futhark_mc_segmap_parloop_42064_err != 0) {
        err = futhark_mc_segmap_parloop_42064_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42064_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42064_total_end - futhark_mc_segmap_parloop_42064_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42064_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42064_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42064_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42062_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42062_end - futhark_mc_segmap_nested_task_42062_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42062_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42062_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42062_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
struct futhark_mc_task_42199 {
    struct futhark_context *ctx;
    int64_t free_gtid_27582;
    unsigned char *free_mem_33839;
    unsigned char *free_mem_34853;
};
struct futhark_mc_copy_parloop_struct_42201 {
    struct futhark_context *ctx;
    int64_t free_gtid_27582;
    unsigned char *free_mem_33839;
    unsigned char *free_mem_34853;
};
static int futhark_mc_copy_parloop_42202(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_copy_parloop_struct_42201 *futhark_mc_copy_parloop_struct_42201 = (struct futhark_mc_copy_parloop_struct_42201 *) args;
    struct futhark_context *ctx = futhark_mc_copy_parloop_struct_42201->ctx;
    uint64_t futhark_mc_copy_parloop_42202_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42202_start = get_wall_time();
    
    int64_t gtid_27582 = futhark_mc_copy_parloop_struct_42201->free_gtid_27582;
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_copy_parloop_struct_42201->free_mem_33839, .size =0, .references =NULL};
    struct memblock mem_34853 = {.desc ="mem_34853", .mem =futhark_mc_copy_parloop_struct_42201->free_mem_34853, .size =0, .references =NULL};
    int64_t iterations = end - start;
    
    {
        int64_t start_41993;
        int64_t end_41994;
        
        start_41993 = start;
        end_41994 = end;
        
        int64_t n_41995 = end_41994 - start_41993;
        
        for (int64_t copy_i_41996 = start_41993; copy_i_41996 < start_41993 + n_41995; copy_i_41996++) {
            int64_t slice_42008 = (int64_t) 2;
            int64_t slice_42009 = (int64_t) 2 * slice_42008;
            int64_t slice_42010 = (int64_t) 16 * slice_42009;
            int64_t slice_42011 = (int64_t) 16 * slice_42010;
            int64_t slice_42012 = (int64_t) 2 * slice_42011;
            int64_t slice_42013 = (int64_t) 2 * slice_42012;
            int64_t slice_42014 = (int64_t) 16 * slice_42013;
            int64_t slice_42015 = (int64_t) 16 * slice_42014;
            int64_t slice_42016 = (int64_t) 2 * slice_42015;
            int64_t slice_42017 = (int64_t) 2 * slice_42016;
            int64_t slice_42018 = (int64_t) 16 * slice_42017;
            int64_t i_41997 = squot64(copy_i_41996, slice_42017);
            int64_t remnant_42019 = copy_i_41996 - i_41997 * slice_42017;
            int64_t i_41998 = squot64(remnant_42019, slice_42016);
            int64_t remnant_42020 = remnant_42019 - i_41998 * slice_42016;
            int64_t i_41999 = squot64(remnant_42020, slice_42015);
            int64_t remnant_42021 = remnant_42020 - i_41999 * slice_42015;
            int64_t i_42000 = squot64(remnant_42021, slice_42014);
            int64_t remnant_42022 = remnant_42021 - i_42000 * slice_42014;
            int64_t i_42001 = squot64(remnant_42022, slice_42013);
            int64_t remnant_42023 = remnant_42022 - i_42001 * slice_42013;
            int64_t i_42002 = squot64(remnant_42023, slice_42012);
            int64_t remnant_42024 = remnant_42023 - i_42002 * slice_42012;
            int64_t i_42003 = squot64(remnant_42024, slice_42011);
            int64_t remnant_42025 = remnant_42024 - i_42003 * slice_42011;
            int64_t i_42004 = squot64(remnant_42025, slice_42010);
            int64_t remnant_42026 = remnant_42025 - i_42004 * slice_42010;
            int64_t i_42005 = squot64(remnant_42026, slice_42009);
            int64_t remnant_42027 = remnant_42026 - i_42005 * slice_42009;
            int64_t i_42006 = squot64(remnant_42027, slice_42008);
            int64_t remnant_42028 = remnant_42027 - i_42006 * slice_42008;
            int64_t i_42007 = remnant_42028;
            int64_t remnant_42029 = remnant_42028 - i_42007;
            bool tmp_42030 = ((bool *) mem_33839.mem)[i_41997 * (int64_t) 4194304 + i_41998 * (int64_t) 2097152 + i_41999 * (int64_t) 1048576 + i_42000 * (int64_t) 65536 + i_42001 * (int64_t) 4096 + i_42002 * (int64_t) 2048 + i_42003 * (int64_t) 1024 + i_42004 * (int64_t) 64 + i_42005 * (int64_t) 4 + i_42006 * (int64_t) 2 + i_42007];
            
            ((bool *) mem_34853.mem)[gtid_27582 * (int64_t) 67108864 + (i_41997 * (int64_t) 4194304 + i_41998 * (int64_t) 2097152 + i_41999 * (int64_t) 1048576 + i_42000 * (int64_t) 65536 + i_42001 * (int64_t) 4096 + i_42002 * (int64_t) 2048 + i_42003 * (int64_t) 1024 + i_42004 * (int64_t) 64 + i_42005 * (int64_t) 4 + i_42006 * (int64_t) 2 + i_42007)] = tmp_42030;
        }
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42202_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42202_end - futhark_mc_copy_parloop_42202_start;
        
        ctx->program->futhark_mc_copy_parloop_42202_runs[tid]++;
        ctx->program->futhark_mc_copy_parloop_42202_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_parloop_42202_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_copy_42031_task_42200(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42199 *futhark_mc_task_42199 = (struct futhark_mc_task_42199 *) args;
    struct futhark_context *ctx = futhark_mc_task_42199->ctx;
    uint64_t futhark_mc_copy_42031_task_42200_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_42031_task_42200_start = get_wall_time();
    
    int64_t gtid_27582 = futhark_mc_task_42199->free_gtid_27582;
    struct memblock mem_33839 = {.desc ="mem_33839", .mem =futhark_mc_task_42199->free_mem_33839, .size =0, .references =NULL};
    struct memblock mem_34853 = {.desc ="mem_34853", .mem =futhark_mc_task_42199->free_mem_34853, .size =0, .references =NULL};
    struct futhark_mc_copy_parloop_struct_42201 futhark_mc_copy_parloop_struct_42201_;
    
    futhark_mc_copy_parloop_struct_42201_.ctx = ctx;
    futhark_mc_copy_parloop_struct_42201_.free_gtid_27582 = gtid_27582;
    futhark_mc_copy_parloop_struct_42201_.free_mem_33839 = mem_33839.mem;
    futhark_mc_copy_parloop_struct_42201_.free_mem_34853 = mem_34853.mem;
    
    struct scheduler_parloop futhark_mc_copy_parloop_42202_task;
    
    futhark_mc_copy_parloop_42202_task.name = "futhark_mc_copy_parloop_42202";
    futhark_mc_copy_parloop_42202_task.fn = futhark_mc_copy_parloop_42202;
    futhark_mc_copy_parloop_42202_task.args = &futhark_mc_copy_parloop_struct_42201_;
    futhark_mc_copy_parloop_42202_task.iterations = iterations;
    futhark_mc_copy_parloop_42202_task.info = info;
    
    uint64_t futhark_mc_copy_parloop_42202_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_copy_parloop_42202_total_start = get_wall_time();
    
    int futhark_mc_copy_parloop_42202_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_copy_parloop_42202_task);
    
    if (futhark_mc_copy_parloop_42202_err != 0) {
        err = futhark_mc_copy_parloop_42202_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_parloop_42202_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_parloop_42202_total_end - futhark_mc_copy_parloop_42202_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42202_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42202_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_copy_parloop_42202_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_copy_42031_task_42200_end = get_wall_time();
        uint64_t elapsed = futhark_mc_copy_42031_task_42200_end - futhark_mc_copy_42031_task_42200_start;
        
        ctx->program->futhark_mc_copy_42031_task_42200_runs[tid]++;
        ctx->program->futhark_mc_copy_42031_task_42200_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_copy_42031_task_42200_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int futhark_mc_segmap_parloop_42055(void *args, int64_t start, int64_t end, int subtask_id, int tid)
{
    int err = 0;
    struct futhark_mc_segmap_parloop_struct_42054 *futhark_mc_segmap_parloop_struct_42054 = (struct futhark_mc_segmap_parloop_struct_42054 *) args;
    struct futhark_context *ctx = futhark_mc_segmap_parloop_struct_42054->ctx;
    uint64_t futhark_mc_segmap_parloop_42055_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42055_start = get_wall_time();
    
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_segmap_parloop_struct_42054->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_segmap_parloop_struct_42054->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_segmap_parloop_struct_42054->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_34853 = {.desc ="mem_34853", .mem =futhark_mc_segmap_parloop_struct_42054->free_mem_34853, .size =0, .references =NULL};
    int64_t iterations = end - start;
    int64_t mem_33839_cached_sizze_42056 = 0;
    unsigned char *mem_33839 = NULL;
    int64_t flat_tid_27581;
    
    flat_tid_27581 = subtask_id;
    {
        int64_t start_35979;
        int64_t end_35980;
        
        start_35979 = start;
        end_35980 = end;
        
        int64_t n_35981 = end_35980 - start_35979;
        
        if (mem_33839_cached_sizze_42056 < (int64_t) 67108864) {
            err = lexical_realloc(ctx, &mem_33839, &mem_33839_cached_sizze_42056, (int64_t) 67108864);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t SegMap_i_35982 = start_35979; SegMap_i_35982 < start_35979 + n_35981; SegMap_i_35982++) {
            int64_t slice_35983 = (int64_t) 16;
            int64_t gtid_27582 = SegMap_i_35982;
            int64_t remnant_35984 = SegMap_i_35982 - gtid_27582;
            int8_t x_27583 = ((int8_t *) mem_30515.mem)[gtid_27582];
            int64_t flat_tid_35880 = (int64_t) 0;
            int64_t flat_tid_35005 = (int64_t) 0;
            struct futhark_mc_task_42057 futhark_mc_task_42057_;
            
            futhark_mc_task_42057_.ctx = ctx;
            futhark_mc_task_42057_.free_x_27583 = x_27583;
            futhark_mc_task_42057_.free_mem_30513 = mem_30513.mem;
            futhark_mc_task_42057_.free_mem_30515 = mem_30515.mem;
            futhark_mc_task_42057_.free_mem_30517 = mem_30517.mem;
            futhark_mc_task_42057_.free_mem_33839 = mem_33839;
            
            struct scheduler_segop futhark_mc_task_42057_task;
            
            futhark_mc_task_42057_task.args = &futhark_mc_task_42057_;
            futhark_mc_task_42057_task.top_level_fn = futhark_mc_segmap_task_42058;
            futhark_mc_task_42057_task.name = "futhark_mc_segmap_task_42058";
            futhark_mc_task_42057_task.iterations = (int64_t) 16;
            futhark_mc_task_42057_task.task_time = &ctx->program->futhark_mc_segmap_task_42058_total_time;
            futhark_mc_task_42057_task.task_iter = &ctx->program->futhark_mc_segmap_task_42058_total_iter;
            futhark_mc_task_42057_task.sched = STATIC;
            futhark_mc_task_42057_task.nested_fn = futhark_mc_segmap_nested_task_42062;
            
            int futhark_mc_segmap_task_42058_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42057_task);
            
            if (futhark_mc_segmap_task_42058_err != 0) {
                ;
                err = futhark_mc_segmap_task_42058_err;
                goto cleanup;
            }
            
            int64_t iterations_42032 = (int64_t) 67108864;
            struct futhark_mc_task_42199 futhark_mc_task_42199_;
            
            futhark_mc_task_42199_.ctx = ctx;
            futhark_mc_task_42199_.free_gtid_27582 = gtid_27582;
            futhark_mc_task_42199_.free_mem_33839 = mem_33839;
            futhark_mc_task_42199_.free_mem_34853 = mem_34853.mem;
            
            struct scheduler_segop futhark_mc_task_42199_task;
            
            futhark_mc_task_42199_task.args = &futhark_mc_task_42199_;
            futhark_mc_task_42199_task.top_level_fn = futhark_mc_copy_42031_task_42200;
            futhark_mc_task_42199_task.name = "futhark_mc_copy_42031_task_42200";
            futhark_mc_task_42199_task.iterations = iterations_42032;
            futhark_mc_task_42199_task.task_time = &ctx->program->futhark_mc_copy_42031_task_42200_total_time;
            futhark_mc_task_42199_task.task_iter = &ctx->program->futhark_mc_copy_42031_task_42200_total_iter;
            futhark_mc_task_42199_task.sched = STATIC;
            futhark_mc_task_42199_task.nested_fn = NULL;
            
            int futhark_mc_copy_42031_task_42200_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42199_task);
            
            if (futhark_mc_copy_42031_task_42200_err != 0) {
                ;
                err = futhark_mc_copy_42031_task_42200_err;
                goto cleanup;
            }
        }
    }
    
  cleanup:
    {
        free(mem_33839);
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42055_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42055_end - futhark_mc_segmap_parloop_42055_start;
        
        ctx->program->futhark_mc_segmap_parloop_42055_runs[tid]++;
        ctx->program->futhark_mc_segmap_parloop_42055_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_parloop_42055_iter[tid] += iterations;
    }
    return err;
}
int futhark_mc_segmap_nested_task_42053(void *args, int64_t iterations, int tid, struct scheduler_info info)
{
    int err = 0;
    int subtask_id = tid;
    struct futhark_mc_task_42048 *futhark_mc_task_42048 = (struct futhark_mc_task_42048 *) args;
    struct futhark_context *ctx = futhark_mc_task_42048->ctx;
    uint64_t futhark_mc_segmap_nested_task_42053_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_nested_task_42053_start = get_wall_time();
    
    struct memblock mem_30513 = {.desc ="mem_30513", .mem =futhark_mc_task_42048->free_mem_30513, .size =0, .references =NULL};
    struct memblock mem_30515 = {.desc ="mem_30515", .mem =futhark_mc_task_42048->free_mem_30515, .size =0, .references =NULL};
    struct memblock mem_30517 = {.desc ="mem_30517", .mem =futhark_mc_task_42048->free_mem_30517, .size =0, .references =NULL};
    struct memblock mem_34853 = {.desc ="mem_34853", .mem =futhark_mc_task_42048->free_mem_34853, .size =0, .references =NULL};
    int32_t nsubtasks_35004;
    
    nsubtasks_35004 = info.nsubtasks;
    
    struct futhark_mc_segmap_parloop_struct_42054 futhark_mc_segmap_parloop_struct_42054_;
    
    futhark_mc_segmap_parloop_struct_42054_.ctx = ctx;
    futhark_mc_segmap_parloop_struct_42054_.free_mem_30513 = mem_30513.mem;
    futhark_mc_segmap_parloop_struct_42054_.free_mem_30515 = mem_30515.mem;
    futhark_mc_segmap_parloop_struct_42054_.free_mem_30517 = mem_30517.mem;
    futhark_mc_segmap_parloop_struct_42054_.free_mem_34853 = mem_34853.mem;
    
    struct scheduler_parloop futhark_mc_segmap_parloop_42055_task;
    
    futhark_mc_segmap_parloop_42055_task.name = "futhark_mc_segmap_parloop_42055";
    futhark_mc_segmap_parloop_42055_task.fn = futhark_mc_segmap_parloop_42055;
    futhark_mc_segmap_parloop_42055_task.args = &futhark_mc_segmap_parloop_struct_42054_;
    futhark_mc_segmap_parloop_42055_task.iterations = iterations;
    futhark_mc_segmap_parloop_42055_task.info = info;
    
    uint64_t futhark_mc_segmap_parloop_42055_total_start = 0;
    
    if (ctx->profiling && !ctx->profiling_paused)
        futhark_mc_segmap_parloop_42055_total_start = get_wall_time();
    
    int futhark_mc_segmap_parloop_42055_err = scheduler_execute_task(&ctx->scheduler, &futhark_mc_segmap_parloop_42055_task);
    
    if (futhark_mc_segmap_parloop_42055_err != 0) {
        err = futhark_mc_segmap_parloop_42055_err;
        goto cleanup;
    }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_parloop_42055_total_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_parloop_42055_total_end - futhark_mc_segmap_parloop_42055_total_start;
        
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42055_total_runs, 1, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42055_total_total_runtime, elapsed, __ATOMIC_RELAXED);
        __atomic_fetch_add(&ctx->program->futhark_mc_segmap_parloop_42055_total_iter, iterations, __ATOMIC_RELAXED);
    }
    
  cleanup:
    { }
    if (ctx->profiling && !ctx->profiling_paused) {
        uint64_t futhark_mc_segmap_nested_task_42053_end = get_wall_time();
        uint64_t elapsed = futhark_mc_segmap_nested_task_42053_end - futhark_mc_segmap_nested_task_42053_start;
        
        ctx->program->futhark_mc_segmap_nested_task_42053_runs[tid]++;
        ctx->program->futhark_mc_segmap_nested_task_42053_total_runtime[tid] += elapsed;
        ctx->program->futhark_mc_segmap_nested_task_42053_iter[tid] += iterations;
    }
    if (err == 0) { }
    return err;
}
static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define main_res_12953 (ctx->constants->main_res_12953)
    
    struct memblock mem_34853;
    
    mem_34853.references = NULL;
    
    struct memblock mem_30517;
    
    mem_30517.references = NULL;
    
    struct memblock mem_30515;
    
    mem_30515.references = NULL;
    
    struct memblock mem_30513;
    
    mem_30513.references = NULL;
    if (memblock_alloc(ctx, &mem_30513, (int64_t) 2, "mem_30513")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock static_array_34855 = (struct memblock) {NULL, (unsigned char *) static_array_realtype_42033, 0, "static_array_34855"};
    int64_t iterations_34865 = (int64_t) 2;
    struct futhark_mc_task_42034 futhark_mc_task_42034_;
    
    futhark_mc_task_42034_.ctx = ctx;
    futhark_mc_task_42034_.free_mem_30513 = mem_30513.mem;
    futhark_mc_task_42034_.free_static_array_34855 = static_array_34855.mem;
    
    struct scheduler_segop futhark_mc_task_42034_task;
    
    futhark_mc_task_42034_task.args = &futhark_mc_task_42034_;
    futhark_mc_task_42034_task.top_level_fn = futhark_mc_copy_34864_task_42035;
    futhark_mc_task_42034_task.name = "futhark_mc_copy_34864_task_42035";
    futhark_mc_task_42034_task.iterations = iterations_34865;
    futhark_mc_task_42034_task.task_time = &ctx->program->futhark_mc_copy_34864_task_42035_total_time;
    futhark_mc_task_42034_task.task_iter = &ctx->program->futhark_mc_copy_34864_task_42035_total_iter;
    futhark_mc_task_42034_task.sched = STATIC;
    futhark_mc_task_42034_task.nested_fn = NULL;
    
    int futhark_mc_copy_34864_task_42035_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42034_task);
    
    if (futhark_mc_copy_34864_task_42035_err != 0) {
        if (memblock_unref(ctx, &mem_30513, "mem_30513") != 0)
            return 1;
        ;
        err = futhark_mc_copy_34864_task_42035_err;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_30515, (int64_t) 16, "mem_30515")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock static_array_34866 = (struct memblock) {NULL, (unsigned char *) static_array_realtype_42038, 0, "static_array_34866"};
    int64_t iterations_34876 = (int64_t) 16;
    struct futhark_mc_task_42039 futhark_mc_task_42039_;
    
    futhark_mc_task_42039_.ctx = ctx;
    futhark_mc_task_42039_.free_mem_30515 = mem_30515.mem;
    futhark_mc_task_42039_.free_static_array_34866 = static_array_34866.mem;
    
    struct scheduler_segop futhark_mc_task_42039_task;
    
    futhark_mc_task_42039_task.args = &futhark_mc_task_42039_;
    futhark_mc_task_42039_task.top_level_fn = futhark_mc_copy_34875_task_42040;
    futhark_mc_task_42039_task.name = "futhark_mc_copy_34875_task_42040";
    futhark_mc_task_42039_task.iterations = iterations_34876;
    futhark_mc_task_42039_task.task_time = &ctx->program->futhark_mc_copy_34875_task_42040_total_time;
    futhark_mc_task_42039_task.task_iter = &ctx->program->futhark_mc_copy_34875_task_42040_total_iter;
    futhark_mc_task_42039_task.sched = STATIC;
    futhark_mc_task_42039_task.nested_fn = NULL;
    
    int futhark_mc_copy_34875_task_42040_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42039_task);
    
    if (futhark_mc_copy_34875_task_42040_err != 0) {
        if (memblock_unref(ctx, &mem_30515, "mem_30515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_30513, "mem_30513") != 0)
            return 1;
        ;
        err = futhark_mc_copy_34875_task_42040_err;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_30517, (int64_t) 16, "mem_30517")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock static_array_34877 = (struct memblock) {NULL, (unsigned char *) static_array_realtype_42043, 0, "static_array_34877"};
    int64_t iterations_34887 = (int64_t) 16;
    struct futhark_mc_task_42044 futhark_mc_task_42044_;
    
    futhark_mc_task_42044_.ctx = ctx;
    futhark_mc_task_42044_.free_mem_30517 = mem_30517.mem;
    futhark_mc_task_42044_.free_static_array_34877 = static_array_34877.mem;
    
    struct scheduler_segop futhark_mc_task_42044_task;
    
    futhark_mc_task_42044_task.args = &futhark_mc_task_42044_;
    futhark_mc_task_42044_task.top_level_fn = futhark_mc_copy_34886_task_42045;
    futhark_mc_task_42044_task.name = "futhark_mc_copy_34886_task_42045";
    futhark_mc_task_42044_task.iterations = iterations_34887;
    futhark_mc_task_42044_task.task_time = &ctx->program->futhark_mc_copy_34886_task_42045_total_time;
    futhark_mc_task_42044_task.task_iter = &ctx->program->futhark_mc_copy_34886_task_42045_total_iter;
    futhark_mc_task_42044_task.sched = STATIC;
    futhark_mc_task_42044_task.nested_fn = NULL;
    
    int futhark_mc_copy_34886_task_42045_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42044_task);
    
    if (futhark_mc_copy_34886_task_42045_err != 0) {
        if (memblock_unref(ctx, &mem_30517, "mem_30517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_30515, "mem_30515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_30513, "mem_30513") != 0)
            return 1;
        ;
        err = futhark_mc_copy_34886_task_42045_err;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_34853, (int64_t) 1073741824, "mem_34853")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t flat_tid_23263 = (int64_t) 0;
    int64_t flat_tid_27581 = (int64_t) 0;
    struct futhark_mc_task_42048 futhark_mc_task_42048_;
    
    futhark_mc_task_42048_.ctx = ctx;
    futhark_mc_task_42048_.free_mem_30513 = mem_30513.mem;
    futhark_mc_task_42048_.free_mem_30515 = mem_30515.mem;
    futhark_mc_task_42048_.free_mem_30517 = mem_30517.mem;
    futhark_mc_task_42048_.free_mem_34853 = mem_34853.mem;
    
    struct scheduler_segop futhark_mc_task_42048_task;
    
    futhark_mc_task_42048_task.args = &futhark_mc_task_42048_;
    futhark_mc_task_42048_task.top_level_fn = futhark_mc_segmap_task_42049;
    futhark_mc_task_42048_task.name = "futhark_mc_segmap_task_42049";
    futhark_mc_task_42048_task.iterations = (int64_t) 16;
    futhark_mc_task_42048_task.task_time = &ctx->program->futhark_mc_segmap_task_42049_total_time;
    futhark_mc_task_42048_task.task_iter = &ctx->program->futhark_mc_segmap_task_42049_total_iter;
    futhark_mc_task_42048_task.sched = STATIC;
    futhark_mc_task_42048_task.nested_fn = futhark_mc_segmap_nested_task_42053;
    
    int futhark_mc_segmap_task_42049_err = scheduler_prepare_task(&ctx->scheduler, &futhark_mc_task_42048_task);
    
    if (futhark_mc_segmap_task_42049_err != 0) {
        if (memblock_unref(ctx, &mem_34853, "mem_34853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_30517, "mem_30517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_30515, "mem_30515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_30513, "mem_30513") != 0)
            return 1;
        ;
        err = futhark_mc_segmap_task_42049_err;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_30513, "mem_30513") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_30515, "mem_30515") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_30517, "mem_30517") != 0)
        return 1;
    main_res_12953 = ((bool *) mem_34853.mem)[(int64_t) 0];
    if (memblock_unref(ctx, &mem_34853, "mem_34853") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_34853, "mem_34853") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_30517, "mem_30517") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_30515, "mem_30515") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_30513, "mem_30513") != 0)
        return 1;
    #undef main_res_12953
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}

static int futrts_entry_main(struct futhark_context *ctx, bool *out_prim_out_42203)
{
    (void) ctx;
    
    int err = 0;
    bool main_res_12953 = ctx->constants->main_res_12953;
    bool prim_out_34854;
    
    prim_out_34854 = main_res_12953;
    *out_prim_out_42203 = prim_out_34854;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_main(struct futhark_context *ctx, bool *out0)
{
    bool prim_out_34854;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    worker_local = &ctx->scheduler.workers[0];
    if (ret == 0) {
        ret = futrts_entry_main(ctx, &prim_out_34854);
        if (ret == 0) {
            bool main_res_12953 = ctx->constants->main_res_12953;
            
            *out0 = prim_out_34854;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
